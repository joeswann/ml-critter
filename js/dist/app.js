(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var jQuery = _interopRequire(require("./../lib/jquery/dist/jquery.js"));

var Engine = _interopRequire(require("./engine"));

(function ($) {
  window.$ = $;
  var engine = new Engine({
    _settings: {
      brain: {
        neurons: 100,
        synapses: 100
      },
      env: {
        obstructions: 10,
        avoiders: 10,
        finders: 10
      }
    }
  });
})(jQuery);

},{"./../lib/jquery/dist/jquery.js":2,"./engine":6}],2:[function(require,module,exports){
"use strict";(function(global, factory){if(typeof module === "object" && typeof module.exports === "object"){module.exports = global.document?factory(global, true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}return factory(w);};}else {factory(global);}})(typeof window !== "undefined"?window:undefined, function(window, noGlobal){var arr=[];var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var document=window.document, version="2.1.3", jQuery=(function(_jQuery2){var _jQueryWrapper=function jQuery(_x, _x2){return _jQuery2.apply(this, arguments);};_jQueryWrapper.toString = function(){return _jQuery2.toString();};return _jQueryWrapper;})(function(selector, context){return new jQuery.fn.init(selector, context);}), rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, rmsPrefix=/^-ms-/, rdashAlpha=/-([\da-z])/gi, fcamelCase=function fcamelCase(all, letter){return letter.toUpperCase();};jQuery.fn = jQuery.prototype = {jquery:version, constructor:jQuery, selector:"", length:0, toArray:function toArray(){return slice.call(this);}, get:function get(num){return num != null?num < 0?this[num + this.length]:this[num]:slice.call(this);}, pushStack:function pushStack(elems){var ret=jQuery.merge(this.constructor(), elems);ret.prevObject = this;ret.context = this.context;return ret;}, each:function each(callback, args){return jQuery.each(this, callback, args);}, map:function map(callback){return this.pushStack(jQuery.map(this, function(elem, i){return callback.call(elem, i, elem);}));}, slice:(function(_slice){var _sliceWrapper=function slice(){return _slice.apply(this, arguments);};_sliceWrapper.toString = function(){return _slice.toString();};return _sliceWrapper;})(function(){return this.pushStack(slice.apply(this, arguments));}), first:function first(){return this.eq(0);}, last:function last(){return this.eq(-1);}, eq:function eq(i){var len=this.length, j=+i + (i < 0?len:0);return this.pushStack(j >= 0 && j < len?[this[j]]:[]);}, end:function end(){return this.prevObject || this.constructor(null);}, push:push, sort:arr.sort, splice:arr.splice};jQuery.extend = jQuery.fn.extend = function(){var options, name, src, copy, copyIsArray, clone, target=arguments[0] || {}, i=1, length=arguments.length, deep=false;if(typeof target === "boolean"){deep = target;target = arguments[i] || {};i++;}if(typeof target !== "object" && !jQuery.isFunction(target)){target = {};}if(i === length){target = this;i--;}for(; i < length; i++) {if((options = arguments[i]) != null){for(name in options) {src = target[name];copy = options[name];if(target === copy){continue;}if(deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))){if(copyIsArray){copyIsArray = false;clone = src && jQuery.isArray(src)?src:[];}else {clone = src && jQuery.isPlainObject(src)?src:{};}target[name] = jQuery.extend(deep, clone, copy);}else if(copy !== undefined){target[name] = copy;}}}}return target;};jQuery.extend({expando:"jQuery" + (version + Math.random()).replace(/\D/g, ""), isReady:true, error:function error(msg){throw new Error(msg);}, noop:function noop(){}, isFunction:function isFunction(obj){return jQuery.type(obj) === "function";}, isArray:Array.isArray, isWindow:function isWindow(obj){return obj != null && obj === obj.window;}, isNumeric:function isNumeric(obj){return !jQuery.isArray(obj) && obj - parseFloat(obj) + 1 >= 0;}, isPlainObject:function isPlainObject(obj){if(jQuery.type(obj) !== "object" || obj.nodeType || jQuery.isWindow(obj)){return false;}if(obj.constructor && !hasOwn.call(obj.constructor.prototype, "isPrototypeOf")){return false;}return true;}, isEmptyObject:function isEmptyObject(obj){var name;for(name in obj) {return false;}return true;}, type:function type(obj){if(obj == null){return obj + "";}return typeof obj === "object" || typeof obj === "function"?class2type[toString.call(obj)] || "object":typeof obj;}, globalEval:function globalEval(code){var script, indirect=eval;code = jQuery.trim(code);if(code){if(code.indexOf("use strict") === 1){script = document.createElement("script");script.text = code;document.head.appendChild(script).parentNode.removeChild(script);}else {indirect(code);}}}, camelCase:function camelCase(string){return string.replace(rmsPrefix, "ms-").replace(rdashAlpha, fcamelCase);}, nodeName:function nodeName(elem, name){return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();}, each:function each(obj, callback, args){var value, i=0, length=obj.length, isArray=isArraylike(obj);if(args){if(isArray){for(; i < length; i++) {value = callback.apply(obj[i], args);if(value === false){break;}}}else {for(i in obj) {value = callback.apply(obj[i], args);if(value === false){break;}}}}else {if(isArray){for(; i < length; i++) {value = callback.call(obj[i], i, obj[i]);if(value === false){break;}}}else {for(i in obj) {value = callback.call(obj[i], i, obj[i]);if(value === false){break;}}}}return obj;}, trim:function trim(text){return text == null?"":(text + "").replace(rtrim, "");}, makeArray:function makeArray(arr, results){var ret=results || [];if(arr != null){if(isArraylike(Object(arr))){jQuery.merge(ret, typeof arr === "string"?[arr]:arr);}else {push.call(ret, arr);}}return ret;}, inArray:function inArray(elem, arr, i){return arr == null?-1:indexOf.call(arr, elem, i);}, merge:function merge(first, second){var len=+second.length, j=0, i=first.length;for(; j < len; j++) {first[i++] = second[j];}first.length = i;return first;}, grep:function grep(elems, callback, invert){var callbackInverse, matches=[], i=0, length=elems.length, callbackExpect=!invert;for(; i < length; i++) {callbackInverse = !callback(elems[i], i);if(callbackInverse !== callbackExpect){matches.push(elems[i]);}}return matches;}, map:function map(elems, callback, arg){var value, i=0, length=elems.length, isArray=isArraylike(elems), ret=[];if(isArray){for(; i < length; i++) {value = callback(elems[i], i, arg);if(value != null){ret.push(value);}}}else {for(i in elems) {value = callback(elems[i], i, arg);if(value != null){ret.push(value);}}}return concat.apply([], ret);}, guid:1, proxy:(function(_proxy){var _proxyWrapper=function proxy(_x, _x2){return _proxy.apply(this, arguments);};_proxyWrapper.toString = function(){return _proxy.toString();};return _proxyWrapper;})(function(fn, context){var tmp, args, proxy;if(typeof context === "string"){tmp = fn[context];context = fn;fn = tmp;}if(!jQuery.isFunction(fn)){return undefined;}args = slice.call(arguments, 2);proxy = function(){return fn.apply(context || this, args.concat(slice.call(arguments)));};proxy.guid = fn.guid = fn.guid || jQuery.guid++;return proxy;}), now:Date.now, support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name){class2type["[object " + name + "]"] = name.toLowerCase();});function isArraylike(obj){var length=obj.length, type=jQuery.type(obj);if(type === "function" || jQuery.isWindow(obj)){return false;}if(obj.nodeType === 1 && length){return true;}return type === "array" || length === 0 || typeof length === "number" && length > 0 && length - 1 in obj;}var Sizzle=(function(window){var i, support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains, expando="sizzle" + 1 * new Date(), preferredDoc=window.document, dirruns=0, done=0, classCache=createCache(), tokenCache=createCache(), compilerCache=createCache(), sortOrder=function sortOrder(a, b){if(a === b){hasDuplicate = true;}return 0;}, MAX_NEGATIVE=1 << 31, hasOwn=({}).hasOwnProperty, arr=[], pop=arr.pop, push_native=arr.push, push=arr.push, slice=arr.slice, indexOf=function indexOf(list, elem){var i=0, len=list.length;for(; i < len; i++) {if(list[i] === elem){return i;}}return -1;}, booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", whitespace="[\\x20\\t\\r\\n\\f]", characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", identifier=characterEncoding.replace("w", "w#"), attributes="\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace + "*([*^$|!~]?=)" + whitespace + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace + "*\\]", pseudos=":(" + characterEncoding + ")(?:\\((" + "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" + "((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" + ".*" + ")\\)|)", rwhitespace=new RegExp(whitespace + "+", "g"), rtrim=new RegExp("^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g"), rcomma=new RegExp("^" + whitespace + "*," + whitespace + "*"), rcombinators=new RegExp("^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*"), rattributeQuotes=new RegExp("=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g"), rpseudo=new RegExp(pseudos), ridentifier=new RegExp("^" + identifier + "$"), matchExpr={ID:new RegExp("^#(" + characterEncoding + ")"), CLASS:new RegExp("^\\.(" + characterEncoding + ")"), TAG:new RegExp("^(" + characterEncoding.replace("w", "w*") + ")"), ATTR:new RegExp("^" + attributes), PSEUDO:new RegExp("^" + pseudos), CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace + "*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace + "*(\\d+)|))" + whitespace + "*\\)|)", "i"), bool:new RegExp("^(?:" + booleans + ")$", "i"), needsContext:new RegExp("^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i")}, rinputs=/^(?:input|select|textarea|button)$/i, rheader=/^h\d$/i, rnative=/^[^{]+\{\s*\[native \w/, rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, rsibling=/[+~]/, rescape=/'|\\/g, runescape=new RegExp("\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig"), funescape=function funescape(_, escaped, escapedWhitespace){var high="0x" + escaped - 65536;return high !== high || escapedWhitespace?escaped:high < 0?String.fromCharCode(high + 65536):String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);}, unloadHandler=function unloadHandler(){setDocument();};try{push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e) {push = {apply:arr.length?function(target, els){push_native.apply(target, slice.call(els));}:function(target, els){var j=target.length, i=0;while(target[j++] = els[i++]) {}target.length = j - 1;}};}function Sizzle(selector, context, results, seed){var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;if((context?context.ownerDocument || context:preferredDoc) !== document){setDocument(context);}context = context || document;results = results || [];nodeType = context.nodeType;if(typeof selector !== "string" || !selector || nodeType !== 1 && nodeType !== 9 && nodeType !== 11){return results;}if(!seed && documentIsHTML){if(nodeType !== 11 && (match = rquickExpr.exec(selector))){if(m = match[1]){if(nodeType === 9){elem = context.getElementById(m);if(elem && elem.parentNode){if(elem.id === m){results.push(elem);return results;}}else {return results;}}else {if(context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains(context, elem) && elem.id === m){results.push(elem);return results;}}}else if(match[2]){push.apply(results, context.getElementsByTagName(selector));return results;}else if((m = match[3]) && support.getElementsByClassName){push.apply(results, context.getElementsByClassName(m));return results;}}if(support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))){nid = old = expando;newContext = context;newSelector = nodeType !== 1 && selector;if(nodeType === 1 && context.nodeName.toLowerCase() !== "object"){groups = tokenize(selector);if(old = context.getAttribute("id")){nid = old.replace(rescape, "\\$&");}else {context.setAttribute("id", nid);}nid = "[id='" + nid + "'] ";i = groups.length;while(i--) {groups[i] = nid + toSelector(groups[i]);}newContext = rsibling.test(selector) && testContext(context.parentNode) || context;newSelector = groups.join(",");}if(newSelector){try{push.apply(results, newContext.querySelectorAll(newSelector));return results;}catch(qsaError) {}finally {if(!old){context.removeAttribute("id");}}}}}return select(selector.replace(rtrim, "$1"), context, results, seed);}function createCache(){var keys=[];function cache(key, value){if(keys.push(key + " ") > Expr.cacheLength){delete cache[keys.shift()];}return cache[key + " "] = value;}return cache;}function markFunction(fn){fn[expando] = true;return fn;}function assert(fn){var div=document.createElement("div");try{return !!fn(div);}catch(e) {return false;}finally {if(div.parentNode){div.parentNode.removeChild(div);}div = null;}}function addHandle(attrs, handler){var arr=attrs.split("|"), i=attrs.length;while(i--) {Expr.attrHandle[arr[i]] = handler;}}function siblingCheck(a, b){var cur=b && a, diff=cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);if(diff){return diff;}if(cur){while(cur = cur.nextSibling) {if(cur === b){return -1;}}}return a?1:-1;}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name === "input" && elem.type === type;};}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return (name === "input" || name === "button") && elem.type === type;};}function createPositionalPseudo(fn){return markFunction(function(argument){argument = +argument;return markFunction(function(seed, matches){var j, matchIndexes=fn([], seed.length, argument), i=matchIndexes.length;while(i--) {if(seed[j = matchIndexes[i]]){seed[j] = !(matches[j] = seed[j]);}}});});}function testContext(context){return context && typeof context.getElementsByTagName !== "undefined" && context;}support = Sizzle.support = {};isXML = Sizzle.isXML = function(elem){var documentElement=elem && (elem.ownerDocument || elem).documentElement;return documentElement?documentElement.nodeName !== "HTML":false;};setDocument = Sizzle.setDocument = function(node){var hasCompare, parent, doc=node?node.ownerDocument || node:preferredDoc;if(doc === document || doc.nodeType !== 9 || !doc.documentElement){return document;}document = doc;docElem = doc.documentElement;parent = doc.defaultView;if(parent && parent !== parent.top){if(parent.addEventListener){parent.addEventListener("unload", unloadHandler, false);}else if(parent.attachEvent){parent.attachEvent("onunload", unloadHandler);}}documentIsHTML = !isXML(doc);support.attributes = assert(function(div){div.className = "i";return !div.getAttribute("className");});support.getElementsByTagName = assert(function(div){div.appendChild(doc.createComment(""));return !div.getElementsByTagName("*").length;});support.getElementsByClassName = rnative.test(doc.getElementsByClassName);support.getById = assert(function(div){docElem.appendChild(div).id = expando;return !doc.getElementsByName || !doc.getElementsByName(expando).length;});if(support.getById){Expr.find.ID = function(id, context){if(typeof context.getElementById !== "undefined" && documentIsHTML){var m=context.getElementById(id);return m && m.parentNode?[m]:[];}};Expr.filter.ID = function(id){var attrId=id.replace(runescape, funescape);return function(elem){return elem.getAttribute("id") === attrId;};};}else {delete Expr.find.ID;Expr.filter.ID = function(id){var attrId=id.replace(runescape, funescape);return function(elem){var node=typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");return node && node.value === attrId;};};}Expr.find.TAG = support.getElementsByTagName?function(tag, context){if(typeof context.getElementsByTagName !== "undefined"){return context.getElementsByTagName(tag);}else if(support.qsa){return context.querySelectorAll(tag);}}:function(tag, context){var elem, tmp=[], i=0, results=context.getElementsByTagName(tag);if(tag === "*"){while(elem = results[i++]) {if(elem.nodeType === 1){tmp.push(elem);}}return tmp;}return results;};Expr.find.CLASS = support.getElementsByClassName && function(className, context){if(documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches = [];rbuggyQSA = [];if(support.qsa = rnative.test(doc.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML = "<a id='" + expando + "'></a>" + "<select id='" + expando + "-\f]' msallowcapture=''>" + "<option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]=" + whitespace + "*(?:''|\"\")");}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\[" + whitespace + "*(?:value|" + booleans + ")");}if(!div.querySelectorAll("[id~=" + expando + "-]").length){rbuggyQSA.push("~=");}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}if(!div.querySelectorAll("a#" + expando + "+*").length){rbuggyQSA.push(".#.+[+~]");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type", "hidden");div.appendChild(input).setAttribute("name", "D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name" + whitespace + "*[*^$|!~]?=");}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled", ":disabled");}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}if(support.matchesSelector = rnative.test(matches = docElem.matches || docElem.webkitMatchesSelector || docElem.mozMatchesSelector || docElem.oMatchesSelector || docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch = matches.call(div, "div");matches.call(div, "[s!='']:x");rbuggyMatches.push("!=", pseudos);});}rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join("|"));rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join("|"));hasCompare = rnative.test(docElem.compareDocumentPosition);contains = hasCompare || rnative.test(docElem.contains)?function(a, b){var adown=a.nodeType === 9?a.documentElement:a, bup=b && b.parentNode;return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains?adown.contains(bup):a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));}:function(a, b){if(b){while(b = b.parentNode) {if(b === a){return true;}}}return false;};sortOrder = hasCompare?function(a, b){if(a === b){hasDuplicate = true;return 0;}var compare=!a.compareDocumentPosition - !b.compareDocumentPosition;if(compare){return compare;}compare = (a.ownerDocument || a) === (b.ownerDocument || b)?a.compareDocumentPosition(b):1;if(compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare){if(a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a)){return -1;}if(b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b)){return 1;}return sortInput?indexOf(sortInput, a) - indexOf(sortInput, b):0;}return compare & 4?-1:1;}:function(a, b){if(a === b){hasDuplicate = true;return 0;}var cur, i=0, aup=a.parentNode, bup=b.parentNode, ap=[a], bp=[b];if(!aup || !bup){return a === doc?-1:b === doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput, a) - indexOf(sortInput, b):0;}else if(aup === bup){return siblingCheck(a, b);}cur = a;while(cur = cur.parentNode) {ap.unshift(cur);}cur = b;while(cur = cur.parentNode) {bp.unshift(cur);}while(ap[i] === bp[i]) {i++;}return i?siblingCheck(ap[i], bp[i]):ap[i] === preferredDoc?-1:bp[i] === preferredDoc?1:0;};return doc;};Sizzle.matches = function(expr, elements){return Sizzle(expr, null, null, elements);};Sizzle.matchesSelector = function(elem, expr){if((elem.ownerDocument || elem) !== document){setDocument(elem);}expr = expr.replace(rattributeQuotes, "='$1']");if(support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))){try{var ret=matches.call(elem, expr);if(ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11){return ret;}}catch(e) {}}return Sizzle(expr, document, null, [elem]).length > 0;};Sizzle.contains = function(context, elem){if((context.ownerDocument || context) !== document){setDocument(context);}return contains(context, elem);};Sizzle.attr = function(elem, name){if((elem.ownerDocument || elem) !== document){setDocument(elem);}var fn=Expr.attrHandle[name.toLowerCase()], val=fn && hasOwn.call(Expr.attrHandle, name.toLowerCase())?fn(elem, name, !documentIsHTML):undefined;return val !== undefined?val:support.attributes || !documentIsHTML?elem.getAttribute(name):(val = elem.getAttributeNode(name)) && val.specified?val.value:null;};Sizzle.error = function(msg){throw new Error("Syntax error, unrecognized expression: " + msg);};Sizzle.uniqueSort = function(results){var elem, duplicates=[], j=0, i=0;hasDuplicate = !support.detectDuplicates;sortInput = !support.sortStable && results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem = results[i++]) {if(elem === results[i]){j = duplicates.push(i);}}while(j--) {results.splice(duplicates[j], 1);}}sortInput = null;return results;};getText = Sizzle.getText = function(elem){var node, ret="", i=0, nodeType=elem.nodeType;if(!nodeType){while(node = elem[i++]) {ret += getText(node);}}else if(nodeType === 1 || nodeType === 9 || nodeType === 11){if(typeof elem.textContent === "string"){return elem.textContent;}else {for(elem = elem.firstChild; elem; elem = elem.nextSibling) {ret += getText(elem);}}}else if(nodeType === 3 || nodeType === 4){return elem.nodeValue;}return ret;};Expr = Sizzle.selectors = {cacheLength:50, createPseudo:markFunction, match:matchExpr, attrHandle:{}, find:{}, relative:{">":{dir:"parentNode", first:true}, " ":{dir:"parentNode"}, "+":{dir:"previousSibling", first:true}, "~":{dir:"previousSibling"}}, preFilter:{ATTR:function(match){match[1] = match[1].replace(runescape, funescape);match[3] = (match[3] || match[4] || match[5] || "").replace(runescape, funescape);if(match[2] === "~="){match[3] = " " + match[3] + " ";}return match.slice(0, 4);}, CHILD:function(match){match[1] = match[1].toLowerCase();if(match[1].slice(0, 3) === "nth"){if(!match[3]){Sizzle.error(match[0]);}match[4] = +(match[4]?match[5] + (match[6] || 1):2 * (match[3] === "even" || match[3] === "odd"));match[5] = +(match[7] + match[8] || match[3] === "odd");}else if(match[3]){Sizzle.error(match[0]);}return match;}, PSEUDO:function(match){var excess, unquoted=!match[6] && match[2];if(matchExpr.CHILD.test(match[0])){return null;}if(match[3]){match[2] = match[4] || match[5] || "";}else if(unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(")", unquoted.length - excess) - unquoted.length)){match[0] = match[0].slice(0, excess);match[2] = unquoted.slice(0, excess);}return match.slice(0, 3);}}, filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape, funescape).toLowerCase();return nodeNameSelector === "*"?function(){return true;}:function(elem){return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;};}, CLASS:function(className){var pattern=classCache[className + " "];return pattern || (pattern = new RegExp("(^|" + whitespace + ")" + className + "(" + whitespace + "|$)")) && classCache(className, function(elem){return pattern.test(typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "");});}, ATTR:function(name, operator, check){return function(elem){var result=Sizzle.attr(elem, name);if(result == null){return operator === "!=";}if(!operator){return true;}result += "";return operator === "="?result === check:operator === "!="?result !== check:operator === "^="?check && result.indexOf(check) === 0:operator === "*="?check && result.indexOf(check) > -1:operator === "$="?check && result.slice(-check.length) === check:operator === "~="?(" " + result.replace(rwhitespace, " ") + " ").indexOf(check) > -1:operator === "|="?result === check || result.slice(0, check.length + 1) === check + "-":false;};}, CHILD:function(type, what, argument, first, last){var simple=type.slice(0, 3) !== "nth", forward=type.slice(-4) !== "last", ofType=what === "of-type";return first === 1 && last === 0?function(elem){return !!elem.parentNode;}:function(elem, context, xml){var cache, outerCache, node, diff, nodeIndex, start, dir=simple !== forward?"nextSibling":"previousSibling", parent=elem.parentNode, name=ofType && elem.nodeName.toLowerCase(), useCache=!xml && !ofType;if(parent){if(simple){while(dir) {node = elem;while(node = node[dir]) {if(ofType?node.nodeName.toLowerCase() === name:node.nodeType === 1){return false;}}start = dir = type === "only" && !start && "nextSibling";}return true;}start = [forward?parent.firstChild:parent.lastChild];if(forward && useCache){outerCache = parent[expando] || (parent[expando] = {});cache = outerCache[type] || [];nodeIndex = cache[0] === dirruns && cache[1];diff = cache[0] === dirruns && cache[2];node = nodeIndex && parent.childNodes[nodeIndex];while(node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {if(node.nodeType === 1 && ++diff && node === elem){outerCache[type] = [dirruns, nodeIndex, diff];break;}}}else if(useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns){diff = cache[1];}else {while(node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {if((ofType?node.nodeName.toLowerCase() === name:node.nodeType === 1) && ++diff){if(useCache){(node[expando] || (node[expando] = {}))[type] = [dirruns, diff];}if(node === elem){break;}}}}diff -= last;return diff === first || diff % first === 0 && diff / first >= 0;}};}, PSEUDO:function(pseudo, argument){var args, fn=Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error("unsupported pseudo: " + pseudo);if(fn[expando]){return fn(argument);}if(fn.length > 1){args = [pseudo, pseudo, "", argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed, matches){var idx, matched=fn(seed, argument), i=matched.length;while(i--) {idx = indexOf(seed, matched[i]);seed[idx] = !(matches[idx] = matched[i]);}}):function(elem){return fn(elem, 0, args);};}return fn;}}, pseudos:{not:markFunction(function(selector){var input=[], results=[], matcher=compile(selector.replace(rtrim, "$1"));return matcher[expando]?markFunction(function(seed, matches, context, xml){var elem, unmatched=matcher(seed, null, xml, []), i=seed.length;while(i--) {if(elem = unmatched[i]){seed[i] = !(matches[i] = elem);}}}):function(elem, context, xml){input[0] = elem;matcher(input, null, xml, results);input[0] = null;return !results.pop();};}), has:markFunction(function(selector){return function(elem){return Sizzle(selector, elem).length > 0;};}), contains:markFunction(function(text){text = text.replace(runescape, funescape);return function(elem){return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;};}), lang:markFunction(function(lang){if(!ridentifier.test(lang || "")){Sizzle.error("unsupported lang: " + lang);}lang = lang.replace(runescape, funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang = documentIsHTML?elem.lang:elem.getAttribute("xml:lang") || elem.getAttribute("lang")){elemLang = elemLang.toLowerCase();return elemLang === lang || elemLang.indexOf(lang + "-") === 0;}}while((elem = elem.parentNode) && elem.nodeType === 1);return false;};}), target:function(elem){var hash=window.location && window.location.hash;return hash && hash.slice(1) === elem.id;}, root:function(elem){return elem === docElem;}, focus:function(elem){return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);}, enabled:function(elem){return elem.disabled === false;}, disabled:function(elem){return elem.disabled === true;}, checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName === "input" && !!elem.checked || nodeName === "option" && !!elem.selected;}, selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}return elem.selected === true;}, empty:function(elem){for(elem = elem.firstChild; elem; elem = elem.nextSibling) {if(elem.nodeType < 6){return false;}}return true;}, parent:function(elem){return !Expr.pseudos.empty(elem);}, header:function(elem){return rheader.test(elem.nodeName);}, input:function(elem){return rinputs.test(elem.nodeName);}, button:function(elem){var name=elem.nodeName.toLowerCase();return name === "input" && elem.type === "button" || name === "button";}, text:function(elem){var attr;return elem.nodeName.toLowerCase() === "input" && elem.type === "text" && ((attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text");}, first:createPositionalPseudo(function(){return [0];}), last:createPositionalPseudo(function(matchIndexes, length){return [length - 1];}), eq:createPositionalPseudo(function(matchIndexes, length, argument){return [argument < 0?argument + length:argument];}), even:createPositionalPseudo(function(matchIndexes, length){var i=0;for(; i < length; i += 2) {matchIndexes.push(i);}return matchIndexes;}), odd:createPositionalPseudo(function(matchIndexes, length){var i=1;for(; i < length; i += 2) {matchIndexes.push(i);}return matchIndexes;}), lt:createPositionalPseudo(function(matchIndexes, length, argument){var i=argument < 0?argument + length:argument;for(; --i >= 0;) {matchIndexes.push(i);}return matchIndexes;}), gt:createPositionalPseudo(function(matchIndexes, length, argument){var i=argument < 0?argument + length:argument;for(; ++i < length;) {matchIndexes.push(i);}return matchIndexes;})}};Expr.pseudos.nth = Expr.pseudos.eq;for(i in {radio:true, checkbox:true, file:true, password:true, image:true}) {Expr.pseudos[i] = createInputPseudo(i);}for(i in {submit:true, reset:true}) {Expr.pseudos[i] = createButtonPseudo(i);}function setFilters(){}setFilters.prototype = Expr.filters = Expr.pseudos;Expr.setFilters = new setFilters();tokenize = Sizzle.tokenize = function(selector, parseOnly){var matched, match, tokens, type, soFar, groups, preFilters, cached=tokenCache[selector + " "];if(cached){return parseOnly?0:cached.slice(0);}soFar = selector;groups = [];preFilters = Expr.preFilter;while(soFar) {if(!matched || (match = rcomma.exec(soFar))){if(match){soFar = soFar.slice(match[0].length) || soFar;}groups.push(tokens = []);}matched = false;if(match = rcombinators.exec(soFar)){matched = match.shift();tokens.push({value:matched, type:match[0].replace(rtrim, " ")});soFar = soFar.slice(matched.length);}for(type in Expr.filter) {if((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))){matched = match.shift();tokens.push({value:matched, type:type, matches:match});soFar = soFar.slice(matched.length);}}if(!matched){break;}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector, groups).slice(0);};function toSelector(tokens){var i=0, len=tokens.length, selector="";for(; i < len; i++) {selector += tokens[i].value;}return selector;}function addCombinator(matcher, combinator, base){var dir=combinator.dir, checkNonElements=base && dir === "parentNode", doneName=done++;return combinator.first?function(elem, context, xml){while(elem = elem[dir]) {if(elem.nodeType === 1 || checkNonElements){return matcher(elem, context, xml);}}}:function(elem, context, xml){var oldCache, outerCache, newCache=[dirruns, doneName];if(xml){while(elem = elem[dir]) {if(elem.nodeType === 1 || checkNonElements){if(matcher(elem, context, xml)){return true;}}}}else {while(elem = elem[dir]) {if(elem.nodeType === 1 || checkNonElements){outerCache = elem[expando] || (elem[expando] = {});if((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName){return newCache[2] = oldCache[2];}else {outerCache[dir] = newCache;if(newCache[2] = matcher(elem, context, xml)){return true;}}}}}};}function elementMatcher(matchers){return matchers.length > 1?function(elem, context, xml){var i=matchers.length;while(i--) {if(!matchers[i](elem, context, xml)){return false;}}return true;}:matchers[0];}function multipleContexts(selector, contexts, results){var i=0, len=contexts.length;for(; i < len; i++) {Sizzle(selector, contexts[i], results);}return results;}function condense(unmatched, map, filter, context, xml){var elem, newUnmatched=[], i=0, len=unmatched.length, mapped=map != null;for(; i < len; i++) {if(elem = unmatched[i]){if(!filter || filter(elem, context, xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}return newUnmatched;}function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector){if(postFilter && !postFilter[expando]){postFilter = setMatcher(postFilter);}if(postFinder && !postFinder[expando]){postFinder = setMatcher(postFinder, postSelector);}return markFunction(function(seed, results, context, xml){var temp, i, elem, preMap=[], postMap=[], preexisting=results.length, elems=seed || multipleContexts(selector || "*", context.nodeType?[context]:context, []), matcherIn=preFilter && (seed || !selector)?condense(elems, preMap, preFilter, context, xml):elems, matcherOut=matcher?postFinder || (seed?preFilter:preexisting || postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn, matcherOut, context, xml);}if(postFilter){temp = condense(matcherOut, postMap);postFilter(temp, [], context, xml);i = temp.length;while(i--) {if(elem = temp[i]){matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);}}}if(seed){if(postFinder || preFilter){if(postFinder){temp = [];i = matcherOut.length;while(i--) {if(elem = matcherOut[i]){temp.push(matcherIn[i] = elem);}}postFinder(null, matcherOut = [], temp, xml);}i = matcherOut.length;while(i--) {if((elem = matcherOut[i]) && (temp = postFinder?indexOf(seed, elem):preMap[i]) > -1){seed[temp] = !(results[temp] = elem);}}}}else {matcherOut = condense(matcherOut === results?matcherOut.splice(preexisting, matcherOut.length):matcherOut);if(postFinder){postFinder(null, results, matcherOut, xml);}else {push.apply(results, matcherOut);}}});}function matcherFromTokens(tokens){var checkContext, matcher, j, len=tokens.length, leadingRelative=Expr.relative[tokens[0].type], implicitRelative=leadingRelative || Expr.relative[" "], i=leadingRelative?1:0, matchContext=addCombinator(function(elem){return elem === checkContext;}, implicitRelative, true), matchAnyContext=addCombinator(function(elem){return indexOf(checkContext, elem) > -1;}, implicitRelative, true), matchers=[function(elem, context, xml){var ret=!leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType?matchContext(elem, context, xml):matchAnyContext(elem, context, xml));checkContext = null;return ret;}];for(; i < len; i++) {if(matcher = Expr.relative[tokens[i].type]){matchers = [addCombinator(elementMatcher(matchers), matcher)];}else {matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);if(matcher[expando]){j = ++i;for(; j < len; j++) {if(Expr.relative[tokens[j].type]){break;}}return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({value:tokens[i - 2].type === " "?"*":""})).replace(rtrim, "$1"), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));}matchers.push(matcher);}}return elementMatcher(matchers);}function matcherFromGroupMatchers(elementMatchers, setMatchers){var bySet=setMatchers.length > 0, byElement=elementMatchers.length > 0, superMatcher=function superMatcher(seed, context, xml, results, outermost){var elem, j, matcher, matchedCount=0, i="0", unmatched=seed && [], setMatched=[], contextBackup=outermostContext, elems=seed || byElement && Expr.find.TAG("*", outermost), dirrunsUnique=dirruns += contextBackup == null?1:Math.random() || 0.1, len=elems.length;if(outermost){outermostContext = context !== document && context;}for(; i !== len && (elem = elems[i]) != null; i++) {if(byElement && elem){j = 0;while(matcher = elementMatchers[j++]) {if(matcher(elem, context, xml)){results.push(elem);break;}}if(outermost){dirruns = dirrunsUnique;}}if(bySet){if(elem = !matcher && elem){matchedCount--;}if(seed){unmatched.push(elem);}}}matchedCount += i;if(bySet && i !== matchedCount){j = 0;while(matcher = setMatchers[j++]) {matcher(unmatched, setMatched, context, xml);}if(seed){if(matchedCount > 0){while(i--) {if(!(unmatched[i] || setMatched[i])){setMatched[i] = pop.call(results);}}}setMatched = condense(setMatched);}push.apply(results, setMatched);if(outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1){Sizzle.uniqueSort(results);}}if(outermost){dirruns = dirrunsUnique;outermostContext = contextBackup;}return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}compile = Sizzle.compile = function(selector, match){var i, setMatchers=[], elementMatchers=[], cached=compilerCache[selector + " "];if(!cached){if(!match){match = tokenize(selector);}i = match.length;while(i--) {cached = matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else {elementMatchers.push(cached);}}cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));cached.selector = selector;}return cached;};select = Sizzle.select = function(selector, context, results, seed){var i, tokens, token, type, find, compiled=typeof selector === "function" && selector, match=!seed && tokenize(selector = compiled.selector || selector);results = results || [];if(match.length === 1){tokens = match[0] = match[0].slice(0);if(tokens.length > 2 && (token = tokens[0]).type === "ID" && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]){context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];if(!context){return results;}else if(compiled){context = context.parentNode;}selector = selector.slice(tokens.shift().value.length);}i = matchExpr.needsContext.test(selector)?0:tokens.length;while(i--) {token = tokens[i];if(Expr.relative[type = token.type]){break;}if(find = Expr.find[type]){if(seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)){tokens.splice(i, 1);selector = seed.length && toSelector(tokens);if(!selector){push.apply(results, seed);return results;}break;}}}}(compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);return results;};support.sortStable = expando.split("").sort(sortOrder).join("") === expando;support.detectDuplicates = !!hasDuplicate;setDocument();support.sortDetached = assert(function(div1){return div1.compareDocumentPosition(document.createElement("div")) & 1;});if(!assert(function(div){div.innerHTML = "<a href='#'></a>";return div.firstChild.getAttribute("href") === "#";})){addHandle("type|href|height|width", function(elem, name, isXML){if(!isXML){return elem.getAttribute(name, name.toLowerCase() === "type"?1:2);}});}if(!support.attributes || !assert(function(div){div.innerHTML = "<input/>";div.firstChild.setAttribute("value", "");return div.firstChild.getAttribute("value") === "";})){addHandle("value", function(elem, name, isXML){if(!isXML && elem.nodeName.toLowerCase() === "input"){return elem.defaultValue;}});}if(!assert(function(div){return div.getAttribute("disabled") == null;})){addHandle(booleans, function(elem, name, isXML){var val;if(!isXML){return elem[name] === true?name.toLowerCase():(val = elem.getAttributeNode(name)) && val.specified?val.value:null;}});}return Sizzle;})(window);jQuery.find = Sizzle;jQuery.expr = Sizzle.selectors;jQuery.expr[":"] = jQuery.expr.pseudos;jQuery.unique = Sizzle.uniqueSort;jQuery.text = Sizzle.getText;jQuery.isXMLDoc = Sizzle.isXML;jQuery.contains = Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements, qualifier, not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements, function(elem, i){return !!qualifier.call(elem, i, elem) !== not;});}if(qualifier.nodeType){return jQuery.grep(elements, function(elem){return elem === qualifier !== not;});}if(typeof qualifier === "string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier, elements, not);}qualifier = jQuery.filter(qualifier, elements);}return jQuery.grep(elements, function(elem){return indexOf.call(qualifier, elem) >= 0 !== not;});}jQuery.filter = function(expr, elems, not){var elem=elems[0];if(not){expr = ":not(" + expr + ")";}return elems.length === 1 && elem.nodeType === 1?jQuery.find.matchesSelector(elem, expr)?[elem]:[]:jQuery.find.matches(expr, jQuery.grep(elems, function(elem){return elem.nodeType === 1;}));};jQuery.fn.extend({find:function find(selector){var i, len=this.length, ret=[], self=this;if(typeof selector !== "string"){return this.pushStack(jQuery(selector).filter(function(){for(i = 0; i < len; i++) {if(jQuery.contains(self[i], this)){return true;}}}));}for(i = 0; i < len; i++) {jQuery.find(selector, self[i], ret);}ret = this.pushStack(len > 1?jQuery.unique(ret):ret);ret.selector = this.selector?this.selector + " " + selector:selector;return ret;}, filter:function filter(selector){return this.pushStack(winnow(this, selector || [], false));}, not:function not(selector){return this.pushStack(winnow(this, selector || [], true));}, is:function is(selector){return !!winnow(this, typeof selector === "string" && rneedsContext.test(selector)?jQuery(selector):selector || [], false).length;}});var rootjQuery, rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, init=jQuery.fn.init = function(selector, context){var match, elem;if(!selector){return this;}if(typeof selector === "string"){if(selector[0] === "<" && selector[selector.length - 1] === ">" && selector.length >= 3){match = [null, selector, null];}else {match = rquickExpr.exec(selector);}if(match && (match[1] || !context)){if(match[1]){context = context instanceof jQuery?context[0]:context;jQuery.merge(this, jQuery.parseHTML(match[1], context && context.nodeType?context.ownerDocument || context:document, true));if(rsingleTag.test(match[1]) && jQuery.isPlainObject(context)){for(match in context) {if(jQuery.isFunction(this[match])){this[match](context[match]);}else {this.attr(match, context[match]);}}}return this;}else {elem = document.getElementById(match[2]);if(elem && elem.parentNode){this.length = 1;this[0] = elem;}this.context = document;this.selector = selector;return this;}}else if(!context || context.jquery){return (context || rootjQuery).find(selector);}else {return this.constructor(context).find(selector);}}else if(selector.nodeType){this.context = this[0] = selector;this.length = 1;return this;}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready !== "undefined"?rootjQuery.ready(selector):selector(jQuery);}if(selector.selector !== undefined){this.selector = selector.selector;this.context = selector.context;}return jQuery.makeArray(selector, this);};init.prototype = jQuery.fn;rootjQuery = jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/, guaranteedUnique={children:true, contents:true, next:true, prev:true};jQuery.extend({dir:(function(_dir){var _dirWrapper=function dir(_x, _x2, _x3){return _dir.apply(this, arguments);};_dirWrapper.toString = function(){return _dir.toString();};return _dirWrapper;})(function(elem, dir, until){var matched=[], truncate=until !== undefined;while((elem = elem[dir]) && elem.nodeType !== 9) {if(elem.nodeType === 1){if(truncate && jQuery(elem).is(until)){break;}matched.push(elem);}}return matched;}), sibling:function sibling(n, elem){var matched=[];for(; n; n = n.nextSibling) {if(n.nodeType === 1 && n !== elem){matched.push(n);}}return matched;}});jQuery.fn.extend({has:function has(target){var targets=jQuery(target, this), l=targets.length;return this.filter(function(){var i=0;for(; i < l; i++) {if(jQuery.contains(this, targets[i])){return true;}}});}, closest:function closest(selectors, context){var cur, i=0, l=this.length, matched=[], pos=rneedsContext.test(selectors) || typeof selectors !== "string"?jQuery(selectors, context || this.context):0;for(; i < l; i++) {for(cur = this[i]; cur && cur !== context; cur = cur.parentNode) {if(cur.nodeType < 11 && (pos?pos.index(cur) > -1:cur.nodeType === 1 && jQuery.find.matchesSelector(cur, selectors))){matched.push(cur);break;}}}return this.pushStack(matched.length > 1?jQuery.unique(matched):matched);}, index:function index(elem){if(!elem){return this[0] && this[0].parentNode?this.first().prevAll().length:-1;}if(typeof elem === "string"){return indexOf.call(jQuery(elem), this[0]);}return indexOf.call(this, elem.jquery?elem[0]:elem);}, add:function add(selector, context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(), jQuery(selector, context))));}, addBack:function addBack(selector){return this.add(selector == null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur, dir){while((cur = cur[dir]) && cur.nodeType !== 1) {}return cur;}jQuery.each({parent:(function(_parent){var _parentWrapper=function parent(_x){return _parent.apply(this, arguments);};_parentWrapper.toString = function(){return _parent.toString();};return _parentWrapper;})(function(elem){var parent=elem.parentNode;return parent && parent.nodeType !== 11?parent:null;}), parents:function parents(elem){return jQuery.dir(elem, "parentNode");}, parentsUntil:function parentsUntil(elem, i, until){return jQuery.dir(elem, "parentNode", until);}, next:function next(elem){return sibling(elem, "nextSibling");}, prev:function prev(elem){return sibling(elem, "previousSibling");}, nextAll:function nextAll(elem){return jQuery.dir(elem, "nextSibling");}, prevAll:function prevAll(elem){return jQuery.dir(elem, "previousSibling");}, nextUntil:function nextUntil(elem, i, until){return jQuery.dir(elem, "nextSibling", until);}, prevUntil:function prevUntil(elem, i, until){return jQuery.dir(elem, "previousSibling", until);}, siblings:function siblings(elem){return jQuery.sibling((elem.parentNode || {}).firstChild, elem);}, children:function children(elem){return jQuery.sibling(elem.firstChild);}, contents:function contents(elem){return elem.contentDocument || jQuery.merge([], elem.childNodes);}}, function(name, fn){jQuery.fn[name] = function(until, selector){var matched=jQuery.map(this, fn, until);if(name.slice(-5) !== "Until"){selector = until;}if(selector && typeof selector === "string"){matched = jQuery.filter(selector, matched);}if(this.length > 1){if(!guaranteedUnique[name]){jQuery.unique(matched);}if(rparentsprev.test(name)){matched.reverse();}}return this.pushStack(matched);};});var rnotwhite=/\S+/g;var optionsCache={};function createOptions(options){var object=optionsCache[options] = {};jQuery.each(options.match(rnotwhite) || [], function(_, flag){object[flag] = true;});return object;}jQuery.Callbacks = function(options){options = typeof options === "string"?optionsCache[options] || createOptions(options):jQuery.extend({}, options);var memory, fired, firing, firingStart, firingLength, firingIndex, list=[], stack=!options.once && [], fire=(function(_fire){var _fireWrapper=function fire(_x){return _fire.apply(this, arguments);};_fireWrapper.toString = function(){return _fire.toString();};return _fireWrapper;})(function(data){memory = options.memory && data;fired = true;firingIndex = firingStart || 0;firingStart = 0;firingLength = list.length;firing = true;for(; list && firingIndex < firingLength; firingIndex++) {if(list[firingIndex].apply(data[0], data[1]) === false && options.stopOnFalse){memory = false;break;}}firing = false;if(list){if(stack){if(stack.length){fire(stack.shift());}}else if(memory){list = [];}else {self.disable();}}}), self={add:function add(){if(list){var start=list.length;(function add(args){jQuery.each(args, function(_, arg){var type=jQuery.type(arg);if(type === "function"){if(!options.unique || !self.has(arg)){list.push(arg);}}else if(arg && arg.length && type !== "string"){add(arg);}});})(arguments);if(firing){firingLength = list.length;}else if(memory){firingStart = start;fire(memory);}}return this;}, remove:function remove(){if(list){jQuery.each(arguments, function(_, arg){var index;while((index = jQuery.inArray(arg, list, index)) > -1) {list.splice(index, 1);if(firing){if(index <= firingLength){firingLength--;}if(index <= firingIndex){firingIndex--;}}}});}return this;}, has:function has(fn){return fn?jQuery.inArray(fn, list) > -1:!!(list && list.length);}, empty:function empty(){list = [];firingLength = 0;return this;}, disable:function disable(){list = stack = memory = undefined;return this;}, disabled:function disabled(){return !list;}, lock:function lock(){stack = undefined;if(!memory){self.disable();}return this;}, locked:function locked(){return !stack;}, fireWith:function fireWith(context, args){if(list && (!fired || stack)){args = args || [];args = [context, args.slice?args.slice():args];if(firing){stack.push(args);}else {fire(args);}}return this;}, fire:function fire(){self.fireWith(this, arguments);return this;}, fired:(function(_fired){var _firedWrapper=function fired(){return _fired.apply(this, arguments);};_firedWrapper.toString = function(){return _fired.toString();};return _firedWrapper;})(function(){return !!fired;})};return self;};jQuery.extend({Deferred:function Deferred(func){var tuples=[["resolve", "done", jQuery.Callbacks("once memory"), "resolved"], ["reject", "fail", jQuery.Callbacks("once memory"), "rejected"], ["notify", "progress", jQuery.Callbacks("memory")]], state="pending", promise={state:(function(_state){var _stateWrapper=function state(){return _state.apply(this, arguments);};_stateWrapper.toString = function(){return _state.toString();};return _stateWrapper;})(function(){return state;}), always:function always(){deferred.done(arguments).fail(arguments);return this;}, then:function then(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples, function(i, tuple){var fn=jQuery.isFunction(fns[i]) && fns[i];deferred[tuple[1]](function(){var returned=fn && fn.apply(this, arguments);if(returned && jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);}else {newDefer[tuple[0] + "With"](this === promise?newDefer.promise():this, fn?[returned]:arguments);}});});fns = null;}).promise();}, promise:(function(_promise){var _promiseWrapper=function promise(_x){return _promise.apply(this, arguments);};_promiseWrapper.toString = function(){return _promise.toString();};return _promiseWrapper;})(function(obj){return obj != null?jQuery.extend(obj, promise):promise;})}, deferred={};promise.pipe = promise.then;jQuery.each(tuples, function(i, tuple){var list=tuple[2], stateString=tuple[3];promise[tuple[1]] = list.add;if(stateString){list.add(function(){state = stateString;}, tuples[i ^ 1][2].disable, tuples[2][2].lock);}deferred[tuple[0]] = function(){deferred[tuple[0] + "With"](this === deferred?promise:this, arguments);return this;};deferred[tuple[0] + "With"] = list.fireWith;});promise.promise(deferred);if(func){func.call(deferred, deferred);}return deferred;}, when:function when(subordinate){var i=0, resolveValues=slice.call(arguments), length=resolveValues.length, remaining=length !== 1 || subordinate && jQuery.isFunction(subordinate.promise)?length:0, deferred=remaining === 1?subordinate:jQuery.Deferred(), updateFunc=function updateFunc(i, contexts, values){return function(value){contexts[i] = this;values[i] = arguments.length > 1?slice.call(arguments):value;if(values === progressValues){deferred.notifyWith(contexts, values);}else if(! --remaining){deferred.resolveWith(contexts, values);}};}, progressValues, progressContexts, resolveContexts;if(length > 1){progressValues = new Array(length);progressContexts = new Array(length);resolveContexts = new Array(length);for(; i < length; i++) {if(resolveValues[i] && jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i, resolveContexts, resolveValues)).fail(deferred.reject).progress(updateFunc(i, progressContexts, progressValues));}else {--remaining;}}}if(!remaining){deferred.resolveWith(resolveContexts, resolveValues);}return deferred.promise();}});var readyList;jQuery.fn.ready = function(fn){jQuery.ready.promise().done(fn);return this;};jQuery.extend({isReady:false, readyWait:1, holdReady:function holdReady(hold){if(hold){jQuery.readyWait++;}else {jQuery.ready(true);}}, ready:function ready(wait){if(wait === true?--jQuery.readyWait:jQuery.isReady){return;}jQuery.isReady = true;if(wait !== true && --jQuery.readyWait > 0){return;}readyList.resolveWith(document, [jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready");}}});function completed(){document.removeEventListener("DOMContentLoaded", completed, false);window.removeEventListener("load", completed, false);jQuery.ready();}jQuery.ready.promise = function(obj){if(!readyList){readyList = jQuery.Deferred();if(document.readyState === "complete"){setTimeout(jQuery.ready);}else {document.addEventListener("DOMContentLoaded", completed, false);window.addEventListener("load", completed, false);}}return readyList.promise(obj);};jQuery.ready.promise();var access=jQuery.access = function(elems, fn, key, value, chainable, emptyGet, raw){var i=0, len=elems.length, bulk=key == null;if(jQuery.type(key) === "object"){chainable = true;for(i in key) {jQuery.access(elems, fn, i, key[i], true, emptyGet, raw);}}else if(value !== undefined){chainable = true;if(!jQuery.isFunction(value)){raw = true;}if(bulk){if(raw){fn.call(elems, value);fn = null;}else {bulk = fn;fn = function(elem, key, value){return bulk.call(jQuery(elem), value);};}}if(fn){for(; i < len; i++) {fn(elems[i], key, raw?value:value.call(elems[i], i, fn(elems[i], key)));}}}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0], key):emptyGet;};jQuery.acceptData = function(owner){return owner.nodeType === 1 || owner.nodeType === 9 || ! +owner.nodeType;};function Data(){Object.defineProperty(this.cache = {}, 0, {get:function get(){return {};}});this.expando = jQuery.expando + Data.uid++;}Data.uid = 1;Data.accepts = jQuery.acceptData;Data.prototype = {key:function key(owner){if(!Data.accepts(owner)){return 0;}var descriptor={}, unlock=owner[this.expando];if(!unlock){unlock = Data.uid++;try{descriptor[this.expando] = {value:unlock};Object.defineProperties(owner, descriptor);}catch(e) {descriptor[this.expando] = unlock;jQuery.extend(owner, descriptor);}}if(!this.cache[unlock]){this.cache[unlock] = {};}return unlock;}, set:function set(owner, data, value){var prop, unlock=this.key(owner), cache=this.cache[unlock];if(typeof data === "string"){cache[data] = value;}else {if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock], data);}else {for(prop in data) {cache[prop] = data[prop];}}}return cache;}, get:function get(owner, key){var cache=this.cache[this.key(owner)];return key === undefined?cache:cache[key];}, access:function access(owner, key, value){var stored;if(key === undefined || key && typeof key === "string" && value === undefined){stored = this.get(owner, key);return stored !== undefined?stored:this.get(owner, jQuery.camelCase(key));}this.set(owner, key, value);return value !== undefined?value:key;}, remove:function remove(owner, key){var i, name, camel, unlock=this.key(owner), cache=this.cache[unlock];if(key === undefined){this.cache[unlock] = {};}else {if(jQuery.isArray(key)){name = key.concat(key.map(jQuery.camelCase));}else {camel = jQuery.camelCase(key);if(key in cache){name = [key, camel];}else {name = camel;name = name in cache?[name]:name.match(rnotwhite) || [];}}i = name.length;while(i--) {delete cache[name[i]];}}}, hasData:function hasData(owner){return !jQuery.isEmptyObject(this.cache[owner[this.expando]] || {});}, discard:function discard(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]];}}};var data_priv=new Data();var data_user=new Data();var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, rmultiDash=/([A-Z])/g;function dataAttr(elem, key, data){var name;if(data === undefined && elem.nodeType === 1){name = "data-" + key.replace(rmultiDash, "-$1").toLowerCase();data = elem.getAttribute(name);if(typeof data === "string"){try{data = data === "true"?true:data === "false"?false:data === "null"?null:+data + "" === data?+data:rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e) {}data_user.set(elem, key, data);}else {data = undefined;}}return data;}jQuery.extend({hasData:function hasData(elem){return data_user.hasData(elem) || data_priv.hasData(elem);}, data:(function(_data){var _dataWrapper=function data(_x, _x2, _x3){return _data.apply(this, arguments);};_dataWrapper.toString = function(){return _data.toString();};return _dataWrapper;})(function(elem, name, data){return data_user.access(elem, name, data);}), removeData:function removeData(elem, name){data_user.remove(elem, name);}, _data:function _data(elem, name, data){return data_priv.access(elem, name, data);}, _removeData:function _removeData(elem, name){data_priv.remove(elem, name);}});jQuery.fn.extend({data:(function(_data){var _dataWrapper=function data(_x, _x2){return _data.apply(this, arguments);};_dataWrapper.toString = function(){return _data.toString();};return _dataWrapper;})(function(key, value){var i, name, data, elem=this[0], attrs=elem && elem.attributes;if(key === undefined){if(this.length){data = data_user.get(elem);if(elem.nodeType === 1 && !data_priv.get(elem, "hasDataAttrs")){i = attrs.length;while(i--) {if(attrs[i]){name = attrs[i].name;if(name.indexOf("data-") === 0){name = jQuery.camelCase(name.slice(5));dataAttr(elem, name, data[name]);}}}data_priv.set(elem, "hasDataAttrs", true);}}return data;}if(typeof key === "object"){return this.each(function(){data_user.set(this, key);});}return access(this, function(value){var data, camelKey=jQuery.camelCase(key);if(elem && value === undefined){data = data_user.get(elem, key);if(data !== undefined){return data;}data = data_user.get(elem, camelKey);if(data !== undefined){return data;}data = dataAttr(elem, camelKey, undefined);if(data !== undefined){return data;}return;}this.each(function(){var data=data_user.get(this, camelKey);data_user.set(this, camelKey, value);if(key.indexOf("-") !== -1 && data !== undefined){data_user.set(this, key, value);}});}, null, value, arguments.length > 1, null, true);}), removeData:function removeData(key){return this.each(function(){data_user.remove(this, key);});}});jQuery.extend({queue:(function(_queue){var _queueWrapper=function queue(_x, _x2, _x3){return _queue.apply(this, arguments);};_queueWrapper.toString = function(){return _queue.toString();};return _queueWrapper;})(function(elem, type, data){var queue;if(elem){type = (type || "fx") + "queue";queue = data_priv.get(elem, type);if(data){if(!queue || jQuery.isArray(data)){queue = data_priv.access(elem, type, jQuery.makeArray(data));}else {queue.push(data);}}return queue || [];}}), dequeue:function dequeue(elem, type){type = type || "fx";var queue=jQuery.queue(elem, type), startLength=queue.length, fn=queue.shift(), hooks=jQuery._queueHooks(elem, type), next=function next(){jQuery.dequeue(elem, type);};if(fn === "inprogress"){fn = queue.shift();startLength--;}if(fn){if(type === "fx"){queue.unshift("inprogress");}delete hooks.stop;fn.call(elem, next, hooks);}if(!startLength && hooks){hooks.empty.fire();}}, _queueHooks:function _queueHooks(elem, type){var key=type + "queueHooks";return data_priv.get(elem, key) || data_priv.access(elem, key, {empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem, [type + "queue", key]);})});}});jQuery.fn.extend({queue:function queue(type, data){var setter=2;if(typeof type !== "string"){data = type;type = "fx";setter--;}if(arguments.length < setter){return jQuery.queue(this[0], type);}return data === undefined?this:this.each(function(){var queue=jQuery.queue(this, type, data);jQuery._queueHooks(this, type);if(type === "fx" && queue[0] !== "inprogress"){jQuery.dequeue(this, type);}});}, dequeue:function dequeue(type){return this.each(function(){jQuery.dequeue(this, type);});}, clearQueue:function clearQueue(type){return this.queue(type || "fx", []);}, promise:function promise(type, obj){var tmp, count=1, defer=jQuery.Deferred(), elements=this, i=this.length, resolve=function resolve(){if(! --count){defer.resolveWith(elements, [elements]);}};if(typeof type !== "string"){obj = type;type = undefined;}type = type || "fx";while(i--) {tmp = data_priv.get(elements[i], type + "queueHooks");if(tmp && tmp.empty){count++;tmp.empty.add(resolve);}}resolve();return defer.promise(obj);}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var cssExpand=["Top", "Right", "Bottom", "Left"];var isHidden=function isHidden(elem, el){elem = el || elem;return jQuery.css(elem, "display") === "none" || !jQuery.contains(elem.ownerDocument, elem);};var rcheckableType=/^(?:checkbox|radio)$/i;(function(){var fragment=document.createDocumentFragment(), div=fragment.appendChild(document.createElement("div")), input=document.createElement("input");input.setAttribute("type", "radio");input.setAttribute("checked", "checked");input.setAttribute("name", "t");div.appendChild(input);support.checkClone = div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML = "<textarea>x</textarea>";support.noCloneChecked = !!div.cloneNode(true).lastChild.defaultValue;})();var strundefined=typeof undefined;support.focusinBubbles = "onfocusin" in window;var rkeyEvent=/^key/, rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/, rfocusMorph=/^(?:focusinfocus|focusoutblur)$/, rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true;}function returnFalse(){return false;}function safeActiveElement(){try{return document.activeElement;}catch(err) {}}jQuery.event = {global:{}, add:function add(elem, types, handler, data, selector){var handleObjIn, eventHandle, tmp, events, t, handleObj, special, handlers, type, namespaces, origType, elemData=data_priv.get(elem);if(!elemData){return;}if(handler.handler){handleObjIn = handler;handler = handleObjIn.handler;selector = handleObjIn.selector;}if(!handler.guid){handler.guid = jQuery.guid++;}if(!(events = elemData.events)){events = elemData.events = {};}if(!(eventHandle = elemData.handle)){eventHandle = elemData.handle = function(e){return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type?jQuery.event.dispatch.apply(elem, arguments):undefined;};}types = (types || "").match(rnotwhite) || [""];t = types.length;while(t--) {tmp = rtypenamespace.exec(types[t]) || [];type = origType = tmp[1];namespaces = (tmp[2] || "").split(".").sort();if(!type){continue;}special = jQuery.event.special[type] || {};type = (selector?special.delegateType:special.bindType) || type;special = jQuery.event.special[type] || {};handleObj = jQuery.extend({type:type, origType:origType, data:data, handler:handler, guid:handler.guid, selector:selector, needsContext:selector && jQuery.expr.match.needsContext.test(selector), namespace:namespaces.join(".")}, handleObjIn);if(!(handlers = events[type])){handlers = events[type] = [];handlers.delegateCount = 0;if(!special.setup || special.setup.call(elem, data, namespaces, eventHandle) === false){if(elem.addEventListener){elem.addEventListener(type, eventHandle, false);}}}if(special.add){special.add.call(elem, handleObj);if(!handleObj.handler.guid){handleObj.handler.guid = handler.guid;}}if(selector){handlers.splice(handlers.delegateCount++, 0, handleObj);}else {handlers.push(handleObj);}jQuery.event.global[type] = true;}}, remove:function remove(elem, types, handler, selector, mappedTypes){var j, origCount, tmp, events, t, handleObj, special, handlers, type, namespaces, origType, elemData=data_priv.hasData(elem) && data_priv.get(elem);if(!elemData || !(events = elemData.events)){return;}types = (types || "").match(rnotwhite) || [""];t = types.length;while(t--) {tmp = rtypenamespace.exec(types[t]) || [];type = origType = tmp[1];namespaces = (tmp[2] || "").split(".").sort();if(!type){for(type in events) {jQuery.event.remove(elem, type + types[t], handler, selector, true);}continue;}special = jQuery.event.special[type] || {};type = (selector?special.delegateType:special.bindType) || type;handlers = events[type] || [];tmp = tmp[2] && new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)");origCount = j = handlers.length;while(j--) {handleObj = handlers[j];if((mappedTypes || origType === handleObj.origType) && (!handler || handler.guid === handleObj.guid) && (!tmp || tmp.test(handleObj.namespace)) && (!selector || selector === handleObj.selector || selector === "**" && handleObj.selector)){handlers.splice(j, 1);if(handleObj.selector){handlers.delegateCount--;}if(special.remove){special.remove.call(elem, handleObj);}}}if(origCount && !handlers.length){if(!special.teardown || special.teardown.call(elem, namespaces, elemData.handle) === false){jQuery.removeEvent(elem, type, elemData.handle);}delete events[type];}}if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem, "events");}}, trigger:function trigger(event, data, elem, onlyHandlers){var i, cur, tmp, bubbleType, ontype, handle, special, eventPath=[elem || document], type=hasOwn.call(event, "type")?event.type:event, namespaces=hasOwn.call(event, "namespace")?event.namespace.split("."):[];cur = tmp = elem = elem || document;if(elem.nodeType === 3 || elem.nodeType === 8){return;}if(rfocusMorph.test(type + jQuery.event.triggered)){return;}if(type.indexOf(".") >= 0){namespaces = type.split(".");type = namespaces.shift();namespaces.sort();}ontype = type.indexOf(":") < 0 && "on" + type;event = event[jQuery.expando]?event:new jQuery.Event(type, typeof event === "object" && event);event.isTrigger = onlyHandlers?2:3;event.namespace = namespaces.join(".");event.namespace_re = event.namespace?new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)"):null;event.result = undefined;if(!event.target){event.target = elem;}data = data == null?[event]:jQuery.makeArray(data, [event]);special = jQuery.event.special[type] || {};if(!onlyHandlers && special.trigger && special.trigger.apply(elem, data) === false){return;}if(!onlyHandlers && !special.noBubble && !jQuery.isWindow(elem)){bubbleType = special.delegateType || type;if(!rfocusMorph.test(bubbleType + type)){cur = cur.parentNode;}for(; cur; cur = cur.parentNode) {eventPath.push(cur);tmp = cur;}if(tmp === (elem.ownerDocument || document)){eventPath.push(tmp.defaultView || tmp.parentWindow || window);}}i = 0;while((cur = eventPath[i++]) && !event.isPropagationStopped()) {event.type = i > 1?bubbleType:special.bindType || type;handle = (data_priv.get(cur, "events") || {})[event.type] && data_priv.get(cur, "handle");if(handle){handle.apply(cur, data);}handle = ontype && cur[ontype];if(handle && handle.apply && jQuery.acceptData(cur)){event.result = handle.apply(cur, data);if(event.result === false){event.preventDefault();}}}event.type = type;if(!onlyHandlers && !event.isDefaultPrevented()){if((!special._default || special._default.apply(eventPath.pop(), data) === false) && jQuery.acceptData(elem)){if(ontype && jQuery.isFunction(elem[type]) && !jQuery.isWindow(elem)){tmp = elem[ontype];if(tmp){elem[ontype] = null;}jQuery.event.triggered = type;elem[type]();jQuery.event.triggered = undefined;if(tmp){elem[ontype] = tmp;}}}}return event.result;}, dispatch:function dispatch(event){event = jQuery.event.fix(event);var i, j, ret, matched, handleObj, handlerQueue=[], args=slice.call(arguments), handlers=(data_priv.get(this, "events") || {})[event.type] || [], special=jQuery.event.special[event.type] || {};args[0] = event;event.delegateTarget = this;if(special.preDispatch && special.preDispatch.call(this, event) === false){return;}handlerQueue = jQuery.event.handlers.call(this, event, handlers);i = 0;while((matched = handlerQueue[i++]) && !event.isPropagationStopped()) {event.currentTarget = matched.elem;j = 0;while((handleObj = matched.handlers[j++]) && !event.isImmediatePropagationStopped()) {if(!event.namespace_re || event.namespace_re.test(handleObj.namespace)){event.handleObj = handleObj;event.data = handleObj.data;ret = ((jQuery.event.special[handleObj.origType] || {}).handle || handleObj.handler).apply(matched.elem, args);if(ret !== undefined){if((event.result = ret) === false){event.preventDefault();event.stopPropagation();}}}}}if(special.postDispatch){special.postDispatch.call(this, event);}return event.result;}, handlers:(function(_handlers){var _handlersWrapper=function handlers(_x, _x2){return _handlers.apply(this, arguments);};_handlersWrapper.toString = function(){return _handlers.toString();};return _handlersWrapper;})(function(event, handlers){var i, matches, sel, handleObj, handlerQueue=[], delegateCount=handlers.delegateCount, cur=event.target;if(delegateCount && cur.nodeType && (!event.button || event.type !== "click")){for(; cur !== this; cur = cur.parentNode || this) {if(cur.disabled !== true || event.type !== "click"){matches = [];for(i = 0; i < delegateCount; i++) {handleObj = handlers[i];sel = handleObj.selector + " ";if(matches[sel] === undefined){matches[sel] = handleObj.needsContext?jQuery(sel, this).index(cur) >= 0:jQuery.find(sel, this, null, [cur]).length;}if(matches[sel]){matches.push(handleObj);}}if(matches.length){handlerQueue.push({elem:cur, handlers:matches});}}}}if(delegateCount < handlers.length){handlerQueue.push({elem:this, handlers:handlers.slice(delegateCount)});}return handlerQueue;}), props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks:{}, keyHooks:{props:"char charCode key keyCode".split(" "), filter:function filter(event, original){if(event.which == null){event.which = original.charCode != null?original.charCode:original.keyCode;}return event;}}, mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter:function filter(event, original){var eventDoc, doc, body, button=original.button;if(event.pageX == null && original.clientX != null){eventDoc = event.target.ownerDocument || document;doc = eventDoc.documentElement;body = eventDoc.body;event.pageX = original.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);event.pageY = original.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);}if(!event.which && button !== undefined){event.which = button & 1?1:button & 2?3:button & 4?2:0;}return event;}}, fix:function fix(event){if(event[jQuery.expando]){return event;}var i, prop, copy, type=event.type, originalEvent=event, fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type] = fixHook = rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};}copy = fixHook.props?this.props.concat(fixHook.props):this.props;event = new jQuery.Event(originalEvent);i = copy.length;while(i--) {prop = copy[i];event[prop] = originalEvent[prop];}if(!event.target){event.target = document;}if(event.target.nodeType === 3){event.target = event.target.parentNode;}return fixHook.filter?fixHook.filter(event, originalEvent):event;}, special:{load:{noBubble:true}, focus:{trigger:function trigger(){if(this !== safeActiveElement() && this.focus){this.focus();return false;}}, delegateType:"focusin"}, blur:{trigger:function trigger(){if(this === safeActiveElement() && this.blur){this.blur();return false;}}, delegateType:"focusout"}, click:{trigger:function trigger(){if(this.type === "checkbox" && this.click && jQuery.nodeName(this, "input")){this.click();return false;}}, _default:function _default(event){return jQuery.nodeName(event.target, "a");}}, beforeunload:{postDispatch:function postDispatch(event){if(event.result !== undefined && event.originalEvent){event.originalEvent.returnValue = event.result;}}}}, simulate:function simulate(type, elem, event, bubble){var e=jQuery.extend(new jQuery.Event(), event, {type:type, isSimulated:true, originalEvent:{}});if(bubble){jQuery.event.trigger(e, null, elem);}else {jQuery.event.dispatch.call(elem, e);}if(e.isDefaultPrevented()){event.preventDefault();}}};jQuery.removeEvent = function(elem, type, handle){if(elem.removeEventListener){elem.removeEventListener(type, handle, false);}};jQuery.Event = function(src, props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src, props);}if(src && src.type){this.originalEvent = src;this.type = src.type;this.isDefaultPrevented = src.defaultPrevented || src.defaultPrevented === undefined && src.returnValue === false?returnTrue:returnFalse;}else {this.type = src;}if(props){jQuery.extend(this, props);}this.timeStamp = src && src.timeStamp || jQuery.now();this[jQuery.expando] = true;};jQuery.Event.prototype = {isDefaultPrevented:returnFalse, isPropagationStopped:returnFalse, isImmediatePropagationStopped:returnFalse, preventDefault:function preventDefault(){var e=this.originalEvent;this.isDefaultPrevented = returnTrue;if(e && e.preventDefault){e.preventDefault();}}, stopPropagation:function stopPropagation(){var e=this.originalEvent;this.isPropagationStopped = returnTrue;if(e && e.stopPropagation){e.stopPropagation();}}, stopImmediatePropagation:function stopImmediatePropagation(){var e=this.originalEvent;this.isImmediatePropagationStopped = returnTrue;if(e && e.stopImmediatePropagation){e.stopImmediatePropagation();}this.stopPropagation();}};jQuery.each({mouseenter:"mouseover", mouseleave:"mouseout", pointerenter:"pointerover", pointerleave:"pointerout"}, function(orig, fix){jQuery.event.special[orig] = {delegateType:fix, bindType:fix, handle:function handle(event){var ret, target=this, related=event.relatedTarget, handleObj=event.handleObj;if(!related || related !== target && !jQuery.contains(target, related)){event.type = handleObj.origType;ret = handleObj.handler.apply(this, arguments);event.type = fix;}return ret;}};});if(!support.focusinBubbles){jQuery.each({focus:"focusin", blur:"focusout"}, function(orig, fix){var handler=function handler(event){jQuery.event.simulate(fix, event.target, jQuery.event.fix(event), true);};jQuery.event.special[fix] = {setup:function setup(){var doc=this.ownerDocument || this, attaches=data_priv.access(doc, fix);if(!attaches){doc.addEventListener(orig, handler, true);}data_priv.access(doc, fix, (attaches || 0) + 1);}, teardown:function teardown(){var doc=this.ownerDocument || this, attaches=data_priv.access(doc, fix) - 1;if(!attaches){doc.removeEventListener(orig, handler, true);data_priv.remove(doc, fix);}else {data_priv.access(doc, fix, attaches);}}};});}jQuery.fn.extend({on:function on(types, selector, data, fn, one){var origFn, type;if(typeof types === "object"){if(typeof selector !== "string"){data = data || selector;selector = undefined;}for(type in types) {this.on(type, selector, data, types[type], one);}return this;}if(data == null && fn == null){fn = selector;data = selector = undefined;}else if(fn == null){if(typeof selector === "string"){fn = data;data = undefined;}else {fn = data;data = selector;selector = undefined;}}if(fn === false){fn = returnFalse;}else if(!fn){return this;}if(one === 1){origFn = fn;fn = function(event){jQuery().off(event);return origFn.apply(this, arguments);};fn.guid = origFn.guid || (origFn.guid = jQuery.guid++);}return this.each(function(){jQuery.event.add(this, types, fn, data, selector);});}, one:function one(types, selector, data, fn){return this.on(types, selector, data, fn, 1);}, off:function off(types, selector, fn){var handleObj, type;if(types && types.preventDefault && types.handleObj){handleObj = types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType + "." + handleObj.namespace:handleObj.origType, handleObj.selector, handleObj.handler);return this;}if(typeof types === "object"){for(type in types) {this.off(type, selector, types[type]);}return this;}if(selector === false || typeof selector === "function"){fn = selector;selector = undefined;}if(fn === false){fn = returnFalse;}return this.each(function(){jQuery.event.remove(this, types, fn, selector);});}, trigger:function trigger(type, data){return this.each(function(){jQuery.event.trigger(type, data, this);});}, triggerHandler:function triggerHandler(type, data){var elem=this[0];if(elem){return jQuery.event.trigger(type, data, elem, true);}}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi, rtagName=/<([\w:]+)/, rhtml=/<|&#?\w+;/, rnoInnerhtml=/<(?:script|style|link)/i, rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i, rscriptType=/^$|\/(?:java|ecma)script/i, rscriptTypeMasked=/^true\/(.*)/, rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g, wrapMap={option:[1, "<select multiple='multiple'>", "</select>"], thead:[1, "<table>", "</table>"], col:[2, "<table><colgroup>", "</colgroup></table>"], tr:[2, "<table><tbody>", "</tbody></table>"], td:[3, "<table><tbody><tr>", "</tr></tbody></table>"], _default:[0, "", ""]};wrapMap.optgroup = wrapMap.option;wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;wrapMap.th = wrapMap.td;function manipulationTarget(elem, content){return jQuery.nodeName(elem, "table") && jQuery.nodeName(content.nodeType !== 11?content:content.firstChild, "tr")?elem.getElementsByTagName("tbody")[0] || elem.appendChild(elem.ownerDocument.createElement("tbody")):elem;}function disableScript(elem){elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;return elem;}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type = match[1];}else {elem.removeAttribute("type");}return elem;}function setGlobalEval(elems, refElements){var i=0, l=elems.length;for(; i < l; i++) {data_priv.set(elems[i], "globalEval", !refElements || data_priv.get(refElements[i], "globalEval"));}}function cloneCopyEvent(src, dest){var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;if(dest.nodeType !== 1){return;}if(data_priv.hasData(src)){pdataOld = data_priv.access(src);pdataCur = data_priv.set(dest, pdataOld);events = pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events = {};for(type in events) {for(i = 0, l = events[type].length; i < l; i++) {jQuery.event.add(dest, type, events[type][i]);}}}}if(data_user.hasData(src)){udataOld = data_user.access(src);udataCur = jQuery.extend({}, udataOld);data_user.set(dest, udataCur);}}function getAll(context, tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag || "*"):context.querySelectorAll?context.querySelectorAll(tag || "*"):[];return tag === undefined || tag && jQuery.nodeName(context, tag)?jQuery.merge([context], ret):ret;}function fixInput(src, dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName === "input" && rcheckableType.test(src.type)){dest.checked = src.checked;}else if(nodeName === "input" || nodeName === "textarea"){dest.defaultValue = src.defaultValue;}}jQuery.extend({clone:(function(_clone){var _cloneWrapper=function clone(_x, _x2, _x3){return _clone.apply(this, arguments);};_cloneWrapper.toString = function(){return _clone.toString();};return _cloneWrapper;})(function(elem, dataAndEvents, deepDataAndEvents){var i, l, srcElements, destElements, clone=elem.cloneNode(true), inPage=jQuery.contains(elem.ownerDocument, elem);if(!support.noCloneChecked && (elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem)){destElements = getAll(clone);srcElements = getAll(elem);for(i = 0, l = srcElements.length; i < l; i++) {fixInput(srcElements[i], destElements[i]);}}if(dataAndEvents){if(deepDataAndEvents){srcElements = srcElements || getAll(elem);destElements = destElements || getAll(clone);for(i = 0, l = srcElements.length; i < l; i++) {cloneCopyEvent(srcElements[i], destElements[i]);}}else {cloneCopyEvent(elem, clone);}}destElements = getAll(clone, "script");if(destElements.length > 0){setGlobalEval(destElements, !inPage && getAll(elem, "script"));}return clone;}), buildFragment:function buildFragment(elems, context, scripts, selection){var elem, tmp, tag, wrap, contains, j, fragment=context.createDocumentFragment(), nodes=[], i=0, l=elems.length;for(; i < l; i++) {elem = elems[i];if(elem || elem === 0){if(jQuery.type(elem) === "object"){jQuery.merge(nodes, elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else {tmp = tmp || fragment.appendChild(context.createElement("div"));tag = (rtagName.exec(elem) || ["", ""])[1].toLowerCase();wrap = wrapMap[tag] || wrapMap._default;tmp.innerHTML = wrap[1] + elem.replace(rxhtmlTag, "<$1></$2>") + wrap[2];j = wrap[0];while(j--) {tmp = tmp.lastChild;}jQuery.merge(nodes, tmp.childNodes);tmp = fragment.firstChild;tmp.textContent = "";}}}fragment.textContent = "";i = 0;while(elem = nodes[i++]) {if(selection && jQuery.inArray(elem, selection) !== -1){continue;}contains = jQuery.contains(elem.ownerDocument, elem);tmp = getAll(fragment.appendChild(elem), "script");if(contains){setGlobalEval(tmp);}if(scripts){j = 0;while(elem = tmp[j++]) {if(rscriptType.test(elem.type || "")){scripts.push(elem);}}}}return fragment;}, cleanData:function cleanData(elems){var data, elem, type, key, special=jQuery.event.special, i=0;for(; (elem = elems[i]) !== undefined; i++) {if(jQuery.acceptData(elem)){key = elem[data_priv.expando];if(key && (data = data_priv.cache[key])){if(data.events){for(type in data.events) {if(special[type]){jQuery.event.remove(elem, type);}else {jQuery.removeEvent(elem, type, data.handle);}}}if(data_priv.cache[key]){delete data_priv.cache[key];}}}delete data_user.cache[elem[data_user.expando]];}}});jQuery.fn.extend({text:function text(value){return access(this, function(value){return value === undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9){this.textContent = value;}});}, null, value, arguments.length);}, append:function append(){return this.domManip(arguments, function(elem){if(this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9){var target=manipulationTarget(this, elem);target.appendChild(elem);}});}, prepend:function prepend(){return this.domManip(arguments, function(elem){if(this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9){var target=manipulationTarget(this, elem);target.insertBefore(elem, target.firstChild);}});}, before:function before(){return this.domManip(arguments, function(elem){if(this.parentNode){this.parentNode.insertBefore(elem, this);}});}, after:function after(){return this.domManip(arguments, function(elem){if(this.parentNode){this.parentNode.insertBefore(elem, this.nextSibling);}});}, remove:function remove(selector, keepData){var elem, elems=selector?jQuery.filter(selector, this):this, i=0;for(; (elem = elems[i]) != null; i++) {if(!keepData && elem.nodeType === 1){jQuery.cleanData(getAll(elem));}if(elem.parentNode){if(keepData && jQuery.contains(elem.ownerDocument, elem)){setGlobalEval(getAll(elem, "script"));}elem.parentNode.removeChild(elem);}}return this;}, empty:function empty(){var elem, i=0;for(; (elem = this[i]) != null; i++) {if(elem.nodeType === 1){jQuery.cleanData(getAll(elem, false));elem.textContent = "";}}return this;}, clone:function clone(dataAndEvents, deepDataAndEvents){dataAndEvents = dataAndEvents == null?false:dataAndEvents;deepDataAndEvents = deepDataAndEvents == null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this, dataAndEvents, deepDataAndEvents);});}, html:function html(value){return access(this, function(value){var elem=this[0] || {}, i=0, l=this.length;if(value === undefined && elem.nodeType === 1){return elem.innerHTML;}if(typeof value === "string" && !rnoInnerhtml.test(value) && !wrapMap[(rtagName.exec(value) || ["", ""])[1].toLowerCase()]){value = value.replace(rxhtmlTag, "<$1></$2>");try{for(; i < l; i++) {elem = this[i] || {};if(elem.nodeType === 1){jQuery.cleanData(getAll(elem, false));elem.innerHTML = value;}}elem = 0;}catch(e) {}}if(elem){this.empty().append(value);}}, null, value, arguments.length);}, replaceWith:function replaceWith(){var arg=arguments[0];this.domManip(arguments, function(elem){arg = this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem, this);}});return arg && (arg.length || arg.nodeType)?this:this.remove();}, detach:function detach(selector){return this.remove(selector, true);}, domManip:function domManip(args, callback){args = concat.apply([], args);var fragment, first, scripts, hasScripts, node, doc, i=0, l=this.length, set=this, iNoClone=l - 1, value=args[0], isFunction=jQuery.isFunction(value);if(isFunction || l > 1 && typeof value === "string" && !support.checkClone && rchecked.test(value)){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0] = value.call(this, index, self.html());}self.domManip(args, callback);});}if(l){fragment = jQuery.buildFragment(args, this[0].ownerDocument, false, this);first = fragment.firstChild;if(fragment.childNodes.length === 1){fragment = first;}if(first){scripts = jQuery.map(getAll(fragment, "script"), disableScript);hasScripts = scripts.length;for(; i < l; i++) {node = fragment;if(i !== iNoClone){node = jQuery.clone(node, true, true);if(hasScripts){jQuery.merge(scripts, getAll(node, "script"));}}callback.call(this[i], node, i);}if(hasScripts){doc = scripts[scripts.length - 1].ownerDocument;jQuery.map(scripts, restoreScript);for(i = 0; i < hasScripts; i++) {node = scripts[i];if(rscriptType.test(node.type || "") && !data_priv.access(node, "globalEval") && jQuery.contains(doc, node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src);}}else {jQuery.globalEval(node.textContent.replace(rcleanScript, ""));}}}}}}return this;}});jQuery.each({appendTo:"append", prependTo:"prepend", insertBefore:"before", insertAfter:"after", replaceAll:"replaceWith"}, function(name, original){jQuery.fn[name] = function(selector){var elems, ret=[], insert=jQuery(selector), last=insert.length - 1, i=0;for(; i <= last; i++) {elems = i === last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret, elems.get());}return this.pushStack(ret);};});var iframe, elemdisplay={};function actualDisplay(name, doc){var style, elem=jQuery(doc.createElement(name)).appendTo(doc.body), display=window.getDefaultComputedStyle && (style = window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0], "display");elem.detach();return display;}function defaultDisplay(nodeName){var doc=document, display=elemdisplay[nodeName];if(!display){display = actualDisplay(nodeName, doc);if(display === "none" || !display){iframe = (iframe || jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc = iframe[0].contentDocument;doc.write();doc.close();display = actualDisplay(nodeName, doc);iframe.detach();}elemdisplay[nodeName] = display;}return display;}var rmargin=/^margin/;var rnumnonpx=new RegExp("^(" + pnum + ")(?!px)[a-z%]+$", "i");var getStyles=function getStyles(elem){if(elem.ownerDocument.defaultView.opener){return elem.ownerDocument.defaultView.getComputedStyle(elem, null);}return window.getComputedStyle(elem, null);};function curCSS(elem, name, computed){var width, minWidth, maxWidth, ret, style=elem.style;computed = computed || getStyles(elem);if(computed){ret = computed.getPropertyValue(name) || computed[name];}if(computed){if(ret === "" && !jQuery.contains(elem.ownerDocument, elem)){ret = jQuery.style(elem, name);}if(rnumnonpx.test(ret) && rmargin.test(name)){width = style.width;minWidth = style.minWidth;maxWidth = style.maxWidth;style.minWidth = style.maxWidth = style.width = ret;ret = computed.width;style.width = width;style.minWidth = minWidth;style.maxWidth = maxWidth;}}return ret !== undefined?ret + "":ret;}function addGetHookIf(conditionFn, hookFn){return {get:function get(){if(conditionFn()){delete this.get;return;}return (this.get = hookFn).apply(this, arguments);}};}(function(){var pixelPositionVal, boxSizingReliableVal, docElem=document.documentElement, container=document.createElement("div"), div=document.createElement("div");if(!div.style){return;}div.style.backgroundClip = "content-box";div.cloneNode(true).style.backgroundClip = "";support.clearCloneStyle = div.style.backgroundClip === "content-box";container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" + "position:absolute";container.appendChild(div);function computePixelPositionAndBoxSizingReliable(){div.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" + "box-sizing:border-box;display:block;margin-top:1%;top:1%;" + "border:1px;padding:1px;width:4px;position:absolute";div.innerHTML = "";docElem.appendChild(container);var divStyle=window.getComputedStyle(div, null);pixelPositionVal = divStyle.top !== "1%";boxSizingReliableVal = divStyle.width === "4px";docElem.removeChild(container);}if(window.getComputedStyle){jQuery.extend(support, {pixelPosition:function pixelPosition(){computePixelPositionAndBoxSizingReliable();return pixelPositionVal;}, boxSizingReliable:function boxSizingReliable(){if(boxSizingReliableVal == null){computePixelPositionAndBoxSizingReliable();}return boxSizingReliableVal;}, reliableMarginRight:function reliableMarginRight(){var ret, marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText = div.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" + "box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight = marginDiv.style.width = "0";div.style.width = "1px";docElem.appendChild(container);ret = !parseFloat(window.getComputedStyle(marginDiv, null).marginRight);docElem.removeChild(container);div.removeChild(marginDiv);return ret;}});}})();jQuery.swap = function(elem, options, callback, args){var ret, name, old={};for(name in options) {old[name] = elem.style[name];elem.style[name] = options[name];}ret = callback.apply(elem, args || []);for(name in options) {elem.style[name] = old[name];}return ret;};var rdisplayswap=/^(none|table(?!-c[ea]).+)/, rnumsplit=new RegExp("^(" + pnum + ")(.*)$", "i"), rrelNum=new RegExp("^([+-])=(" + pnum + ")", "i"), cssShow={position:"absolute", visibility:"hidden", display:"block"}, cssNormalTransform={letterSpacing:"0", fontWeight:"400"}, cssPrefixes=["Webkit", "O", "Moz", "ms"];function vendorPropName(style, name){if(name in style){return name;}var capName=name[0].toUpperCase() + name.slice(1), origName=name, i=cssPrefixes.length;while(i--) {name = cssPrefixes[i] + capName;if(name in style){return name;}}return origName;}function setPositiveNumber(elem, value, subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0, matches[1] - (subtract || 0)) + (matches[2] || "px"):value;}function augmentWidthOrHeight(elem, name, extra, isBorderBox, styles){var i=extra === (isBorderBox?"border":"content")?4:name === "width"?1:0, val=0;for(; i < 4; i += 2) {if(extra === "margin"){val += jQuery.css(elem, extra + cssExpand[i], true, styles);}if(isBorderBox){if(extra === "content"){val -= jQuery.css(elem, "padding" + cssExpand[i], true, styles);}if(extra !== "margin"){val -= jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles);}}else {val += jQuery.css(elem, "padding" + cssExpand[i], true, styles);if(extra !== "padding"){val += jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles);}}}return val;}function getWidthOrHeight(elem, name, extra){var valueIsBorderBox=true, val=name === "width"?elem.offsetWidth:elem.offsetHeight, styles=getStyles(elem), isBorderBox=jQuery.css(elem, "boxSizing", false, styles) === "border-box";if(val <= 0 || val == null){val = curCSS(elem, name, styles);if(val < 0 || val == null){val = elem.style[name];}if(rnumnonpx.test(val)){return val;}valueIsBorderBox = isBorderBox && (support.boxSizingReliable() || val === elem.style[name]);val = parseFloat(val) || 0;}return val + augmentWidthOrHeight(elem, name, extra || (isBorderBox?"border":"content"), valueIsBorderBox, styles) + "px";}function showHide(elements, show){var display, elem, hidden, values=[], index=0, length=elements.length;for(; index < length; index++) {elem = elements[index];if(!elem.style){continue;}values[index] = data_priv.get(elem, "olddisplay");display = elem.style.display;if(show){if(!values[index] && display === "none"){elem.style.display = "";}if(elem.style.display === "" && isHidden(elem)){values[index] = data_priv.access(elem, "olddisplay", defaultDisplay(elem.nodeName));}}else {hidden = isHidden(elem);if(display !== "none" || !hidden){data_priv.set(elem, "olddisplay", hidden?display:jQuery.css(elem, "display"));}}}for(index = 0; index < length; index++) {elem = elements[index];if(!elem.style){continue;}if(!show || elem.style.display === "none" || elem.style.display === ""){elem.style.display = show?values[index] || "":"none";}}return elements;}jQuery.extend({cssHooks:{opacity:{get:function get(elem, computed){if(computed){var ret=curCSS(elem, "opacity");return ret === ""?"1":ret;}}}}, cssNumber:{columnCount:true, fillOpacity:true, flexGrow:true, flexShrink:true, fontWeight:true, lineHeight:true, opacity:true, order:true, orphans:true, widows:true, zIndex:true, zoom:true}, cssProps:{float:"cssFloat"}, style:(function(_style){var _styleWrapper=function style(_x, _x2, _x3, _x4){return _style.apply(this, arguments);};_styleWrapper.toString = function(){return _style.toString();};return _styleWrapper;})(function(elem, name, value, extra){if(!elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style){return;}var ret, type, hooks, origName=jQuery.camelCase(name), style=elem.style;name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(style, origName));hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];if(value !== undefined){type = typeof value;if(type === "string" && (ret = rrelNum.exec(value))){value = (ret[1] + 1) * ret[2] + parseFloat(jQuery.css(elem, name));type = "number";}if(value == null || value !== value){return;}if(type === "number" && !jQuery.cssNumber[origName]){value += "px";}if(!support.clearCloneStyle && value === "" && name.indexOf("background") === 0){style[name] = "inherit";}if(!hooks || !("set" in hooks) || (value = hooks.set(elem, value, extra)) !== undefined){style[name] = value;}}else {if(hooks && "get" in hooks && (ret = hooks.get(elem, false, extra)) !== undefined){return ret;}return style[name];}}), css:function css(elem, name, extra, styles){var val, num, hooks, origName=jQuery.camelCase(name);name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(elem.style, origName));hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];if(hooks && "get" in hooks){val = hooks.get(elem, true, extra);}if(val === undefined){val = curCSS(elem, name, styles);}if(val === "normal" && name in cssNormalTransform){val = cssNormalTransform[name];}if(extra === "" || extra){num = parseFloat(val);return extra === true || jQuery.isNumeric(num)?num || 0:val;}return val;}});jQuery.each(["height", "width"], function(i, name){jQuery.cssHooks[name] = {get:function get(elem, computed, extra){if(computed){return rdisplayswap.test(jQuery.css(elem, "display")) && elem.offsetWidth === 0?jQuery.swap(elem, cssShow, function(){return getWidthOrHeight(elem, name, extra);}):getWidthOrHeight(elem, name, extra);}}, set:function set(elem, value, extra){var styles=extra && getStyles(elem);return setPositiveNumber(elem, value, extra?augmentWidthOrHeight(elem, name, extra, jQuery.css(elem, "boxSizing", false, styles) === "border-box", styles):0);}};});jQuery.cssHooks.marginRight = addGetHookIf(support.reliableMarginRight, function(elem, computed){if(computed){return jQuery.swap(elem, {display:"inline-block"}, curCSS, [elem, "marginRight"]);}});jQuery.each({margin:"", padding:"", border:"Width"}, function(prefix, suffix){jQuery.cssHooks[prefix + suffix] = {expand:function expand(value){var i=0, expanded={}, parts=typeof value === "string"?value.split(" "):[value];for(; i < 4; i++) {expanded[prefix + cssExpand[i] + suffix] = parts[i] || parts[i - 2] || parts[0];}return expanded;}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix + suffix].set = setPositiveNumber;}});jQuery.fn.extend({css:function css(name, value){return access(this, function(elem, name, value){var styles, len, map={}, i=0;if(jQuery.isArray(name)){styles = getStyles(elem);len = name.length;for(; i < len; i++) {map[name[i]] = jQuery.css(elem, name[i], false, styles);}return map;}return value !== undefined?jQuery.style(elem, name, value):jQuery.css(elem, name);}, name, value, arguments.length > 1);}, show:function show(){return showHide(this, true);}, hide:function hide(){return showHide(this);}, toggle:function toggle(state){if(typeof state === "boolean"){return state?this.show():this.hide();}return this.each(function(){if(isHidden(this)){jQuery(this).show();}else {jQuery(this).hide();}});}});function Tween(elem, options, prop, end, easing){return new Tween.prototype.init(elem, options, prop, end, easing);}jQuery.Tween = Tween;Tween.prototype = {constructor:Tween, init:function init(elem, options, prop, end, easing, unit){this.elem = elem;this.prop = prop;this.easing = easing || "swing";this.options = options;this.start = this.now = this.cur();this.end = end;this.unit = unit || (jQuery.cssNumber[prop]?"":"px");}, cur:function cur(){var hooks=Tween.propHooks[this.prop];return hooks && hooks.get?hooks.get(this):Tween.propHooks._default.get(this);}, run:function run(percent){var eased, hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos = eased = jQuery.easing[this.easing](percent, this.options.duration * percent, 0, 1, this.options.duration);}else {this.pos = eased = percent;}this.now = (this.end - this.start) * eased + this.start;if(this.options.step){this.options.step.call(this.elem, this.now, this);}if(hooks && hooks.set){hooks.set(this);}else {Tween.propHooks._default.set(this);}return this;}};Tween.prototype.init.prototype = Tween.prototype;Tween.propHooks = {_default:{get:function get(tween){var result;if(tween.elem[tween.prop] != null && (!tween.elem.style || tween.elem.style[tween.prop] == null)){return tween.elem[tween.prop];}result = jQuery.css(tween.elem, tween.prop, "");return !result || result === "auto"?0:result;}, set:function set(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.style && (tween.elem.style[jQuery.cssProps[tween.prop]] != null || jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem, tween.prop, tween.now + tween.unit);}else {tween.elem[tween.prop] = tween.now;}}}};Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {set:function set(tween){if(tween.elem.nodeType && tween.elem.parentNode){tween.elem[tween.prop] = tween.now;}}};jQuery.easing = {linear:function linear(p){return p;}, swing:function swing(p){return 0.5 - Math.cos(p * Math.PI) / 2;}};jQuery.fx = Tween.prototype.init;jQuery.fx.step = {};var fxNow, timerId, rfxtypes=/^(?:toggle|show|hide)$/, rfxnum=new RegExp("^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i"), rrun=/queueHooks$/, animationPrefilters=[defaultPrefilter], tweeners={"*":[function(prop, value){var tween=this.createTween(prop, value), target=tween.cur(), parts=rfxnum.exec(value), unit=parts && parts[3] || (jQuery.cssNumber[prop]?"":"px"), start=(jQuery.cssNumber[prop] || unit !== "px" && +target) && rfxnum.exec(jQuery.css(tween.elem, prop)), scale=1, maxIterations=20;if(start && start[3] !== unit){unit = unit || start[3];parts = parts || [];start = +target || 1;do{scale = scale || ".5";start = start / scale;jQuery.style(tween.elem, prop, start + unit);}while(scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations);}if(parts){start = tween.start = +start || +target || 0;tween.unit = unit;tween.end = parts[1]?start + (parts[1] + 1) * parts[2]:+parts[2];}return tween;}]};function createFxNow(){setTimeout(function(){fxNow = undefined;});return fxNow = jQuery.now();}function genFx(type, includeWidth){var which, i=0, attrs={height:type};includeWidth = includeWidth?1:0;for(; i < 4; i += 2 - includeWidth) {which = cssExpand[i];attrs["margin" + which] = attrs["padding" + which] = type;}if(includeWidth){attrs.opacity = attrs.width = type;}return attrs;}function createTween(value, prop, animation){var tween, collection=(tweeners[prop] || []).concat(tweeners["*"]), index=0, length=collection.length;for(; index < length; index++) {if(tween = collection[index].call(animation, prop, value)){return tween;}}}function defaultPrefilter(elem, props, opts){var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay, anim=this, orig={}, style=elem.style, hidden=elem.nodeType && isHidden(elem), dataShow=data_priv.get(elem, "fxshow");if(!opts.queue){hooks = jQuery._queueHooks(elem, "fx");if(hooks.unqueued == null){hooks.unqueued = 0;oldfire = hooks.empty.fire;hooks.empty.fire = function(){if(!hooks.unqueued){oldfire();}};}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem, "fx").length){hooks.empty.fire();}});});}if(elem.nodeType === 1 && ("height" in props || "width" in props)){opts.overflow = [style.overflow, style.overflowX, style.overflowY];display = jQuery.css(elem, "display");checkDisplay = display === "none"?data_priv.get(elem, "olddisplay") || defaultDisplay(elem.nodeName):display;if(checkDisplay === "inline" && jQuery.css(elem, "float") === "none"){style.display = "inline-block";}}if(opts.overflow){style.overflow = "hidden";anim.always(function(){style.overflow = opts.overflow[0];style.overflowX = opts.overflow[1];style.overflowY = opts.overflow[2];});}for(prop in props) {value = props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle = toggle || value === "toggle";if(value === (hidden?"hide":"show")){if(value === "show" && dataShow && dataShow[prop] !== undefined){hidden = true;}else {continue;}}orig[prop] = dataShow && dataShow[prop] || jQuery.style(elem, prop);}else {display = undefined;}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden = dataShow.hidden;}}else {dataShow = data_priv.access(elem, "fxshow", {});}if(toggle){dataShow.hidden = !hidden;}if(hidden){jQuery(elem).show();}else {anim.done(function(){jQuery(elem).hide();});}anim.done(function(){var prop;data_priv.remove(elem, "fxshow");for(prop in orig) {jQuery.style(elem, prop, orig[prop]);}});for(prop in orig) {tween = createTween(hidden?dataShow[prop]:0, prop, anim);if(!(prop in dataShow)){dataShow[prop] = tween.start;if(hidden){tween.end = tween.start;tween.start = prop === "width" || prop === "height"?1:0;}}}}else if((display === "none"?defaultDisplay(elem.nodeName):display) === "inline"){style.display = display;}}function propFilter(props, specialEasing){var index, name, easing, value, hooks;for(index in props) {name = jQuery.camelCase(index);easing = specialEasing[name];value = props[index];if(jQuery.isArray(value)){easing = value[1];value = props[index] = value[0];}if(index !== name){props[name] = value;delete props[index];}hooks = jQuery.cssHooks[name];if(hooks && "expand" in hooks){value = hooks.expand(value);delete props[name];for(index in value) {if(!(index in props)){props[index] = value[index];specialEasing[index] = easing;}}}else {specialEasing[name] = easing;}}}function Animation(elem, properties, options){var result, stopped, index=0, length=animationPrefilters.length, deferred=jQuery.Deferred().always(function(){delete tick.elem;}), tick=function tick(){if(stopped){return false;}var currentTime=fxNow || createFxNow(), remaining=Math.max(0, animation.startTime + animation.duration - currentTime), temp=remaining / animation.duration || 0, percent=1 - temp, index=0, length=animation.tweens.length;for(; index < length; index++) {animation.tweens[index].run(percent);}deferred.notifyWith(elem, [animation, percent, remaining]);if(percent < 1 && length){return remaining;}else {deferred.resolveWith(elem, [animation]);return false;}}, animation=deferred.promise({elem:elem, props:jQuery.extend({}, properties), opts:jQuery.extend(true, {specialEasing:{}}, options), originalProperties:properties, originalOptions:options, startTime:fxNow || createFxNow(), duration:options.duration, tweens:[], createTween:function createTween(prop, end){var tween=jQuery.Tween(elem, animation.opts, prop, end, animation.opts.specialEasing[prop] || animation.opts.easing);animation.tweens.push(tween);return tween;}, stop:function stop(gotoEnd){var index=0, length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}stopped = true;for(; index < length; index++) {animation.tweens[index].run(1);}if(gotoEnd){deferred.resolveWith(elem, [animation, gotoEnd]);}else {deferred.rejectWith(elem, [animation, gotoEnd]);}return this;}}), props=animation.props;propFilter(props, animation.opts.specialEasing);for(; index < length; index++) {result = animationPrefilters[index].call(animation, elem, props, animation.opts);if(result){return result;}}jQuery.map(props, createTween, animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem, animation);}jQuery.fx.timer(jQuery.extend(tick, {elem:elem, anim:animation, queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done, animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);}jQuery.Animation = jQuery.extend(Animation, {tweener:function tweener(props, callback){if(jQuery.isFunction(props)){callback = props;props = ["*"];}else {props = props.split(" ");}var prop, index=0, length=props.length;for(; index < length; index++) {prop = props[index];tweeners[prop] = tweeners[prop] || [];tweeners[prop].unshift(callback);}}, prefilter:function prefilter(callback, prepend){if(prepend){animationPrefilters.unshift(callback);}else {animationPrefilters.push(callback);}}});jQuery.speed = function(speed, easing, fn){var opt=speed && typeof speed === "object"?jQuery.extend({}, speed):{complete:fn || !fn && easing || jQuery.isFunction(speed) && speed, duration:speed, easing:fn && easing || easing && !jQuery.isFunction(easing) && easing};opt.duration = jQuery.fx.off?0:typeof opt.duration === "number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue == null || opt.queue === true){opt.queue = "fx";}opt.old = opt.complete;opt.complete = function(){if(jQuery.isFunction(opt.old)){opt.old.call(this);}if(opt.queue){jQuery.dequeue(this, opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function fadeTo(speed, to, easing, callback){return this.filter(isHidden).css("opacity", 0).show().end().animate({opacity:to}, speed, easing, callback);}, animate:function animate(prop, speed, easing, callback){var empty=jQuery.isEmptyObject(prop), optall=jQuery.speed(speed, easing, callback), doAnimation=function doAnimation(){var anim=Animation(this, jQuery.extend({}, prop), optall);if(empty || data_priv.get(this, "finish")){anim.stop(true);}};doAnimation.finish = doAnimation;return empty || optall.queue === false?this.each(doAnimation):this.queue(optall.queue, doAnimation);}, stop:function stop(type, clearQueue, gotoEnd){var stopQueue=function stopQueue(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type !== "string"){gotoEnd = clearQueue;clearQueue = type;type = undefined;}if(clearQueue && type !== false){this.queue(type || "fx", []);}return this.each(function(){var dequeue=true, index=type != null && type + "queueHooks", timers=jQuery.timers, data=data_priv.get(this);if(index){if(data[index] && data[index].stop){stopQueue(data[index]);}}else {for(index in data) {if(data[index] && data[index].stop && rrun.test(index)){stopQueue(data[index]);}}}for(index = timers.length; index--;) {if(timers[index].elem === this && (type == null || timers[index].queue === type)){timers[index].anim.stop(gotoEnd);dequeue = false;timers.splice(index, 1);}}if(dequeue || !gotoEnd){jQuery.dequeue(this, type);}});}, finish:function finish(type){if(type !== false){type = type || "fx";}return this.each(function(){var index, data=data_priv.get(this), queue=data[type + "queue"], hooks=data[type + "queueHooks"], timers=jQuery.timers, length=queue?queue.length:0;data.finish = true;jQuery.queue(this, type, []);if(hooks && hooks.stop){hooks.stop.call(this, true);}for(index = timers.length; index--;) {if(timers[index].elem === this && timers[index].queue === type){timers[index].anim.stop(true);timers.splice(index, 1);}}for(index = 0; index < length; index++) {if(queue[index] && queue[index].finish){queue[index].finish.call(this);}}delete data.finish;});}});jQuery.each(["toggle", "show", "hide"], function(i, name){var cssFn=jQuery.fn[name];jQuery.fn[name] = function(speed, easing, callback){return speed == null || typeof speed === "boolean"?cssFn.apply(this, arguments):this.animate(genFx(name, true), speed, easing, callback);};});jQuery.each({slideDown:genFx("show"), slideUp:genFx("hide"), slideToggle:genFx("toggle"), fadeIn:{opacity:"show"}, fadeOut:{opacity:"hide"}, fadeToggle:{opacity:"toggle"}}, function(name, props){jQuery.fn[name] = function(speed, easing, callback){return this.animate(props, speed, easing, callback);};});jQuery.timers = [];jQuery.fx.tick = function(){var timer, i=0, timers=jQuery.timers;fxNow = jQuery.now();for(; i < timers.length; i++) {timer = timers[i];if(!timer() && timers[i] === timer){timers.splice(i--, 1);}}if(!timers.length){jQuery.fx.stop();}fxNow = undefined;};jQuery.fx.timer = function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start();}else {jQuery.timers.pop();}};jQuery.fx.interval = 13;jQuery.fx.start = function(){if(!timerId){timerId = setInterval(jQuery.fx.tick, jQuery.fx.interval);}};jQuery.fx.stop = function(){clearInterval(timerId);timerId = null;};jQuery.fx.speeds = {slow:600, fast:200, _default:400};jQuery.fn.delay = function(time, type){time = jQuery.fx?jQuery.fx.speeds[time] || time:time;type = type || "fx";return this.queue(type, function(next, hooks){var timeout=setTimeout(next, time);hooks.stop = function(){clearTimeout(timeout);};});};(function(){var input=document.createElement("input"), select=document.createElement("select"), opt=select.appendChild(document.createElement("option"));input.type = "checkbox";support.checkOn = input.value !== "";support.optSelected = opt.selected;select.disabled = true;support.optDisabled = !opt.disabled;input = document.createElement("input");input.value = "t";input.type = "radio";support.radioValue = input.value === "t";})();var nodeHook, boolHook, attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function attr(name, value){return access(this, jQuery.attr, name, value, arguments.length > 1);}, removeAttr:function removeAttr(name){return this.each(function(){jQuery.removeAttr(this, name);});}});jQuery.extend({attr:function attr(elem, name, value){var hooks, ret, nType=elem.nodeType;if(!elem || nType === 3 || nType === 8 || nType === 2){return;}if(typeof elem.getAttribute === strundefined){return jQuery.prop(elem, name, value);}if(nType !== 1 || !jQuery.isXMLDoc(elem)){name = name.toLowerCase();hooks = jQuery.attrHooks[name] || (jQuery.expr.match.bool.test(name)?boolHook:nodeHook);}if(value !== undefined){if(value === null){jQuery.removeAttr(elem, name);}else if(hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined){return ret;}else {elem.setAttribute(name, value + "");return value;}}else if(hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null){return ret;}else {ret = jQuery.find.attr(elem, name);return ret == null?undefined:ret;}}, removeAttr:function removeAttr(elem, value){var name, propName, i=0, attrNames=value && value.match(rnotwhite);if(attrNames && elem.nodeType === 1){while(name = attrNames[i++]) {propName = jQuery.propFix[name] || name;if(jQuery.expr.match.bool.test(name)){elem[propName] = false;}elem.removeAttribute(name);}}}, attrHooks:{type:{set:function set(elem, value){if(!support.radioValue && value === "radio" && jQuery.nodeName(elem, "input")){var val=elem.value;elem.setAttribute("type", value);if(val){elem.value = val;}return value;}}}}});boolHook = {set:function set(elem, value, name){if(value === false){jQuery.removeAttr(elem, name);}else {elem.setAttribute(name, name);}return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g), function(i, name){var getter=attrHandle[name] || jQuery.find.attr;attrHandle[name] = function(elem, name, isXML){var ret, handle;if(!isXML){handle = attrHandle[name];attrHandle[name] = ret;ret = getter(elem, name, isXML) != null?name.toLowerCase():null;attrHandle[name] = handle;}return ret;};});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function prop(name, value){return access(this, jQuery.prop, name, value, arguments.length > 1);}, removeProp:function removeProp(name){return this.each(function(){delete this[jQuery.propFix[name] || name];});}});jQuery.extend({propFix:{"for":"htmlFor", "class":"className"}, prop:function prop(elem, name, value){var ret, hooks, notxml, nType=elem.nodeType;if(!elem || nType === 3 || nType === 8 || nType === 2){return;}notxml = nType !== 1 || !jQuery.isXMLDoc(elem);if(notxml){name = jQuery.propFix[name] || name;hooks = jQuery.propHooks[name];}if(value !== undefined){return hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined?ret:elem[name] = value;}else {return hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null?ret:elem[name];}}, propHooks:{tabIndex:{get:function get(elem){return elem.hasAttribute("tabindex") || rfocusable.test(elem.nodeName) || elem.href?elem.tabIndex:-1;}}}});if(!support.optSelected){jQuery.propHooks.selected = {get:function get(elem){var parent=elem.parentNode;if(parent && parent.parentNode){parent.parentNode.selectedIndex;}return null;}};}jQuery.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function(){jQuery.propFix[this.toLowerCase()] = this;});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function addClass(value){var classes, elem, cur, clazz, j, finalValue, proceed=typeof value === "string" && value, i=0, len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this, j, this.className));});}if(proceed){classes = (value || "").match(rnotwhite) || [];for(; i < len; i++) {elem = this[i];cur = elem.nodeType === 1 && (elem.className?(" " + elem.className + " ").replace(rclass, " "):" ");if(cur){j = 0;while(clazz = classes[j++]) {if(cur.indexOf(" " + clazz + " ") < 0){cur += clazz + " ";}}finalValue = jQuery.trim(cur);if(elem.className !== finalValue){elem.className = finalValue;}}}}return this;}, removeClass:function removeClass(value){var classes, elem, cur, clazz, j, finalValue, proceed=arguments.length === 0 || typeof value === "string" && value, i=0, len=this.length;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this, j, this.className));});}if(proceed){classes = (value || "").match(rnotwhite) || [];for(; i < len; i++) {elem = this[i];cur = elem.nodeType === 1 && (elem.className?(" " + elem.className + " ").replace(rclass, " "):"");if(cur){j = 0;while(clazz = classes[j++]) {while(cur.indexOf(" " + clazz + " ") >= 0) {cur = cur.replace(" " + clazz + " ", " ");}}finalValue = value?jQuery.trim(cur):"";if(elem.className !== finalValue){elem.className = finalValue;}}}}return this;}, toggleClass:function toggleClass(value, stateVal){var type=typeof value;if(typeof stateVal === "boolean" && type === "string"){return stateVal?this.addClass(value):this.removeClass(value);}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this, i, this.className, stateVal), stateVal);});}return this.each(function(){if(type === "string"){var className, i=0, self=jQuery(this), classNames=value.match(rnotwhite) || [];while(className = classNames[i++]) {if(self.hasClass(className)){self.removeClass(className);}else {self.addClass(className);}}}else if(type === strundefined || type === "boolean"){if(this.className){data_priv.set(this, "__className__", this.className);}this.className = this.className || value === false?"":data_priv.get(this, "__className__") || "";}});}, hasClass:function hasClass(selector){var className=" " + selector + " ", i=0, l=this.length;for(; i < l; i++) {if(this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf(className) >= 0){return true;}}return false;}});var rreturn=/\r/g;jQuery.fn.extend({val:function val(value){var hooks, ret, isFunction, elem=this[0];if(!arguments.length){if(elem){hooks = jQuery.valHooks[elem.type] || jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks && "get" in hooks && (ret = hooks.get(elem, "value")) !== undefined){return ret;}ret = elem.value;return typeof ret === "string"?ret.replace(rreturn, ""):ret == null?"":ret;}return;}isFunction = jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType !== 1){return;}if(isFunction){val = value.call(this, i, jQuery(this).val());}else {val = value;}if(val == null){val = "";}else if(typeof val === "number"){val += "";}else if(jQuery.isArray(val)){val = jQuery.map(val, function(value){return value == null?"":value + "";});}hooks = jQuery.valHooks[this.type] || jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks || !("set" in hooks) || hooks.set(this, val, "value") === undefined){this.value = val;}});}});jQuery.extend({valHooks:{option:{get:function get(elem){var val=jQuery.find.attr(elem, "value");return val != null?val:jQuery.trim(jQuery.text(elem));}}, select:{get:function get(elem){var value, option, options=elem.options, index=elem.selectedIndex, one=elem.type === "select-one" || index < 0, values=one?null:[], max=one?index + 1:options.length, i=index < 0?max:one?index:0;for(; i < max; i++) {option = options[i];if((option.selected || i === index) && (support.optDisabled?!option.disabled:option.getAttribute("disabled") === null) && (!option.parentNode.disabled || !jQuery.nodeName(option.parentNode, "optgroup"))){value = jQuery(option).val();if(one){return value;}values.push(value);}}return values;}, set:function set(elem, value){var optionSet, option, options=elem.options, values=jQuery.makeArray(value), i=options.length;while(i--) {option = options[i];if(option.selected = jQuery.inArray(option.value, values) >= 0){optionSet = true;}}if(!optionSet){elem.selectedIndex = -1;}return values;}}}});jQuery.each(["radio", "checkbox"], function(){jQuery.valHooks[this] = {set:function set(elem, value){if(jQuery.isArray(value)){return elem.checked = jQuery.inArray(jQuery(elem).val(), value) >= 0;}}};if(!support.checkOn){jQuery.valHooks[this].get = function(elem){return elem.getAttribute("value") === null?"on":elem.value;};}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick " + "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " + "change select submit keydown keypress keyup error contextmenu").split(" "), function(i, name){jQuery.fn[name] = function(data, fn){return arguments.length > 0?this.on(name, null, data, fn):this.trigger(name);};});jQuery.fn.extend({hover:function hover(fnOver, fnOut){return this.mouseenter(fnOver).mouseleave(fnOut || fnOver);}, bind:function bind(types, data, fn){return this.on(types, null, data, fn);}, unbind:function unbind(types, fn){return this.off(types, null, fn);}, delegate:function delegate(selector, types, data, fn){return this.on(types, selector, data, fn);}, undelegate:function undelegate(selector, types, fn){return arguments.length === 1?this.off(selector, "**"):this.off(types, selector || "**", fn);}});var nonce=jQuery.now();var rquery=/\?/;jQuery.parseJSON = function(data){return JSON.parse(data + "");};jQuery.parseXML = function(data){var xml, tmp;if(!data || typeof data !== "string"){return null;}try{tmp = new DOMParser();xml = tmp.parseFromString(data, "text/xml");}catch(e) {xml = undefined;}if(!xml || xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: " + data);}return xml;};var rhash=/#.*$/, rts=/([?&])_=[^&]*/, rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg, rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/, rnoContent=/^(?:GET|HEAD)$/, rprotocol=/^\/\//, rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/, prefilters={}, transports={}, allTypes="*/".concat("*"), ajaxLocation=window.location.href, ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase()) || [];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression, func){if(typeof dataTypeExpression !== "string"){func = dataTypeExpression;dataTypeExpression = "*";}var dataType, i=0, dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite) || [];if(jQuery.isFunction(func)){while(dataType = dataTypes[i++]) {if(dataType[0] === "+"){dataType = dataType.slice(1) || "*";(structure[dataType] = structure[dataType] || []).unshift(func);}else {(structure[dataType] = structure[dataType] || []).push(func);}}}};}function inspectPrefiltersOrTransports(structure, options, originalOptions, jqXHR){var inspected={}, seekingTransport=structure === transports;function inspect(dataType){var selected;inspected[dataType] = true;jQuery.each(structure[dataType] || [], function(_, prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options, originalOptions, jqXHR);if(typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return !(selected = dataTypeOrTransport);}});return selected;}return inspect(options.dataTypes[0]) || !inspected["*"] && inspect("*");}function ajaxExtend(target, src){var key, deep, flatOptions=jQuery.ajaxSettings.flatOptions || {};for(key in src) {if(src[key] !== undefined){(flatOptions[key]?target:deep || (deep = {}))[key] = src[key];}}if(deep){jQuery.extend(true, target, deep);}return target;}function ajaxHandleResponses(s, jqXHR, responses){var ct, type, finalDataType, firstDataType, contents=s.contents, dataTypes=s.dataTypes;while(dataTypes[0] === "*") {dataTypes.shift();if(ct === undefined){ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");}}if(ct){for(type in contents) {if(contents[type] && contents[type].test(ct)){dataTypes.unshift(type);break;}}}if(dataTypes[0] in responses){finalDataType = dataTypes[0];}else {for(type in responses) {if(!dataTypes[0] || s.converters[type + " " + dataTypes[0]]){finalDataType = type;break;}if(!firstDataType){firstDataType = type;}}finalDataType = finalDataType || firstDataType;}if(finalDataType){if(finalDataType !== dataTypes[0]){dataTypes.unshift(finalDataType);}return responses[finalDataType];}}function ajaxConvert(s, response, jqXHR, isSuccess){var conv2, current, conv, tmp, prev, converters={}, dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters) {converters[conv.toLowerCase()] = s.converters[conv];}}current = dataTypes.shift();while(current) {if(s.responseFields[current]){jqXHR[s.responseFields[current]] = response;}if(!prev && isSuccess && s.dataFilter){response = s.dataFilter(response, s.dataType);}prev = current;current = dataTypes.shift();if(current){if(current === "*"){current = prev;}else if(prev !== "*" && prev !== current){conv = converters[prev + " " + current] || converters["* " + current];if(!conv){for(conv2 in converters) {tmp = conv2.split(" ");if(tmp[1] === current){conv = converters[prev + " " + tmp[0]] || converters["* " + tmp[0]];if(conv){if(conv === true){conv = converters[conv2];}else if(converters[conv2] !== true){current = tmp[0];dataTypes.unshift(tmp[1]);}break;}}}}if(conv !== true){if(conv && s.throws){response = conv(response);}else {try{response = conv(response);}catch(e) {return {state:"parsererror", error:conv?e:"No conversion from " + prev + " to " + current};}}}}}}return {state:"success", data:response};}jQuery.extend({active:0, lastModified:{}, etag:{}, ajaxSettings:{url:ajaxLocation, type:"GET", isLocal:rlocalProtocol.test(ajaxLocParts[1]), global:true, processData:true, async:true, contentType:"application/x-www-form-urlencoded; charset=UTF-8", accepts:{"*":allTypes, text:"text/plain", html:"text/html", xml:"application/xml, text/xml", json:"application/json, text/javascript"}, contents:{xml:/xml/, html:/html/, json:/json/}, responseFields:{xml:"responseXML", text:"responseText", json:"responseJSON"}, converters:{"* text":String, "text html":true, "text json":jQuery.parseJSON, "text xml":jQuery.parseXML}, flatOptions:{url:true, context:true}}, ajaxSetup:function ajaxSetup(target, settings){return settings?ajaxExtend(ajaxExtend(target, jQuery.ajaxSettings), settings):ajaxExtend(jQuery.ajaxSettings, target);}, ajaxPrefilter:addToPrefiltersOrTransports(prefilters), ajaxTransport:addToPrefiltersOrTransports(transports), ajax:function ajax(url, options){if(typeof url === "object"){options = url;url = undefined;}options = options || {};var transport, cacheURL, responseHeadersString, responseHeaders, timeoutTimer, parts, fireGlobals, i, s=jQuery.ajaxSetup({}, options), callbackContext=s.context || s, globalEventContext=s.context && (callbackContext.nodeType || callbackContext.jquery)?jQuery(callbackContext):jQuery.event, deferred=jQuery.Deferred(), completeDeferred=jQuery.Callbacks("once memory"), statusCode=s.statusCode || {}, requestHeaders={}, requestHeadersNames={}, state=0, strAbort="canceled", jqXHR={readyState:0, getResponseHeader:function getResponseHeader(key){var match;if(state === 2){if(!responseHeaders){responseHeaders = {};while(match = rheaders.exec(responseHeadersString)) {responseHeaders[match[1].toLowerCase()] = match[2];}}match = responseHeaders[key.toLowerCase()];}return match == null?null:match;}, getAllResponseHeaders:function getAllResponseHeaders(){return state === 2?responseHeadersString:null;}, setRequestHeader:function setRequestHeader(name, value){var lname=name.toLowerCase();if(!state){name = requestHeadersNames[lname] = requestHeadersNames[lname] || name;requestHeaders[name] = value;}return this;}, overrideMimeType:function overrideMimeType(type){if(!state){s.mimeType = type;}return this;}, statusCode:(function(_statusCode){var _statusCodeWrapper=function statusCode(_x){return _statusCode.apply(this, arguments);};_statusCodeWrapper.toString = function(){return _statusCode.toString();};return _statusCodeWrapper;})(function(map){var code;if(map){if(state < 2){for(code in map) {statusCode[code] = [statusCode[code], map[code]];}}else {jqXHR.always(map[jqXHR.status]);}}return this;}), abort:function abort(statusText){var finalText=statusText || strAbort;if(transport){transport.abort(finalText);}done(0, finalText);return this;}};deferred.promise(jqXHR).complete = completeDeferred.add;jqXHR.success = jqXHR.done;jqXHR.error = jqXHR.fail;s.url = ((url || s.url || ajaxLocation) + "").replace(rhash, "").replace(rprotocol, ajaxLocParts[1] + "//");s.type = options.method || options.type || s.method || s.type;s.dataTypes = jQuery.trim(s.dataType || "*").toLowerCase().match(rnotwhite) || [""];if(s.crossDomain == null){parts = rurl.exec(s.url.toLowerCase());s.crossDomain = !!(parts && (parts[1] !== ajaxLocParts[1] || parts[2] !== ajaxLocParts[2] || (parts[3] || (parts[1] === "http:"?"80":"443")) !== (ajaxLocParts[3] || (ajaxLocParts[1] === "http:"?"80":"443"))));}if(s.data && s.processData && typeof s.data !== "string"){s.data = jQuery.param(s.data, s.traditional);}inspectPrefiltersOrTransports(prefilters, s, options, jqXHR);if(state === 2){return jqXHR;}fireGlobals = jQuery.event && s.global;if(fireGlobals && jQuery.active++ === 0){jQuery.event.trigger("ajaxStart");}s.type = s.type.toUpperCase();s.hasContent = !rnoContent.test(s.type);cacheURL = s.url;if(!s.hasContent){if(s.data){cacheURL = s.url += (rquery.test(cacheURL)?"&":"?") + s.data;delete s.data;}if(s.cache === false){s.url = rts.test(cacheURL)?cacheURL.replace(rts, "$1_=" + nonce++):cacheURL + (rquery.test(cacheURL)?"&":"?") + "_=" + nonce++;}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since", jQuery.lastModified[cacheURL]);}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match", jQuery.etag[cacheURL]);}}if(s.data && s.hasContent && s.contentType !== false || options.contentType){jqXHR.setRequestHeader("Content-Type", s.contentType);}jqXHR.setRequestHeader("Accept", s.dataTypes[0] && s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]] + (s.dataTypes[0] !== "*"?", " + allTypes + "; q=0.01":""):s.accepts["*"]);for(i in s.headers) {jqXHR.setRequestHeader(i, s.headers[i]);}if(s.beforeSend && (s.beforeSend.call(callbackContext, jqXHR, s) === false || state === 2)){return jqXHR.abort();}strAbort = "abort";for(i in {success:1, error:1, complete:1}) {jqXHR[i](s[i]);}transport = inspectPrefiltersOrTransports(transports, s, options, jqXHR);if(!transport){done(-1, "No Transport");}else {jqXHR.readyState = 1;if(fireGlobals){globalEventContext.trigger("ajaxSend", [jqXHR, s]);}if(s.async && s.timeout > 0){timeoutTimer = setTimeout(function(){jqXHR.abort("timeout");}, s.timeout);}try{state = 1;transport.send(requestHeaders, done);}catch(e) {if(state < 2){done(-1, e);}else {throw e;}}}function done(status, nativeStatusText, responses, headers){var isSuccess, success, error, response, modified, statusText=nativeStatusText;if(state === 2){return;}state = 2;if(timeoutTimer){clearTimeout(timeoutTimer);}transport = undefined;responseHeadersString = headers || "";jqXHR.readyState = status > 0?4:0;isSuccess = status >= 200 && status < 300 || status === 304;if(responses){response = ajaxHandleResponses(s, jqXHR, responses);}response = ajaxConvert(s, response, jqXHR, isSuccess);if(isSuccess){if(s.ifModified){modified = jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL] = modified;}modified = jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL] = modified;}}if(status === 204 || s.type === "HEAD"){statusText = "nocontent";}else if(status === 304){statusText = "notmodified";}else {statusText = response.state;success = response.data;error = response.error;isSuccess = !error;}}else {error = statusText;if(status || !statusText){statusText = "error";if(status < 0){status = 0;}}}jqXHR.status = status;jqXHR.statusText = (nativeStatusText || statusText) + "";if(isSuccess){deferred.resolveWith(callbackContext, [success, statusText, jqXHR]);}else {deferred.rejectWith(callbackContext, [jqXHR, statusText, error]);}jqXHR.statusCode(statusCode);statusCode = undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError", [jqXHR, s, isSuccess?success:error]);}completeDeferred.fireWith(callbackContext, [jqXHR, statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete", [jqXHR, s]);if(! --jQuery.active){jQuery.event.trigger("ajaxStop");}}}return jqXHR;}, getJSON:function getJSON(url, data, callback){return jQuery.get(url, data, callback, "json");}, getScript:function getScript(url, callback){return jQuery.get(url, undefined, callback, "script");}});jQuery.each(["get", "post"], function(i, method){jQuery[method] = function(url, data, callback, type){if(jQuery.isFunction(data)){type = type || callback;callback = data;data = undefined;}return jQuery.ajax({url:url, type:method, dataType:type, data:data, success:callback});};});jQuery._evalUrl = function(url){return jQuery.ajax({url:url, type:"GET", dataType:"script", async:false, global:false, throws:true});};jQuery.fn.extend({wrapAll:function wrapAll(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this, i));});}if(this[0]){wrap = jQuery(html, this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}wrap.map(function(){var elem=this;while(elem.firstElementChild) {elem = elem.firstElementChild;}return elem;}).append(this);}return this;}, wrapInner:function wrapInner(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this, i));});}return this.each(function(){var self=jQuery(this), contents=self.contents();if(contents.length){contents.wrapAll(html);}else {self.append(html);}});}, wrap:function wrap(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this, i):html);});}, unwrap:function unwrap(){return this.parent().each(function(){if(!jQuery.nodeName(this, "body")){jQuery(this).replaceWith(this.childNodes);}}).end();}});jQuery.expr.filters.hidden = function(elem){return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;};jQuery.expr.filters.visible = function(elem){return !jQuery.expr.filters.hidden(elem);};var r20=/%20/g, rbracket=/\[\]$/, rCRLF=/\r?\n/g, rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i, rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix, obj, traditional, add){var name;if(jQuery.isArray(obj)){jQuery.each(obj, function(i, v){if(traditional || rbracket.test(prefix)){add(prefix, v);}else {buildParams(prefix + "[" + (typeof v === "object"?i:"") + "]", v, traditional, add);}});}else if(!traditional && jQuery.type(obj) === "object"){for(name in obj) {buildParams(prefix + "[" + name + "]", obj[name], traditional, add);}}else {add(prefix, obj);}}jQuery.param = function(a, traditional){var prefix, s=[], add=function add(key, value){value = jQuery.isFunction(value)?value():value == null?"":value;s[s.length] = encodeURIComponent(key) + "=" + encodeURIComponent(value);};if(traditional === undefined){traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;}if(jQuery.isArray(a) || a.jquery && !jQuery.isPlainObject(a)){jQuery.each(a, function(){add(this.name, this.value);});}else {for(prefix in a) {buildParams(prefix, a[prefix], traditional, add);}}return s.join("&").replace(r20, "+");};jQuery.fn.extend({serialize:function serialize(){return jQuery.param(this.serializeArray());}, serializeArray:function serializeArray(){return this.map(function(){var elements=jQuery.prop(this, "elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name && !jQuery(this).is(":disabled") && rsubmittable.test(this.nodeName) && !rsubmitterTypes.test(type) && (this.checked || !rcheckableType.test(type));}).map(function(i, elem){var val=jQuery(this).val();return val == null?null:jQuery.isArray(val)?jQuery.map(val, function(val){return {name:elem.name, value:val.replace(rCRLF, "\r\n")};}):{name:elem.name, value:val.replace(rCRLF, "\r\n")};}).get();}});jQuery.ajaxSettings.xhr = function(){try{return new XMLHttpRequest();}catch(e) {}};var xhrId=0, xhrCallbacks={}, xhrSuccessStatus={0:200, 1223:204}, xhrSupported=jQuery.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload", function(){for(var key in xhrCallbacks) {xhrCallbacks[key]();}});}support.cors = !!xhrSupported && "withCredentials" in xhrSupported;support.ajax = xhrSupported = !!xhrSupported;jQuery.ajaxTransport(function(options){var callback;if(support.cors || xhrSupported && !options.crossDomain){return {send:function send(headers, complete){var i, xhr=options.xhr(), id=++xhrId;xhr.open(options.type, options.url, options.async, options.username, options.password);if(options.xhrFields){for(i in options.xhrFields) {xhr[i] = options.xhrFields[i];}}if(options.mimeType && xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}if(!options.crossDomain && !headers["X-Requested-With"]){headers["X-Requested-With"] = "XMLHttpRequest";}for(i in headers) {xhr.setRequestHeader(i, headers[i]);}callback = function(type){return function(){if(callback){delete xhrCallbacks[id];callback = xhr.onload = xhr.onerror = null;if(type === "abort"){xhr.abort();}else if(type === "error"){complete(xhr.status, xhr.statusText);}else {complete(xhrSuccessStatus[xhr.status] || xhr.status, xhr.statusText, typeof xhr.responseText === "string"?{text:xhr.responseText}:undefined, xhr.getAllResponseHeaders());}}};};xhr.onload = callback();xhr.onerror = callback("error");callback = xhrCallbacks[id] = callback("abort");try{xhr.send(options.hasContent && options.data || null);}catch(e) {if(callback){throw e;}}}, abort:function abort(){if(callback){callback();}}};}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents:{script:/(?:java|ecma)script/}, converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script", function(s){if(s.cache === undefined){s.cache = false;}if(s.crossDomain){s.type = "GET";}});jQuery.ajaxTransport("script", function(s){if(s.crossDomain){var script, callback;return {send:function send(_, complete){script = jQuery("<script>").prop({async:true, charset:s.scriptCharset, src:s.url}).on("load error", callback = function(evt){script.remove();callback = null;if(evt){complete(evt.type === "error"?404:200, evt.type);}});document.head.appendChild(script[0]);}, abort:function abort(){if(callback){callback();}}};}});var oldCallbacks=[], rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback", jsonpCallback:function jsonpCallback(){var callback=oldCallbacks.pop() || jQuery.expando + "_" + nonce++;this[callback] = true;return callback;}});jQuery.ajaxPrefilter("json jsonp", function(s, originalSettings, jqXHR){var callbackName, overwritten, responseContainer, jsonProp=s.jsonp !== false && (rjsonp.test(s.url)?"url":typeof s.data === "string" && !(s.contentType || "").indexOf("application/x-www-form-urlencoded") && rjsonp.test(s.data) && "data");if(jsonProp || s.dataTypes[0] === "jsonp"){callbackName = s.jsonpCallback = jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp] = s[jsonProp].replace(rjsonp, "$1" + callbackName);}else if(s.jsonp !== false){s.url += (rquery.test(s.url)?"&":"?") + s.jsonp + "=" + callbackName;}s.converters["script json"] = function(){if(!responseContainer){jQuery.error(callbackName + " was not called");}return responseContainer[0];};s.dataTypes[0] = "json";overwritten = window[callbackName];window[callbackName] = function(){responseContainer = arguments;};jqXHR.always(function(){window[callbackName] = overwritten;if(s[callbackName]){s.jsonpCallback = originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}if(responseContainer && jQuery.isFunction(overwritten)){overwritten(responseContainer[0]);}responseContainer = overwritten = undefined;});return "script";}});jQuery.parseHTML = function(data, context, keepScripts){if(!data || typeof data !== "string"){return null;}if(typeof context === "boolean"){keepScripts = context;context = false;}context = context || document;var parsed=rsingleTag.exec(data), scripts=!keepScripts && [];if(parsed){return [context.createElement(parsed[1])];}parsed = jQuery.buildFragment([data], context, scripts);if(scripts && scripts.length){jQuery(scripts).remove();}return jQuery.merge([], parsed.childNodes);};var _load=jQuery.fn.load;jQuery.fn.load = function(url, params, callback){if(typeof url !== "string" && _load){return _load.apply(this, arguments);}var selector, type, response, self=this, off=url.indexOf(" ");if(off >= 0){selector = jQuery.trim(url.slice(off));url = url.slice(0, off);}if(jQuery.isFunction(params)){callback = params;params = undefined;}else if(params && typeof params === "object"){type = "POST";}if(self.length > 0){jQuery.ajax({url:url, type:type, dataType:"html", data:params}).done(function(responseText){response = arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).complete(callback && function(jqXHR, status){self.each(callback, response || [jqXHR.responseText, status, jqXHR]);});}return this;};jQuery.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(i, type){jQuery.fn[type] = function(fn){return this.on(type, fn);};});jQuery.expr.filters.animated = function(elem){return jQuery.grep(jQuery.timers, function(fn){return elem === fn.elem;}).length;};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType === 9 && elem.defaultView;}jQuery.offset = {setOffset:function setOffset(elem, options, i){var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition, position=jQuery.css(elem, "position"), curElem=jQuery(elem), props={};if(position === "static"){elem.style.position = "relative";}curOffset = curElem.offset();curCSSTop = jQuery.css(elem, "top");curCSSLeft = jQuery.css(elem, "left");calculatePosition = (position === "absolute" || position === "fixed") && (curCSSTop + curCSSLeft).indexOf("auto") > -1;if(calculatePosition){curPosition = curElem.position();curTop = curPosition.top;curLeft = curPosition.left;}else {curTop = parseFloat(curCSSTop) || 0;curLeft = parseFloat(curCSSLeft) || 0;}if(jQuery.isFunction(options)){options = options.call(elem, i, curOffset);}if(options.top != null){props.top = options.top - curOffset.top + curTop;}if(options.left != null){props.left = options.left - curOffset.left + curLeft;}if("using" in options){options.using.call(elem, props);}else {curElem.css(props);}}};jQuery.fn.extend({offset:function offset(options){if(arguments.length){return options === undefined?this:this.each(function(i){jQuery.offset.setOffset(this, options, i);});}var docElem, win, elem=this[0], box={top:0, left:0}, doc=elem && elem.ownerDocument;if(!doc){return;}docElem = doc.documentElement;if(!jQuery.contains(docElem, elem)){return box;}if(typeof elem.getBoundingClientRect !== strundefined){box = elem.getBoundingClientRect();}win = getWindow(doc);return {top:box.top + win.pageYOffset - docElem.clientTop, left:box.left + win.pageXOffset - docElem.clientLeft};}, position:function position(){if(!this[0]){return;}var offsetParent, offset, elem=this[0], parentOffset={top:0, left:0};if(jQuery.css(elem, "position") === "fixed"){offset = elem.getBoundingClientRect();}else {offsetParent = this.offsetParent();offset = this.offset();if(!jQuery.nodeName(offsetParent[0], "html")){parentOffset = offsetParent.offset();}parentOffset.top += jQuery.css(offsetParent[0], "borderTopWidth", true);parentOffset.left += jQuery.css(offsetParent[0], "borderLeftWidth", true);}return {top:offset.top - parentOffset.top - jQuery.css(elem, "marginTop", true), left:offset.left - parentOffset.left - jQuery.css(elem, "marginLeft", true)};}, offsetParent:function offsetParent(){return this.map(function(){var offsetParent=this.offsetParent || docElem;while(offsetParent && (!jQuery.nodeName(offsetParent, "html") && jQuery.css(offsetParent, "position") === "static")) {offsetParent = offsetParent.offsetParent;}return offsetParent || docElem;});}});jQuery.each({scrollLeft:"pageXOffset", scrollTop:"pageYOffset"}, function(method, prop){var top="pageYOffset" === prop;jQuery.fn[method] = function(val){return access(this, function(elem, method, val){var win=getWindow(elem);if(val === undefined){return win?win[prop]:elem[method];}if(win){win.scrollTo(!top?val:window.pageXOffset, top?val:window.pageYOffset);}else {elem[method] = val;}}, method, val, arguments.length, null);};});jQuery.each(["top", "left"], function(i, prop){jQuery.cssHooks[prop] = addGetHookIf(support.pixelPosition, function(elem, computed){if(computed){computed = curCSS(elem, prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop] + "px":computed;}});});jQuery.each({Height:"height", Width:"width"}, function(name, type){jQuery.each({padding:"inner" + name, content:type, "":"outer" + name}, function(defaultExtra, funcName){jQuery.fn[funcName] = function(margin, value){var chainable=arguments.length && (defaultExtra || typeof margin !== "boolean"), extra=defaultExtra || (margin === true || value === true?"margin":"border");return access(this, function(elem, type, value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client" + name];}if(elem.nodeType === 9){doc = elem.documentElement;return Math.max(elem.body["scroll" + name], doc["scroll" + name], elem.body["offset" + name], doc["offset" + name], doc["client" + name]);}return value === undefined?jQuery.css(elem, type, extra):jQuery.style(elem, type, value, extra);}, type, chainable?margin:undefined, chainable, null);};});});jQuery.fn.size = function(){return this.length;};jQuery.fn.andSelf = jQuery.fn.addBack;if(typeof define === "function" && define.amd){define("jquery", [], function(){return jQuery;});}var _jQuery=window.jQuery, _$=window.$;jQuery.noConflict = function(deep){if(window.$ === jQuery){window.$ = _$;}if(deep && window.jQuery === jQuery){window.jQuery = _jQuery;}return jQuery;};if(typeof noGlobal === strundefined){window.jQuery = window.$ = jQuery;}return jQuery;});

},{}],3:[function(require,module,exports){
"use strict";(function(root, factory){if(typeof exports === "object"){module.exports = factory.call(root);}else if(typeof define === "function" && define.amd){define(function(){return factory.call(root);});}else {root.Physics = factory.call(root);}})(typeof window !== "undefined"?window:undefined, function(){"use strict";var window=this;var document=window.document;var Physics=function Physics(){return Physics.world.apply(Physics, arguments);};Physics.util = {};(function(){Physics.aabb = function(minX, minY, maxX, maxY){var aabb={x:0, y:0, hw:0, hh:0};if(minX === undefined){return aabb;}if(minX && minX.x !== undefined){maxX = minY.x;maxY = minY.y;minY = minX.y;minX = minX.x;}if(maxY === undefined && minX !== undefined && minY !== undefined){aabb.hw = minX * 0.5;aabb.hh = minY * 0.5;if(maxX && maxX.x !== undefined){aabb.x = maxX.x;aabb.y = maxX.y;}return aabb;}aabb.hw = Math.abs(maxX - minX) * 0.5;aabb.hh = Math.abs(maxY - minY) * 0.5;aabb.x = (maxX + minX) * 0.5;aabb.y = (maxY + minY) * 0.5;return aabb;};Physics.aabb.contains = function contains(aabb, pt){return pt.x > aabb.x - aabb.hw && pt.x < aabb.x + aabb.hw && pt.y > aabb.y - aabb.hh && pt.y < aabb.y + aabb.hh;};Physics.aabb.clone = function(aabb){return {x:aabb.x, y:aabb.y, hw:aabb.hw, hh:aabb.hh};};Physics.aabb.union = function(aabb1, aabb2, modify){var ret=modify === true?aabb1:{}, maxX=Math.max(aabb1.x + aabb1.hw, aabb2.x + aabb2.hw), maxY=Math.max(aabb1.y + aabb1.hh, aabb2.y + aabb2.hh), minX=Math.min(aabb1.x - aabb1.hw, aabb2.x - aabb2.hw), minY=Math.min(aabb1.y - aabb1.hh, aabb2.y - aabb2.hh);ret.hw = Math.abs(maxX - minX) * 0.5;ret.hh = Math.abs(maxY - minY) * 0.5;ret.x = (maxX + minX) * 0.5;ret.y = (maxY + minY) * 0.5;return ret;};Physics.aabb.overlap = function(aabb1, aabb2){var min1=aabb1.x - aabb1.hw, min2=aabb2.x - aabb2.hw, max1=aabb1.x + aabb1.hw, max2=aabb2.x + aabb2.hw;if(min2 <= max1 && max1 <= max2 || min1 <= max2 && max2 <= max1){min1 = aabb1.y - aabb1.hh;min2 = aabb2.y - aabb2.hh;max1 = aabb1.y + aabb1.hh;max2 = aabb2.y + aabb2.hh;return min2 <= max1 && max1 <= max2 || min1 <= max2 && max2 <= max1;}return false;};})();(function(){var gjkAccuracy=0.0001;var gjkMaxIterations=100;var getNextSearchDir=function getNextSearchDir(ptA, ptB, dir){var ABdotB=ptB.normSq() - ptB.dot(ptA), ABdotA=ptB.dot(ptA) - ptA.normSq();if(ABdotB < 0){return dir.clone(ptB).negate();}else if(ABdotA > 0){return dir.clone(ptA).negate();}else {dir.clone(ptB).vsub(ptA);return dir.perp(ptA.cross(dir) > 0);}};var getClosestPoints=function getClosestPoints(simplex){var len=simplex.length, last=simplex[len - 2], prev=simplex[len - 3], scratch=Physics.scratchpad(), A=scratch.vector().clone(last.pt), L=scratch.vector().clone(prev.pt).vsub(A), lambdaB, lambdaA;if(L.equals(Physics.vector.zero)){return scratch.done({a:last.a, b:last.b});}lambdaB = -L.dot(A) / L.normSq();lambdaA = 1 - lambdaB;if(lambdaA <= 0){return scratch.done({a:prev.a, b:prev.b});}else if(lambdaB <= 0){return scratch.done({a:last.a, b:last.b});}return scratch.done({a:A.clone(last.a).mult(lambdaA).vadd(L.clone(prev.a).mult(lambdaB)).values(), b:A.clone(last.b).mult(lambdaA).vadd(L.clone(prev.b).mult(lambdaB)).values()});};var gjk=function gjk(support, seed, checkOverlapOnly, debugFn){var overlap=false, noOverlap=false, distance=false, simplex=[], simplexLen=1, scratch=Physics.scratchpad(), dir=scratch.vector().clone(seed || Physics.vector.axis[0]), last=scratch.vector(), lastlast=scratch.vector(), v1=scratch.vector(), v2=scratch.vector(), ab, ac, sign, tmp, iterations=0;tmp = support(dir);simplexLen = simplex.push(tmp);last.clone(tmp.pt);dir.negate();while(++iterations) {last.swap(lastlast);tmp = support(dir);simplexLen = simplex.push(tmp);last.clone(tmp.pt);if(debugFn){debugFn(simplex);}if(last.equals(Physics.vector.zero)){overlap = true;break;}if(!noOverlap && last.dot(dir) <= 0){if(checkOverlapOnly){break;}noOverlap = true;}if(simplexLen === 2){dir = getNextSearchDir(last, lastlast, dir);}else if(noOverlap){dir.normalize();tmp = lastlast.dot(dir);if(Math.abs(tmp - last.dot(dir)) < gjkAccuracy){distance = -tmp;break;}if(lastlast.normSq() < v1.clone(simplex[0].pt).normSq()){simplex.shift();}else {simplex.splice(1, 1);}dir = getNextSearchDir(v1.clone(simplex[1].pt), v2.clone(simplex[0].pt), dir);}else {ab = ab || scratch.vector();ac = ac || scratch.vector();ab.clone(lastlast).vsub(last);ac.clone(simplex[0].pt).vsub(last);sign = ab.cross(ac) > 0;if(sign ^ last.cross(ab) > 0){simplex.shift();ab.perp(!sign);dir.swap(ab);}else if(sign ^ ac.cross(last) > 0){simplex.splice(1, 1);ac.perp(sign);dir.swap(ab);}else {overlap = true;break;}}if(iterations > gjkMaxIterations){scratch.done();return {simplex:simplex, iterations:iterations, distance:0, maxIterationsReached:true};}}scratch.done();tmp = {overlap:overlap, simplex:simplex, iterations:iterations};if(distance !== false){tmp.distance = distance;tmp.closest = getClosestPoints(simplex);}return tmp;};Physics.gjk = gjk;})();(function(){Physics.statistics = {pushRunningAvg:function pushRunningAvg(v, k, m, s){var x=v - m;m += x / k;s += x * (v - m);return [m, s];}, pushRunningVectorAvg:function pushRunningVectorAvg(v, k, m, s){var invK=1 / k, x=v.get(0) - m.get(0), y=v.get(1) - m.get(1);m.add(x * invK, y * invK);if(s){x *= v.get(0) - m.get(0);y *= v.get(1) - m.get(1);s.add(x, y);}}};})();(function(){var Transform=function Transform(vect, angle, origin){if(!(this instanceof Transform)){return new Transform(vect, angle);}this.v = new Physics.vector();this.o = new Physics.vector();if(vect instanceof Transform){this.clone(vect);return;}if(vect){this.setTranslation(vect);}this.setRotation(angle || 0, origin);};Transform.prototype.setTranslation = function(vect){this.v.clone(vect);return this;};Transform.prototype.setRotation = function(angle, origin){this.cosA = Math.cos(angle);this.sinA = Math.sin(angle);if(origin){this.o.clone(origin);}else {this.o.zero();}return this;};Transform.prototype.clone = function(t){if(t){this.setTranslation(t.v);this.cosA = t.cosA;this.sinA = t.sinA;this.o.clone(t.o);return this;}return new Transform(this);};Physics.transform = Transform;})();(function(window){var sqrt=Math.sqrt, min=Math.min, max=Math.max, acos=Math.acos, atan2=Math.atan2, TWOPI=Math.PI * 2, typedArrays=!!window.Float64Array;var Vector=function Vector(x, y){if(!(this instanceof Vector)){return new Vector(x, y);}if(typedArrays){this._ = new Float64Array(5);}else {this._ = [];}if(x && (x.x !== undefined || x._ && x._.length)){this.clone(x);}else {this.recalc = true;this.set(x, y);}};Object.defineProperties(Vector.prototype, {x:{get:function get(){return +this._[0];}, set:function set(x){x = +x || 0;this.recalc = x === this._[0];this._[0] = x;}}, y:{get:function get(){return +this._[1];}, set:function set(y){y = +y || 0;this.recalc = y === this._[1];this._[1] = y;}}});Vector.prototype.set = function(x, y){this.recalc = true;this._[0] = +x || 0;this._[1] = +y || 0;return this;};Vector.prototype.get = function(n){return this._[n];};Vector.prototype.vadd = function(v){this.recalc = true;this._[0] += v._[0];this._[1] += v._[1];return this;};Vector.prototype.vsub = function(v){this.recalc = true;this._[0] -= v._[0];this._[1] -= v._[1];return this;};Vector.prototype.add = function(x, y){this.recalc = true;this._[0] += +x || 0;this._[1] += +y || 0;return this;};Vector.prototype.sub = function(x, y){this.recalc = true;this._[0] -= x;this._[1] -= y === undefined?0:y;return this;};Vector.prototype.mult = function(m){if(!this.recalc){this._[4] *= m * m;this._[3] *= m;}this._[0] *= m;this._[1] *= m;return this;};Vector.prototype.dot = function(v){return this._[0] * v._[0] + this._[1] * v._[1];};Vector.prototype.cross = function(v){return -this._[0] * v._[1] + this._[1] * v._[0];};Vector.prototype.proj = function(v){return this.dot(v) / v.norm();};Vector.prototype.vproj = function(v){var m=this.dot(v) / v.normSq();return this.clone(v).mult(m);};Vector.prototype.angle = function(v){var ang;if(this.equals(Vector.zero)){if(v){return v.angle();}else {return NaN;}}else {if(v && !v.equals(Vector.zero)){ang = atan2(this._[1] * v._[0] - this._[0] * v._[1], this._[0] * v._[0] + this._[1] * v._[1]);}else {ang = atan2(this._[1], this._[0]);}}while(ang > Math.PI) {ang -= TWOPI;}while(ang < -Math.PI) {ang += TWOPI;}return ang;};Vector.prototype.angle2 = function(left, right){var x1=left._[0] - this._[0], y1=left._[1] - this._[1], x2=right._[0] - this._[0], y2=right._[1] - this._[1], ang=atan2(y1 * x2 - x1 * y2, x1 * x2 + y1 * y2);while(ang > Math.PI) {ang -= TWOPI;}while(ang < -Math.PI) {ang += TWOPI;}return ang;};Vector.prototype.norm = function(){if(this.recalc){this.recalc = false;this._[4] = this._[0] * this._[0] + this._[1] * this._[1];this._[3] = sqrt(this._[4]);}return this._[3];};Vector.prototype.normSq = function(){if(this.recalc){this.recalc = false;this._[4] = this._[0] * this._[0] + this._[1] * this._[1];this._[3] = sqrt(this._[4]);}return this._[4];};Vector.prototype.dist = function(v){var dx, dy;return sqrt((dx = v._[0] - this._[0]) * dx + (dy = v._[1] - this._[1]) * dy);};Vector.prototype.distSq = function(v){var dx, dy;return (dx = v._[0] - this._[0]) * dx + (dy = v._[1] - this._[1]) * dy;};Vector.prototype.perp = function(ccw){var tmp=this._[0];if(ccw){this._[0] = this._[1];this._[1] = -tmp;}else {this._[0] = -this._[1];this._[1] = tmp;}return this;};Vector.prototype.normalize = function(){var m=this.norm();if(m === 0){return this;}m = 1 / m;this._[0] *= m;this._[1] *= m;this._[3] = 1;this._[4] = 1;return this;};Vector.prototype.transform = function(t){var sinA=t.sinA, cosA=t.cosA, x=t.o._[0], y=t.o._[1];this._[0] -= x;this._[1] -= y;return this.set(this._[0] * cosA - this._[1] * sinA + x + t.v._[0], this._[0] * sinA + this._[1] * cosA + y + t.v._[1]);};Vector.prototype.transformInv = function(t){var sinA=t.sinA, cosA=t.cosA, x=t.o._[0], y=t.o._[1];this._[0] -= x + t.v._[0];this._[1] -= y + t.v._[1];return this.set(this._[0] * cosA + this._[1] * sinA + x, -this._[0] * sinA + this._[1] * cosA + y);};Vector.prototype.rotate = function(t, o){var sinA, cosA, x=0, y=0;if(typeof t === "number"){sinA = Math.sin(t);cosA = Math.cos(t);if(o){x = o.x;y = o.y;}}else {sinA = t.sinA;cosA = t.cosA;x = t.o._[0];y = t.o._[1];}this._[0] -= x;this._[1] -= y;return this.set(this._[0] * cosA - this._[1] * sinA + x, this._[0] * sinA + this._[1] * cosA + y);};Vector.prototype.rotateInv = function(t){return this.set((this._[0] - t.o._[0]) * t.cosA + (this._[1] - t.o._[1]) * t.sinA + t.o._[0], -(this._[0] - t.o._[0]) * t.sinA + (this._[1] - t.o._[1]) * t.cosA + t.o._[1]);};Vector.prototype.translate = function(t){return this.vadd(t.v);};Vector.prototype.translateInv = function(t){return this.vsub(t.v);};Vector.prototype.clone = function(v){if(v){if(!v._){return this.set(v.x, v.y);}this.recalc = v.recalc;if(!v.recalc){this._[3] = v._[3];this._[4] = v._[4];}this._[0] = v._[0];this._[1] = v._[1];return this;}return new Vector(this);};Vector.prototype.swap = function(v){var _=this._;this._ = v._;v._ = _;_ = this.recalc;this.recalc = v.recalc;v.recalc = _;return this;};Vector.prototype.values = function(){return {x:this._[0], y:this._[1]};};Vector.prototype.zero = function(){this._[3] = 0;this._[4] = 0;this._[0] = 0;this._[1] = 0;return this;};Vector.prototype.negate = function(component){if(component !== undefined){this._[component] = -this._[component];return this;}this._[0] = -this._[0];this._[1] = -this._[1];return this;};Vector.prototype.clamp = function(minV, maxV){this._[0] = min(max(this._[0], minV.x), maxV.x);this._[1] = min(max(this._[1], minV.y), maxV.y);this.recalc = true;return this;};Vector.prototype.toString = function(){return "(" + this._[0] + ", " + this._[1] + ")";};Vector.prototype.equals = function(v){return this._[0] === v._[0] && this._[1] === v._[1] && this._[2] === v._[2];};Vector.axis = [new Vector(1, 0), new Vector(0, 1)];Vector.zero = new Vector(0, 0);Physics.vector = Vector;})(this);(function(window){var _Physics=window.Physics;Physics.noConflict = function(){if(window.Physics === Physics){window.Physics = _Physics;}return Physics;};})(this);var Decorator=Physics.util.decorator = function Decorator(type, baseProto){var registry={}, proto={};var extend=function extend(to, from){var desc, key;for(key in from) {desc = Object.getOwnPropertyDescriptor(from, key);if(desc.get || desc.set){Object.defineProperty(to, key, desc);}else if(Physics.util.isFunction(desc.value)){to[key] = desc.value;}}return to;};var getProto=Object.getPrototypeOf;if(typeof getProto !== "function"){if(typeof "test".__proto__ === "object"){getProto = function(object){return object.__proto__;};}else {getProto = function(object){return object.constructor.prototype;};}}var objectCreate=Object.create;if(typeof objectCreate !== "function"){objectCreate = function(o){function F(){}F.prototype = o;return new F();};}var mixin=function mixin(key, val){if(typeof key === "object"){proto = extend(proto, key);proto.type = type;return;}if(key !== "type" && Physics.util.isFunction(val)){proto[key] = val;}};mixin(baseProto);var factory=function factory(name, parentName, decorator, cfg){var instance, result, parent=proto, tmp;if(typeof parentName !== "string"){cfg = decorator;decorator = parentName;}else {parent = registry[parentName];if(!parent){throw "Error: \"" + parentName + "\" " + type + " not defined";}parent = parent.prototype;}if(typeof decorator === "function"){result = registry[name];if(result){result.prototype = extend(result.prototype, decorator(getProto(result.prototype)));}else {result = registry[name] = function constructor(opts){if(this.init){this.init(opts);}};result.prototype = objectCreate(parent);result.prototype = extend(result.prototype, decorator(parent, result.prototype));}result.prototype.type = type;result.prototype.name = name;}else {cfg = decorator || {};result = registry[name];if(!result){throw "Error: \"" + name + "\" " + type + " not defined";}}if(cfg){return new result(cfg);}};factory.mixin = mixin;return factory;};Physics.util.indexOf = function indexOf(arr, value){var fr=0, bk=arr.length;while(fr < bk) {bk--;if(arr[fr] === value){return fr;}if(arr[bk] === value){return bk;}fr++;}return -1;};Physics.util.clearArray = function clearArray(arr){var l=arr.length;while(l--) {arr.pop();}return arr;};Physics.util.throttle = function throttle(fn, delay, scope){var to, call=false, args, cb=(function(_cb){var _cbWrapper=function cb(){return _cb.apply(this, arguments);};_cbWrapper.toString = function(){return _cb.toString();};return _cbWrapper;})(function(){clearTimeout(to);if(call){call = false;to = setTimeout(cb, delay);fn.apply(scope, args);}else {to = false;}});scope = scope || null;return function(){call = true;args = arguments;if(!to){cb();}};};var deepCopyFn=(function(_deepCopyFn){var _deepCopyFnWrapper=function deepCopyFn(_x, _x2){return _deepCopyFn.apply(this, arguments);};_deepCopyFnWrapper.toString = function(){return _deepCopyFn.toString();};return _deepCopyFnWrapper;})(function(a, b){if(Physics.util.isPlainObject(b)){return Physics.util.extend({}, a, b, deepCopyFn);}return b !== undefined?b:a;});Physics.util.options = function(def, target){var _def={}, fn, callbacks=[];fn = function fn(options, deep){Physics.util.extend(target, options, deep?deepCopyFn:null);for(var i=0, l=callbacks.length; i < l; ++i) {callbacks[i](target);}return target;};fn.defaults = function defaults(def, deep){Physics.util.extend(_def, def, deep?deepCopyFn:null);Physics.util.defaults(target, _def, deep?deepCopyFn:null);return _def;};fn.onChange = function(cb){callbacks.push(cb);};target = target || fn;fn.defaults(def);return fn;};Physics.util.pairHash = function(id1, id2){id1 = id1 | 0;id2 = id2 | 0;if((id1 | 0) === (id2 | 0)){return -1;}return ((id1 | 0) > (id2 | 0)?id1 << 16 | id2 & 65535:id2 << 16 | id1 & 65535) | 0;};if(!Function.prototype.bind){Physics.util.bind = function(fn, scope, args){args = Array.prototype.slice.call(arguments, 2);return function(){return fn.apply(scope, args.concat(Array.prototype.slice.call(arguments)));};};}else {Physics.util.bind = function(fn, scope, args){args = Array.prototype.slice.call(arguments, 1);return Function.prototype.bind.apply(fn, args);};}Physics.util.find = function(collection, fn){var i, l=collection.length, val;for(i = 0; i < l; i++) {val = collection[i];if(fn(val, i, collection)){return val;}}};Physics.util.filter = function(collection, fn){var i, l=collection.length, val, matches=[];for(i = 0; i < l; i++) {val = collection[i];if(fn(val, i, collection)){matches.push(val);}}return matches;};(function(){var objectTypes={boolean:false, "function":true, object:true, number:false, string:false, undefined:false};var identity=function identity(a){return a;};var arrayClass="[object Array]";var objectClass="[object Object]";var nativeKeys=Object.keys;var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var largeArraySize=75;var arrayPool=[], objectPool=[];var maxPoolSize=40;var keyPrefix=+new Date() + "";function releaseArray(array){Physics.util.clearArray(array);if(arrayPool.length < maxPoolSize){arrayPool.push(array);}}function releaseObject(object){var cache=object.cache;if(cache){releaseObject(cache);}object.array = object.cache = object.criteria = object.object = object.number = object.string = object.value = null;if(objectPool.length < maxPoolSize){objectPool.push(object);}}function getObject(){return objectPool.pop() || {array:null, cache:null, criteria:null, "false":false, index:0, "null":false, number:null, object:null, push:null, string:null, "true":false, undefined:false, value:null};}function getArray(){return arrayPool.pop() || [];}function cacheIndexOf(cache, value){var type=typeof value;cache = cache.cache;if(type === "boolean" || value == null){return cache[value]?0:-1;}if(type !== "number" && type !== "string"){type = "object";}var key=type === "number"?value:keyPrefix + value;cache = (cache = cache[type]) && cache[key];return type === "object"?cache && Physics.util.indexOf(cache, value) > -1?0:-1:cache?0:-1;}function cachePush(value){var cache=this.cache, type=typeof value;if(type === "boolean" || value == null){cache[value] = true;}else {if(type !== "number" && type !== "string"){type = "object";}var key=type === "number"?value:keyPrefix + value, typeCache=cache[type] || (cache[type] = {});if(type === "object"){(typeCache[key] || (typeCache[key] = [])).push(value);}else {typeCache[key] = true;}}}function createCache(array){var index=-1, length=array.length, first=array[0], mid=array[length / 2 | 0], last=array[length - 1];if(first && typeof first === "object" && mid && typeof mid === "object" && last && typeof last === "object"){return false;}var cache=getObject();cache["false"] = cache["null"] = cache["true"] = cache.undefined = false;var result=getObject();result.array = array;result.cache = cache;result.push = cachePush;while(++index < length) {result.push(array[index]);}return result;}var shimKeys=function shimKeys(object){var index, iterable=object, result=[];if(!iterable){return result;}if(!objectTypes[typeof object]){return result;}for(index in iterable) {if(hasOwnProperty.call(iterable, index)){result.push(index);}}return result;};var keys=!nativeKeys?shimKeys:function(object){if(!Physics.util.isObject(object)){return [];}return nativeKeys(object);};var idCounter=0;Physics.util.uniqueId = function uniqueId(prefix){var id=++idCounter;return "" + (prefix || "") + id;};function baseRandom(min, max){return min + Math.floor(Math.random() * (max - min + 1));}Physics.util.shuffle = function(collection){var index=-1, length=collection?collection.length:0, result=Array(typeof length === "number"?length:0), i, l, value, rand;for(i = 0, l = collection.length; i < l; i++) {value = collection[i];rand = baseRandom(0, ++index);result[index] = result[rand];result[rand] = value;}return result;};Physics.util.isObject = function isObject(value){return !!(value && objectTypes[typeof value]);};function isFunction(value){return typeof value === "function";}Physics.util.isFunction = isFunction;Physics.util.isArray = Array.isArray || function(value){return value && typeof value === "object" && typeof value.length === "number" && toString.call(value) === arrayClass || false;};var reNative=RegExp("^" + String(toString).replace(/[.*+?^${}()|[\]\\]/g, "\\$&").replace(/toString| for [^\]]+/g, ".*?") + "$");function isNative(value){return typeof value === "function" && reNative.test(value);}function shimIsPlainObject(value){var ctor, result;if(!(value && toString.call(value) === objectClass) || (ctor = value.constructor, isFunction(ctor) && !(ctor instanceof ctor))){return false;}for(var key in value) {result = key;}return typeof result === "undefined" || hasOwnProperty.call(value, result);}Physics.util.isPlainObject = !Object.getPrototypeOf?shimIsPlainObject:function(value){if(!(value && toString.call(value) === objectClass)){return false;}var valueOf=value.valueOf, objProto=isNative(valueOf) && (objProto = Object.getPrototypeOf(valueOf)) && Object.getPrototypeOf(objProto);return objProto?value === objProto || Object.getPrototypeOf(value) === objProto:shimIsPlainObject(value);};function baseUniq(array, isSorted, callback){var index=-1, indexOf=Physics.util.indexOf, length=array?array.length:0, result=[];var isLarge=!isSorted && length >= largeArraySize && indexOf === Physics.util.indexOf, seen=callback || isLarge?getArray():result;if(isLarge){var cache=createCache(seen);indexOf = cacheIndexOf;seen = cache;}while(++index < length) {var value=array[index], computed=callback?callback(value, index, array):value;if(isSorted?!index || seen[seen.length - 1] !== computed:indexOf(seen, computed) < 0){if(callback || isLarge){seen.push(computed);}result.push(value);}}if(isLarge){releaseArray(seen.array);releaseObject(seen);}else if(callback){releaseArray(seen);}return result;}Physics.util.uniq = function uniq(array, isSorted, callback){if(typeof isSorted !== "boolean" && isSorted != null){callback = isSorted;isSorted = false;}return baseUniq(array, isSorted, callback);};var assign=function assign(object, source, guard){var index, iterable=object, result=iterable;if(!iterable){return result;}var args=arguments, argsIndex=0, callback, argsLength=typeof guard === "number"?2:args.length;if(argsLength > 2 && typeof args[argsLength - 1] === "function"){callback = args[--argsLength];}while(++argsIndex < argsLength) {iterable = args[argsIndex];if(iterable && objectTypes[typeof iterable]){var ownIndex=-1, ownProps=objectTypes[typeof iterable] && keys(iterable), length=ownProps?ownProps.length:0;while(++ownIndex < length) {index = ownProps[ownIndex];result[index] = callback?callback(result[index], iterable[index]):iterable[index];}}}return result;};Physics.util.extend = assign;Physics.util.defaults = function(object, source, guard){var index, iterable=object, result=iterable;if(!iterable){return result;}var args=arguments, argsIndex=0, argsLength=typeof guard === "number"?2:args.length;while(++argsIndex < argsLength) {iterable = args[argsIndex];if(iterable && objectTypes[typeof iterable]){var ownIndex=-1, ownProps=objectTypes[typeof iterable] && keys(iterable), length=ownProps?ownProps.length:0;while(++ownIndex < length) {index = ownProps[ownIndex];if(typeof result[index] === "undefined"){result[index] = iterable[index];}}}}return result;};Physics.util.sortedIndex = function sortedIndex(array, value, callback){var low=0, high=array?array.length:low;callback = callback || identity;value = callback(value);while(low < high) {var mid=low + high >>> 1;callback(array[mid]) < value?low = mid + 1:high = mid;}return low;};})();Physics.scratchpad = (function(){var SCRATCH_USAGE_ERROR="Error: Scratchpad used after .done() called. (Could it be unintentionally scoped?)";var SCRATCH_INDEX_OUT_OF_BOUNDS="Error: Scratchpad usage space out of bounds. (Did you forget to call .done()?)";var SCRATCH_MAX_REACHED="Error: Too many scratchpads created. (Did you forget to call .done()?)";var ALREADY_DEFINED_ERROR="Error: Object is already registered.";var scratches=[];var numScratches=0;var Scratch, Scratchpad;var regIndex=0;Scratch = function Scratch(){this._active = false;this._indexArr = [];if(++numScratches >= Scratchpad.maxScratches){throw SCRATCH_MAX_REACHED;}};Scratch.prototype = {done:function done(val){this._active = false;var s;for(var i=0; i < regIndex; ++i) {this[i] = 0;}scratches.push(this);return val;}};Scratchpad = function Scratchpad(fn){if(fn){return Scratchpad.fn(fn);}var scratch=scratches.pop() || new Scratch();scratch._active = true;return scratch;};Scratchpad.maxScratches = 100;Scratchpad.maxIndex = 20;Scratchpad.fn = function(fn){var args=[];for(var i=0, l=fn.length; i < l; i++) {args.push(i);}args = "a" + args.join(",a");var handle=new Function("fn, scratches, Scratch", "return function(" + args + "){ " + "var scratch = scratches.pop() || new Scratch( scratches );" + "scratch._active = true;" + "return scratch.done( fn(scratch, " + args + ") );" + "};");return handle(fn, scratches, Scratch);};Scratchpad.register = function register(name, constructor, options){var proto=Scratch.prototype, idx=regIndex++, stackname="_" + name + "Stack", useFactory=options && options.useFactory;if(name in proto){throw ALREADY_DEFINED_ERROR;}Scratch.prototype[name] = function(){var stack=this[stackname] || (this[stackname] = []), stackIndex=this[idx] | 0;this[idx] = stackIndex + 1;if(!this._active){throw SCRATCH_USAGE_ERROR;}if(stackIndex >= Scratchpad.maxIndex){throw SCRATCH_INDEX_OUT_OF_BOUNDS;}return stack[stackIndex] || (stack[stackIndex] = useFactory?constructor():new constructor());};};Scratchpad.register("vector", Physics.vector);Scratchpad.register("transform", Physics.transform);return Scratchpad;})();(function(){var defaultPriority=1;function getPriority(val){return val._priority_;}Physics.scratchpad.register("event", function(){return {};}, {useFactory:true});var PubSub=function PubSub(){if(!(this instanceof PubSub)){return new PubSub();}};PubSub.prototype = {on:function on(topic, fn, scope, priority){var listeners, orig, idx;this._topics = this._topics || (this._topics = {});if(Physics.util.isObject(topic)){for(var t in topic) {this.on(t, topic[t], fn, scope);}return this;}listeners = this._topics[topic] || (this._topics[topic] = []);orig = fn;if(Physics.util.isObject(scope)){fn = Physics.util.bind(fn, scope);fn._bindfn_ = orig;fn._one_ = orig._one_;fn._scope_ = scope;}else if(priority === undefined){priority = scope;}fn._priority_ = priority === undefined?defaultPriority:priority;idx = Physics.util.sortedIndex(listeners, fn, getPriority);listeners.splice(idx, 0, fn);return this;}, off:function off(topic, fn, scope){var listeners, listn;if(!this._topics){return this;}if(topic === true){this._topics = {};return this;}if(Physics.util.isObject(topic)){for(var t in topic) {this.off(t, topic[t]);}return this;}listeners = this._topics[topic];if(!listeners){return this;}if(fn === true){this._topics[topic] = [];return this;}for(var i=0, l=listeners.length; i < l; i++) {listn = listeners[i];if((listn._bindfn_ === fn || listn === fn) && (!scope || listn._scope_ === scope)){listeners.splice(i, 1);break;}}return this;}, emit:function emit(topic, data){if(!this._topics){return this;}var listeners=this._topics[topic], l=listeners && listeners.length, handler, e, scratch=Physics.scratchpad();if(!l){return scratch.done(this);}e = scratch.event();e.topic = topic;e.handler = handler;while(l--) {handler = listeners[l];handler(data, e);if(handler._one_){listeners.splice(l, 1);}}return scratch.done(this);}, one:function one(topic, fn, scope){if(Physics.util.isObject(topic)){for(var t in topic) {this.one(t, topic[t], fn, scope);}return this;}fn._one_ = true;this.on(topic, fn, scope);return this;}};Physics.util.pubsub = PubSub;})();(function(window){var active=true, ps=Physics.util.pubsub(), perf=window.performance;function now(){return perf && perf.now?perf.now() + perf.timing.navigationStart:Date.now();}function step(){var time;window.requestAnimationFrame(step);if(!active){return;}time = now();if(!time){return;}ps.emit("tick", time);}if(window.requestAnimationFrame){step();}else {active = false;}function start(){active = true;return this;}function stop(){active = false;return this;}function on(listener){ps.on("tick", listener);return this;}function off(listener){ps.off("tick", listener);return this;}function isActive(){return !!active;}Physics.util.ticker = {now:now, start:start, stop:stop, on:on, off:off, isActive:isActive};})(this);(function(window){var fnTrue=function fnTrue(){return !0;};var indexOf=Physics.util.indexOf;var wrapRule=function wrapRule(fn, prop){return function(thing){return fn(thing[prop]);};};var $eq=function $eq(toMatch, prop){return function(thing){thing = prop?thing[prop]:thing;var fr=0, bk;if(Physics.util.isArray(thing)){if(Physics.util.isArray(toMatch)){bk = thing.length;if(bk !== toMatch.length){return false;}while(fr < bk) {bk--;if(indexOf(toMatch, thing[fr]) === -1 || indexOf(toMatch, thing[bk]) === -1){return false;}fr++;}return true;}else {return indexOf(thing, toMatch) > -1;}}return thing === toMatch;};};var $ne=function $ne(toMatch, prop){var fn=$eq(toMatch, prop);return function(thing){return !fn(thing);};};var $in=function $in(toMatch, prop){return function(thing){thing = prop?thing[prop]:thing;var fr=0, bk;if(Physics.util.isArray(thing)){bk = thing.length;while(fr < bk) {bk--;if(indexOf(toMatch, thing[fr]) > -1 || indexOf(toMatch, thing[bk]) > -1){return true;}fr++;}return false;}return indexOf(toMatch, thing) > -1;};};var $nin=function $nin(toMatch, prop){var fn=$in(toMatch, prop);return function(thing){return !fn(thing);};};var $at=function $at(point){point = new Physics.vector(point);return function(body){var aabb=body.aabb();return Physics.aabb.contains(aabb, point);};};var $and=function $and(first){return first.next?function(thing){var fn=first;while(fn) {if(!fn(thing)){return false;}fn = fn.next;}return true;}:first;};var $or=function $or(first){return first.next?function(thing){var fn=first;while(fn) {if(fn(thing)){return true;}fn = fn.next;}return false;}:first;};var operations={$eq:$eq, $ne:$ne, $in:$in, $nin:$nin, $at:$at};var Query=function Query(rules, $op){var op, l, rule, first, list, fn;if($op){if($op === "$or" || $op === "$and"){for(op = 0, l = rules.length; op < l; ++op) {fn = Query(rules[op]);list = list?list.next = fn:first = fn;}return $op === "$or"?$or(first):$and(first);}else if(op = operations[$op]){return op(rules);}else {throw "Unknown query operation: " + $op;}}for(op in rules) {rule = rules[op];if(op[0] === "$"){fn = Query(rule, op);}else if(Physics.util.isPlainObject(rule)){fn = wrapRule(Query(rule), op);}else {fn = $eq(rule, op);}list = list?list.next = fn:first = fn;}return $and(first || fnTrue);};Physics.query = Query;})(this);(function(){var defaults={priority:0};Physics.behavior = Decorator("behavior", {init:function init(options){this.options = Physics.util.options(defaults);this.options(options);}, applyTo:function applyTo(arr){if(arr === true){this._targets = null;}else {this._targets = Physics.util.uniq(arr);}return this;}, getTargets:function getTargets(){return this._targets || (this._world?this._world._bodies:[]);}, setWorld:function setWorld(world){if(this.disconnect && this._world){this.disconnect(this._world);}this._world = world;if(this.connect && world){this.connect(world);}return this;}, connect:function connect(world){if(this.behave){world.on("integrate:positions", this.behave, this, this.options.priority);}}, disconnect:function disconnect(world){if(this.behave){world.off("integrate:positions", this.behave, this);}}, behave:null});})();(function(){var defaults={hidden:false, treatment:"dynamic", mass:1, restitution:1, cof:0.8, view:null};var uidGen=1;var Pi2=Math.PI * 2;function cycleAngle(ang){return (ang % Pi2 + Pi2) % Pi2;}Physics.body = Decorator("body", {init:function init(options){var self=this;var vector=Physics.vector;this.options = Physics.util.options(defaults, this);this.options.onChange(function(opts){self.offset = new vector(opts.offset);});this.options(options);this.state = {pos:new vector(this.x, this.y), vel:new vector(this.vx, this.vy), acc:new vector(), angular:{pos:this.angle || 0, vel:this.angularVelocity || 0, acc:0}, old:{pos:new vector(), vel:new vector(), acc:new vector(), angular:{pos:0, vel:0, acc:0}}};this._sleepAngPosMean = 0;this._sleepAngPosVariance = 0;this._sleepPosMean = new vector();this._sleepPosVariance = new vector();this._sleepMeanK = 0;delete this.x;delete this.y;delete this.vx;delete this.vy;delete this.angle;delete this.angularVelocity;if(this.mass === 0){throw "Error: Bodies must have non-zero mass";}this.uid = uidGen++;this.geometry = Physics.geometry("point");}, sleep:function sleep(dt){if(dt === true){this.asleep = true;}else if(dt === false){this.asleep = false;this._sleepMeanK = 0;this._sleepAngPosMean = 0;this._sleepAngPosVariance = 0;this._sleepPosMean.zero();this._sleepPosVariance.zero();this.sleepIdleTime = 0;}else if(dt && !this.asleep){this.sleepCheck(dt);}return this.asleep;}, sleepCheck:function sleepCheck(dt){var opts=this._world && this._world.options;if(this.sleepDisabled || opts && opts.sleepDisabled){return;}var limit, v, d, r, aabb, scratch=Physics.scratchpad(), diff=scratch.vector(), diff2=scratch.vector(), kfac, stats;dt = dt || 0;aabb = this.geometry.aabb();r = Math.max(aabb.hw, aabb.hh);if(this.asleep){v = this.state.vel.norm() + Math.abs(r * this.state.angular.vel);limit = this.sleepSpeedLimit || opts && opts.sleepSpeedLimit || 0;if(v >= limit){this.sleep(false);return scratch.done();}}this._sleepMeanK++;kfac = this._sleepMeanK > 1?1 / (this._sleepMeanK - 1):0;Physics.statistics.pushRunningVectorAvg(this.state.pos, this._sleepMeanK, this._sleepPosMean, this._sleepPosVariance);stats = Physics.statistics.pushRunningAvg(Math.sin(this.state.angular.pos), this._sleepMeanK, this._sleepAngPosMean, this._sleepAngPosVariance);this._sleepAngPosMean = stats[0];this._sleepAngPosVariance = stats[1];v = this._sleepPosVariance.norm() + Math.abs(r * Math.asin(stats[1]));v *= kfac;limit = this.sleepVarianceLimit || opts && opts.sleepVarianceLimit || 0;if(v <= limit){limit = this.sleepTimeLimit || opts && opts.sleepTimeLimit || 0;this.sleepIdleTime = (this.sleepIdleTime || 0) + dt;if(this.sleepIdleTime > limit){this.asleep = true;}}else {this.sleep(false);}scratch.done();}, setWorld:function setWorld(world){if(this.disconnect && this._world){this.disconnect(this._world);}this._world = world;if(this.connect && world){this.connect(world);}return this;}, accelerate:function accelerate(acc){if(this.treatment === "dynamic"){this.state.acc.vadd(acc);}return this;}, applyForce:function applyForce(force, p){if(this.treatment !== "dynamic"){return this;}var scratch=Physics.scratchpad(), r=scratch.vector(), state;if(p && this.moi){state = this.state;r.clone(p);this.state.angular.acc -= r.cross(force) / this.moi;}this.accelerate(r.clone(force).mult(1 / this.mass));scratch.done();return this;}, getGlobalOffset:function getGlobalOffset(out){out = out || new Physics.vector();out.clone(this.offset).rotate(this.state.angular.pos);return out;}, aabb:(function(_aabb){var _aabbWrapper=function aabb(){return _aabb.apply(this, arguments);};_aabbWrapper.toString = function(){return _aabb.toString();};return _aabbWrapper;})(function(){var angle=this.state.angular.pos, scratch=Physics.scratchpad(), v=scratch.vector(), aabb=this.geometry.aabb(angle);this.getGlobalOffset(v);aabb.x += this.state.pos._[0] + v._[0];aabb.y += this.state.pos._[1] + v._[1];return scratch.done(aabb);}), toBodyCoords:function toBodyCoords(v){return v.vsub(this.state.pos).rotate(-this.state.angular.pos);}, toWorldCoords:function toWorldCoords(v){return v.rotate(this.state.angular.pos).vadd(this.state.pos);}, recalc:function recalc(){return this;}});Physics.body.getCOM = function(bodies, com){var b, pos, i, l=bodies && bodies.length, M=0;com = com || new Physics.vector();if(!l){return com.zero();}if(l === 1){return com.clone(bodies[0].state.pos);}com.zero();for(i = 0; i < l; i++) {b = bodies[i];pos = b.state.pos;com.add(pos._[0] * b.mass, pos._[1] * b.mass);M += b.mass;}com.mult(1 / M);return com;};})();(function(){Physics.geometry = Decorator("geometry", {init:function init(options){this.options = Physics.util.options();this.options(options);this._aabb = new Physics.aabb();}, aabb:function aabb(angle){return Physics.aabb.clone(this._aabb);}, getFarthestHullPoint:function getFarthestHullPoint(dir, result){result = result || new Physics.vector();return result.set(0, 0);}, getFarthestCorePoint:function getFarthestCorePoint(dir, result, margin){result = result || new Physics.vector();return result.set(0, 0);}});})();Physics.geometry.regularPolygonVertices = function(sides, radius){var verts=[], angle=Math.PI * 2 / sides, a=0, i;for(i = 0; i < sides; i++) {verts.push({x:radius * Math.cos(a), y:radius * Math.sin(a)});a += angle;}return verts;};Physics.geometry.isPolygonConvex = function(hull){var scratch=Physics.scratchpad(), prev=scratch.vector(), next=scratch.vector(), tmp=scratch.vector(), ret=true, sign=false, l=hull.length;if(!hull || !l){return false;}if(l < 3){scratch.done();return ret;}prev.clone(hull[0]).vsub(tmp.clone(hull[l - 1]));for(var i=1; i <= l; ++i) {next.clone(hull[i % l]).vsub(tmp.clone(hull[(i - 1) % l]));if(sign === false){sign = prev.cross(next);}else if(sign > 0 ^ prev.cross(next) > 0){ret = false;break;}next.swap(prev);}scratch.done();return ret;};Physics.geometry.getPolygonMOI = function(hull){var scratch=Physics.scratchpad(), prev=scratch.vector(), next=scratch.vector(), num=0, denom=0, tmp, l=hull.length;if(l < 2){scratch.done();return 0;}if(l === 2){tmp = next.clone(hull[1]).distSq(prev.clone(hull[0]));scratch.done();return tmp / 12;}prev.clone(hull[0]);for(var i=1; i < l; ++i) {next.clone(hull[i]);tmp = Math.abs(next.cross(prev));num += tmp * (next.normSq() + next.dot(prev) + prev.normSq());denom += tmp;prev.swap(next);}scratch.done();return num / (6 * denom);};Physics.geometry.isPointInPolygon = function(pt, hull){var scratch=Physics.scratchpad(), point=scratch.vector().clone(pt), prev=scratch.vector(), next=scratch.vector(), ang=0, l=hull.length;if(l < 2){ang = point.equals(prev.clone(hull[0]));scratch.done();return ang;}if(l === 2){ang = point.angle(prev.clone(hull[0]));ang += point.angle(prev.clone(hull[1]));scratch.done();return Math.abs(ang) === Math.PI;}prev.clone(hull[0]).vsub(point);for(var i=1; i <= l; ++i) {next.clone(hull[i % l]).vsub(point);ang += next.angle(prev);prev.swap(next);}scratch.done();return Math.abs(ang) > 0.000001;};Physics.geometry.getPolygonArea = function getPolygonArea(hull){var scratch=Physics.scratchpad(), prev=scratch.vector(), next=scratch.vector(), ret=0, l=hull.length;if(l < 3){scratch.done();return 0;}prev.clone(hull[l - 1]);for(var i=0; i < l; ++i) {next.clone(hull[i]);ret += prev.cross(next);prev.swap(next);}scratch.done();return ret / 2;};Physics.geometry.getPolygonCentroid = function getPolygonCentroid(hull){var scratch=Physics.scratchpad(), prev=scratch.vector(), next=scratch.vector(), ret=new Physics.vector(), tmp, l=hull.length;if(l < 2){scratch.done();return new Physics.vector(hull[0]);}if(l === 2){scratch.done();return new Physics.vector((hull[1].x + hull[0].x) / 2, (hull[1].y + hull[0].y) / 2);}prev.clone(hull[l - 1]);for(var i=0; i < l; ++i) {next.clone(hull[i]);tmp = prev.cross(next);prev.vadd(next).mult(tmp);ret.vadd(prev);prev.swap(next);}tmp = 1 / (6 * Physics.geometry.getPolygonArea(hull));scratch.done();return ret.mult(tmp);};Physics.geometry.nearestPointOnLine = function nearestPointOnLine(pt, linePt1, linePt2){var scratch=Physics.scratchpad(), p=scratch.vector().clone(pt), A=scratch.vector().clone(linePt1).vsub(p), L=scratch.vector().clone(linePt2).vsub(p).vsub(A), lambdaB, lambdaA;if(L.equals(Physics.vector.zero)){scratch.done();return new Physics.vector(linePt1);}lambdaB = -L.dot(A) / L.normSq();lambdaA = 1 - lambdaB;if(lambdaA <= 0){scratch.done();return new Physics.vector(linePt2);}else if(lambdaB <= 0){scratch.done();return new Physics.vector(linePt1);}p = new Physics.vector(linePt2).mult(lambdaB).vadd(A.clone(linePt1).mult(lambdaA));scratch.done();return p;};(function(){var defaults={drag:0};Physics.integrator = Decorator("integrator", {init:function init(options){this.options = Physics.util.options(defaults);this.options(options);}, setWorld:function setWorld(world){if(this.disconnect && this._world){this.disconnect(this._world);}this._world = world;if(this.connect && world){this.connect(world);}return this;}, integrate:function integrate(bodies, dt){var world=this._world;this.integrateVelocities(bodies, dt);if(world){world.emit("integrate:velocities", {bodies:bodies, dt:dt});}this.integratePositions(bodies, dt);if(world){world.emit("integrate:positions", {bodies:bodies, dt:dt});}return this;}, connect:null, disconnect:null, integrateVelocities:function integrateVelocities(bodies, dt){throw "The integrator.integrateVelocities() method must be overriden";}, integratePositions:function integratePositions(bodies, dt){throw "The integrator.integratePositions() method must be overriden";}});})();(function(){var defaults={meta:false, metaRefresh:200, width:600, height:600, autoResize:true};Physics.renderer = Decorator("renderer", {init:function init(options){var self=this, el=typeof options.el === "string"?document.getElementById(options.el):options.el;this.options = Physics.util.options(defaults);this.options(options);this.el = el?el:document.body;this.container = el && el.parentNode?el.parentNode:document.body;this.drawMeta = Physics.util.throttle(Physics.util.bind(this.drawMeta, this), this.options.metaRefresh);window.addEventListener("resize", Physics.util.throttle(function(){if(self.options.autoResize){self.resize();}}), 100);}, resize:function resize(width, height){if(width === undefined && height === undefined){width = this.container.offsetWidth;height = this.container.offsetHeight;}this.width = width || 0;this.height = height || 0;}, setWorld:function setWorld(world){if(this.disconnect && this._world){this.disconnect(this._world);}this._world = world;if(this.connect && world){this.connect(world);}return this;}, render:function render(bodies, meta){var body, view, pos;if(this.beforeRender){this.beforeRender();}this._world.emit("beforeRender", {renderer:this, bodies:bodies, meta:meta});if(this.options.meta){this.drawMeta(meta);}this._interpolateTime = meta.interpolateTime;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];view = body.view || (body.view = this.createView(body.geometry, body.styles));if(!body.hidden){this.drawBody(body, view);}}return this;}, createView:function createView(geometry, styles){throw "You must override the renderer.createView() method.";}, drawMeta:function drawMeta(meta){throw "You must override the renderer.drawMeta() method.";}, drawBody:function drawBody(body, view){throw "You must override the renderer.drawBody() method.";}});})();(function(){var execCallbacks=function execCallbacks(fns, scope, args){var fn, ret, cb=function cb(){return execCallbacks(fns, scope, args);};while(fn = fns.shift()) {ret = fn.apply(scope, args);if(ret && ret.then){return ret.then(cb);}}};var defaults={timestep:6, maxIPF:4, webworker:false, integrator:"verlet", sleepDisabled:false, sleepSpeedLimit:0.05, sleepVarianceLimit:0.02, sleepTimeLimit:500};var World=function World(cfg, fn){if(!(this instanceof World)){return new World(cfg, fn);}this.init(cfg, fn);};World.prototype = Physics.util.extend({}, Physics.util.pubsub.prototype, {init:function init(cfg, fn){var self=this;if(Physics.util.isFunction(cfg) || Physics.util.isArray(cfg)){fn = cfg;cfg = {};}this._meta = {fps:0, ipf:0};this._bodies = [];this._behaviors = [];this._integrator = null;this._renderer = null;this._paused = false;this._warp = 1;this._time = 0;this.options = Physics.util.options(defaults);this.options.onChange(function(opts){self.timestep(opts.timestep);});this.options(cfg);this.add(Physics.integrator(this.options.integrator));if(Physics.util.isFunction(fn)){execCallbacks([fn], this, [this, Physics]);}else if(Physics.util.isArray(fn)){execCallbacks(fn, this, [this, Physics]);}}, options:null, add:function add(arg){var i=0, len=arg && arg.length || 0, thing=Physics.util.isArray(arg)?arg[0]:arg;if(!thing){return this;}do{switch(thing.type){case "behavior":this.addBehavior(thing);break;case "integrator":this.integrator(thing);break;case "renderer":this.renderer(thing);break;case "body":this.addBody(thing);break;default:throw "Error: failed to add item of unknown type \"" + thing.type + "\" to world";}}while(++i < len && (thing = arg[i]));return this;}, remove:function remove(arg){var i=0, len=arg && arg.length || 0, thing=Physics.util.isArray(arg)?arg[0]:arg;if(!thing){return this;}do{switch(thing.type){case "behavior":this.removeBehavior(thing);break;case "integrator":if(thing === this._integrator){this.integrator(null);}break;case "renderer":if(thing === this._renderer){this.renderer(null);}break;case "body":this.removeBody(thing);break;default:throw "Error: failed to remove item of unknown type \"" + thing.type + "\" from world";}}while(++i < len && (thing = arg[i]));return this;}, has:function has(thing){var arr, i, l;if(!thing){return false;}switch(thing.type){case "behavior":arr = this._behaviors;break;case "integrator":return this._integrator === thing;case "renderer":return this._renderer === thing;case "body":arr = this._bodies;break;default:throw "Error: unknown type \"" + thing.type + "\"";}return Physics.util.indexOf(arr, thing) > -1;}, integrator:(function(_integrator){var _integratorWrapper=function integrator(_x){return _integrator.apply(this, arguments);};_integratorWrapper.toString = function(){return _integrator.toString();};return _integratorWrapper;})(function(integrator){if(integrator === undefined){return this._integrator;}if(this._integrator === integrator){return this;}if(this._integrator){this._integrator.setWorld(null);this.emit("remove:integrator", {integrator:this._integrator});}if(integrator){this._integrator = integrator;this._integrator.setWorld(this);this.emit("add:integrator", {integrator:this._integrator});}return this;}), renderer:(function(_renderer){var _rendererWrapper=function renderer(_x){return _renderer.apply(this, arguments);};_rendererWrapper.toString = function(){return _renderer.toString();};return _rendererWrapper;})(function(renderer){if(renderer === undefined){return this._renderer;}if(this._renderer === renderer){return this;}if(this._renderer){this._renderer.setWorld(null);this.emit("remove:renderer", {renderer:this._renderer});}if(renderer){this._renderer = renderer;this._renderer.setWorld(this);this.emit("add:renderer", {renderer:this._renderer});}return this;}), timestep:function timestep(dt){if(dt){this._dt = +dt.toPrecision(4);this._maxJump = dt * this.options.maxIPF;return this;}return this._dt;}, wakeUpAll:function wakeUpAll(){var i=0, l=this._bodies.length;for(i = 0; i < l; i++) {this._bodies[i].sleep(false);}}, addBehavior:function addBehavior(behavior){var notify;if(this.has(behavior)){return this;}behavior.setWorld(this);this._behaviors.push(behavior);this.emit("add:behavior", {behavior:behavior});return this;}, getBehaviors:function getBehaviors(){return [].concat(this._behaviors);}, removeBehavior:function removeBehavior(behavior){var behaviors=this._behaviors;if(behavior){for(var i=0, l=behaviors.length; i < l; ++i) {if(behavior === behaviors[i]){behaviors.splice(i, 1);behavior.setWorld(null);this.emit("remove:behavior", {behavior:behavior});break;}}}return this;}, addBody:function addBody(body){var notify;if(this.has(body)){return this;}body.setWorld(this);this._bodies.push(body);this.emit("add:body", {body:body});return this;}, getBodies:function getBodies(){return [].concat(this._bodies);}, removeBody:function removeBody(body){var bodies=this._bodies;if(body){for(var i=0, l=bodies.length; i < l; ++i) {if(body === bodies[i]){bodies.splice(i, 1);body.setWorld(null);this.emit("remove:body", {body:body});break;}}}return this;}, findOne:function findOne(rules){var self=this, fn=typeof rules === "function"?rules:Physics.query(rules);return Physics.util.find(self._bodies, fn) || false;}, find:function find(rules){var self=this, fn=typeof rules === "function"?rules:Physics.query(rules);return Physics.util.filter(self._bodies, fn);}, iterate:function iterate(dt){this._integrator.integrate(this._bodies, dt);}, step:function step(now){var time=this._time, warp=this._warp, invWarp=1 / warp, dt=this._dt, animDt=dt * invWarp, animMaxJump=this._maxJump * invWarp, animDiff, worldDiff, target, meta=this._meta;if(this._paused || this._animTime === undefined){this._animTime = now || this._animTime || Physics.util.ticker.now();if(!this._paused){this.emit("step", meta);}return this;}now = now || this._animTime + animDt;animDiff = now - this._animTime;if(animDiff > animMaxJump){this._animTime = now - animMaxJump;animDiff = animMaxJump;}worldDiff = animDiff * warp;target = time + worldDiff - dt;this.emit("beforeStep");if(time <= target){while(time <= target) {time += dt;this._animTime += animDt;this._time = time;this.iterate(dt);}}meta.fps = 1000 / (now - this._lastTime);meta.ipf = (worldDiff / dt).toFixed(2);meta.interpolateTime = dt + target - time;this._lastTime = now;this.emit("step", meta);return this;}, warp:(function(_warp){var _warpWrapper=function warp(_x){return _warp.apply(this, arguments);};_warpWrapper.toString = function(){return _warp.toString();};return _warpWrapper;})(function(warp){if(warp === undefined){return this._warp;}this._warp = warp || 1;return this;}), render:function render(){if(!this._renderer){throw "No renderer added to world";}this._renderer.render(this._bodies, this._meta);this.emit("render", {bodies:this._bodies, meta:this._meta, renderer:this._renderer});return this;}, pause:function pause(){this._paused = true;this.emit("pause");return this;}, unpause:function unpause(){this._paused = false;this.emit("unpause");return this;}, isPaused:function isPaused(){return !!this._paused;}, destroy:function destroy(){var self=this;self.pause();this.emit("destroy");self.off(true);self.remove(self.getBodies());self.remove(self.getBehaviors());self.integrator(null);self.renderer(null);}});Physics.world = World;})();Physics.integrator("verlet", function(parent){Physics.body.mixin({started:function started(val){if(val !== undefined){this._started = true;}return !!this._started;}});return {init:function init(options){parent.init.call(this, options);}, integrateVelocities:function integrateVelocities(bodies, dt){var dtdt=dt * dt, drag=1 - this.options.drag, body=null, state, prevDt=this.prevDt || dt, dtMul=(dtdt + dt * prevDt) * 0.5;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep(dt)){if(state.vel.equals(state.old.vel) && body.started()){state.vel.clone(state.pos).vsub(state.old.pos);}else {state.old.pos.clone(state.pos).vsub(state.vel);state.vel.mult(dt);}if(drag){state.vel.mult(drag);}state.vel.vadd(state.acc.mult(dtMul));state.vel.mult(1 / dt);state.old.vel.clone(state.vel);state.acc.zero();if(state.angular.vel === state.old.angular.vel && body.started()){state.angular.vel = state.angular.pos - state.old.angular.pos;}else {state.old.angular.pos = state.angular.pos - state.angular.vel;state.angular.vel *= dt;}state.angular.vel += state.angular.acc * dtMul;state.angular.vel /= dt;state.old.angular.vel = state.angular.vel;state.angular.acc = 0;body.started(true);}else {state.vel.zero();state.acc.zero();state.angular.vel = 0;state.angular.acc = 0;}}}, integratePositions:function integratePositions(bodies, dt){var dtdt=dt * dt, body=null, state, prevDt=this.prevDt || dt, dtcorr=dt / prevDt;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep()){state.vel.mult(dt * dtcorr);state.old.pos.clone(state.pos);state.pos.vadd(state.vel);state.vel.mult(1 / (dt * dtcorr));state.old.vel.clone(state.vel);state.angular.vel *= dt * dtcorr;state.old.angular.pos = state.angular.pos;state.angular.pos += state.angular.vel;state.angular.vel /= dt * dtcorr;state.old.angular.vel = state.angular.vel;}}this.prevDt = dt;}};});Physics.geometry("point", function(parent){});Physics.body("point", function(parent){return {init:function init(opts){parent.init.call(this, opts);this.moi = 0;}};});Physics.geometry("circle", function(parent){var defaults={radius:1};return {init:function init(options){var self=this;parent.init.call(this, options);this.options.defaults(defaults);this.options.onChange(function(opts){this.radius = opts.radius;});this.options(options);this._aabb = Physics.aabb();this.radius = this.options.radius;}, aabb:function aabb(angle){var r=this.radius;if(this._aabb.hw !== r){this._aabb = Physics.aabb(-r, -r, r, r);}return Physics.aabb.clone(this._aabb);}, getFarthestHullPoint:function getFarthestHullPoint(dir, result){result = result || new Physics.vector();return result.clone(dir).normalize().mult(this.radius);}, getFarthestCorePoint:function getFarthestCorePoint(dir, result, margin){result = result || new Physics.vector();return result.clone(dir).normalize().mult(this.radius - margin);}};});Physics.geometry("compound", function(parent){var defaults={};return {init:function init(options){var self=this;parent.init.call(this, options);this.options.defaults(defaults);this.options(options);this.children = [];}, addChild:function addChild(geometry, pos, angle){this._aabb = null;this.children.push({g:geometry, pos:new Physics.vector(pos), angle:angle});return this;}, clear:function clear(){this._aabb = null;this.children = [];return this;}, aabb:(function(_aabb){var _aabbWrapper=function aabb(_x){return _aabb.apply(this, arguments);};_aabbWrapper.toString = function(){return _aabb.toString();};return _aabbWrapper;})(function(angle){if(!angle && this._aabb){return Physics.aabb.clone(this._aabb);}var b, aabb, ch, ret, scratch=Physics.scratchpad(), pos=Physics.vector();angle = angle || 0;for(var i=0, l=this.children.length; i < l; i++) {ch = this.children[i];aabb = ch.g.aabb(angle + ch.angle);pos.clone(ch.pos);if(angle){pos.rotate(angle);}aabb.x += pos._[0];aabb.y += pos._[1];ret = ret?Physics.aabb.union(ret, aabb, true):aabb;}if(!angle){this._aabb = Physics.aabb.clone(ret);}return scratch.done(ret);}), getFarthestHullPoint:function getFarthestHullPoint(dir, result){var ch, i, l=this.children.length, scratch=Physics.scratchpad(), v=scratch.vector(), len=0, maxlen=0;result = result || new Physics.vector();for(i = 0; i < l; i++) {ch = this.children[i];ch.g.getFarthestHullPoint(dir.rotate(-ch.angle), v);len = v.rotate(ch.angle).vadd(ch.pos).proj(dir.rotate(ch.angle));if(len > maxlen){maxlen = len;result.swap(v);}}return scratch.done(result);}, getFarthestCorePoint:function getFarthestCorePoint(dir, result, margin){var ch, i, l=this.children.length, scratch=Physics.scratchpad(), v=scratch.vector(), len=0, maxlen=0;result = result || new Physics.vector();for(i = 0; i < l; i++) {ch = this.children[i];ch.g.getFarthestCorePoint(dir.rotate(-ch.angle), v, margin);len = v.rotate(ch.angle).vadd(ch.pos).proj(dir.rotate(ch.angle));if(len > maxlen){maxlen = len;result.swap(v);}}return scratch.done(result);}};});Physics.geometry("convex-polygon", function(parent){var ERROR_NOT_CONVEX="Error: The vertices specified do not match that of a _convex_ polygon.";var defaults={};return {init:function init(options){var self=this;parent.init.call(this, options);this.options.defaults(defaults);this.options.onChange(function(opts){self.setVertices(opts.vertices || []);});this.options(options);self.setVertices(this.options.vertices || []);}, setVertices:function setVertices(hull){var scratch=Physics.scratchpad(), transl=scratch.transform(), verts=this.vertices = [];if(!Physics.geometry.isPolygonConvex(hull)){throw ERROR_NOT_CONVEX;}transl.setRotation(0);transl.setTranslation(Physics.geometry.getPolygonCentroid(hull).negate());for(var i=0, l=hull.length; i < l; ++i) {verts.push(new Physics.vector(hull[i]).translate(transl));}this._area = Physics.geometry.getPolygonArea(verts);this._aabb = false;return scratch.done(this);}, aabb:(function(_aabb){var _aabbWrapper=function aabb(_x){return _aabb.apply(this, arguments);};_aabbWrapper.toString = function(){return _aabb.toString();};return _aabbWrapper;})(function(angle){if(!angle && this._aabb){return Physics.aabb.clone(this._aabb);}var scratch=Physics.scratchpad(), p=scratch.vector(), trans=scratch.transform().setRotation(angle || 0), xaxis=scratch.vector().set(1, 0).rotateInv(trans), yaxis=scratch.vector().set(0, 1).rotateInv(trans), xmax=this.getFarthestHullPoint(xaxis, p).proj(xaxis), xmin=-this.getFarthestHullPoint(xaxis.negate(), p).proj(xaxis), ymax=this.getFarthestHullPoint(yaxis, p).proj(yaxis), ymin=-this.getFarthestHullPoint(yaxis.negate(), p).proj(yaxis), aabb;aabb = Physics.aabb(xmin, ymin, xmax, ymax);if(!angle){this._aabb = Physics.aabb.clone(aabb);}scratch.done();return aabb;}), getFarthestHullPoint:function getFarthestHullPoint(dir, result, data){var verts=this.vertices, val, prev, l=verts.length, i=2, idx;result = result || new Physics.vector();if(l < 2){if(data){data.idx = 0;}return result.clone(verts[0]);}prev = verts[0].dot(dir);val = verts[1].dot(dir);if(l === 2){idx = val >= prev?1:0;if(data){data.idx = idx;}return result.clone(verts[idx]);}if(val >= prev){while(i < l && val >= prev) {prev = val;val = verts[i].dot(dir);i++;}if(val >= prev){i++;}idx = i - 2;if(data){data.idx = i - 2;}return result.clone(verts[idx]);}else {i = l;while(i > 1 && prev >= val) {i--;val = prev;prev = verts[i].dot(dir);}idx = (i + 1) % l;if(data){data.idx = idx;}return result.clone(verts[idx]);}}, getFarthestCorePoint:function getFarthestCorePoint(dir, result, margin){var norm, scratch=Physics.scratchpad(), next=scratch.vector(), prev=scratch.vector(), verts=this.vertices, l=verts.length, mag, sign=this._area > 0, data={};result = this.getFarthestHullPoint(dir, result, data);next.clone(verts[(data.idx + 1) % l]).vsub(result).normalize().perp(sign);prev.clone(verts[(data.idx - 1 + l) % l]).vsub(result).normalize().perp(!sign);mag = margin / (1 + next.dot(prev));result.vadd(next.vadd(prev).mult(mag));scratch.done();return result;}};});Physics.geometry("rectangle", function(parent){var defaults={};return {init:function init(options){var self=this;parent.init.call(this, options);this.options.defaults(defaults);this.options.onChange(function(opts){self.width = self.options.width || 1;self.height = self.options.height || 1;});this.options(options);}, aabb:function aabb(angle){if(!angle){return Physics.aabb(this.width, this.height);}var scratch=Physics.scratchpad(), p=scratch.vector(), trans=scratch.transform().setRotation(angle || 0), xaxis=scratch.vector().set(1, 0).rotateInv(trans), yaxis=scratch.vector().set(0, 1).rotateInv(trans), xmax=this.getFarthestHullPoint(xaxis, p).proj(xaxis), xmin=-this.getFarthestHullPoint(xaxis.negate(), p).proj(xaxis), ymax=this.getFarthestHullPoint(yaxis, p).proj(yaxis), ymin=-this.getFarthestHullPoint(yaxis.negate(), p).proj(yaxis);scratch.done();return Physics.aabb(xmin, ymin, xmax, ymax);}, getFarthestHullPoint:function getFarthestHullPoint(dir, result){result = result || new Physics.vector();var x=dir.x, y=dir.y;x = x === 0?0:x < 0?-this.width * 0.5:this.width * 0.5;y = y === 0?0:y < 0?-this.height * 0.5:this.height * 0.5;return result.set(x, y);}, getFarthestCorePoint:function getFarthestCorePoint(dir, result, margin){var x, y;result = this.getFarthestHullPoint(dir, result);x = result.x;y = result.y;result.x = x === 0?0:x < 0?x + margin:x - margin;result.y = y === 0?0:y < 0?y + margin:y - margin;return result;}};});Physics.body("circle", function(parent){var defaults={radius:1};return {init:function init(options){parent.init.call(this, options);options = Physics.util.extend({}, defaults, options);this.geometry = Physics.geometry("circle", {radius:options.radius});this.recalc();}, recalc:function recalc(){parent.recalc.call(this);this.moi = this.mass * this.geometry.radius * this.geometry.radius / 2;}};});Physics.body("compound", function(parent){var defaults={};return {init:function init(options){parent.init.call(this, options);this.mass = 0;this.moi = 0;this.children = [];this.geometry = Physics.geometry("compound");this.addChildren(options.children);}, connect:function connect(world){if(this.mass <= 0){throw "Can not add empty compound body to world.";}}, addChild:function addChild(body){this.addChildren([body]);return this;}, addChildren:function addChildren(bodies){var self=this, scratch=Physics.scratchpad(), com=scratch.vector().zero(), b, pos, i, l=bodies && bodies.length, M=0;if(!l){return scratch.done(this);}for(i = 0; i < l; i++) {b = bodies[i];if(b._world){b._world.remove(b);}this.children.push(b);this.geometry.addChild(b.geometry, new Physics.vector(b.offset).rotate(b.state.angular.pos).vadd(b.state.pos), b.state.angular.pos);pos = b.state.pos;com.add(pos._[0] * b.mass, pos._[1] * b.mass);M += b.mass;}this.mass += M;com.mult(1 / this.mass);this.offset.vsub(com);if(this._world){this._world.one("render", function(){self.view = null;});}this.recalc();return scratch.done(this);}, clear:function clear(){this._aabb = null;this.moi = 0;this.mass = 0;this.offset.zero();this.children = [];this.geometry.clear();return this;}, refreshGeometry:function refreshGeometry(){this.geometry.clear();for(var i=0, b, l=this.children.length; i < l; i++) {b = this.children[i];this.geometry.addChild(b.geometry, new Physics.vector(b.state.pos).vadd(b.offset), b.state.angular.pos);}return this;}, recalc:function recalc(){parent.recalc.call(this);var b, moi=0;for(var i=0, l=this.children.length; i < l; i++) {b = this.children[i];b.recalc();moi += b.moi + b.mass * b.state.pos.normSq();}this.moi = moi;return this;}};});Physics.body("convex-polygon", function(parent){var defaults={};return {init:function init(options){parent.init.call(this, options);options = Physics.util.extend({}, defaults, options);this.geometry = Physics.geometry("convex-polygon", {vertices:options.vertices});this.recalc();}, recalc:function recalc(){parent.recalc.call(this);this.moi = Physics.geometry.getPolygonMOI(this.geometry.vertices);}};});Physics.body("rectangle", function(parent){var defaults={};return {init:function init(options){parent.init.call(this, options);options = Physics.util.extend({}, defaults, options);this.geometry = Physics.geometry("rectangle", {width:options.width, height:options.height});this.recalc();}, recalc:function recalc(){var w=this.geometry.width;var h=this.geometry.height;parent.recalc.call(this);this.moi = (w * w + h * h) * this.mass / 12;}};});Physics.behavior("attractor", function(parent){var defaults={pos:null, strength:1, order:2, max:false, min:false};return {init:function init(options){var self=this;this._pos = new Physics.vector();parent.init.call(this);this.options.defaults(defaults);this.options.onChange(function(opts){self._maxDist = opts.max === false?Infinity:opts.max;self._minDist = opts.min?opts.min:10;self.position(opts.pos);});this.options(options);}, position:function position(pos){var self=this;if(pos){this._pos.clone(pos);return self;}return this._pos.values();}, behave:function behave(data){var bodies=this.getTargets(), body, order=this.options.order, strength=this.options.strength, minDist=this._minDist, maxDist=this._maxDist, scratch=Physics.scratchpad(), acc=scratch.vector(), norm, g;for(var j=0, l=bodies.length; j < l; j++) {body = bodies[j];acc.clone(this._pos);acc.vsub(body.state.pos);norm = acc.norm();if(norm > minDist && norm < maxDist){g = strength / Math.pow(norm, order);body.accelerate(acc.normalize().mult(g));}}scratch.done();}};});Physics.behavior("body-collision-detection", function(parent){var supportFnStack=[];var getSupportFn=function getSupportFn(bodyA, bodyB){var hash=Physics.util.pairHash(bodyA.uid, bodyB.uid), fn=supportFnStack[hash];if(!fn){fn = supportFnStack[hash] = function pairSupportFunction(searchDir){var tA=fn.tA, tB=fn.tB, vA=fn.tmpv1, vB=fn.tmpv2;if(fn.useCore){vA = bodyA.geometry.getFarthestCorePoint(searchDir.rotateInv(tA), vA, fn.marginA);vB = bodyB.geometry.getFarthestCorePoint(searchDir.rotate(tA).rotateInv(tB).negate(), vB, fn.marginB);}else {vA = bodyA.geometry.getFarthestHullPoint(searchDir.rotateInv(tA), vA);vB = bodyB.geometry.getFarthestHullPoint(searchDir.rotate(tA).rotateInv(tB).negate(), vB);}vA.vadd(bodyA.offset).transform(tA);vB.vadd(bodyB.offset).transform(tB);searchDir.negate().rotate(tB);return {a:vA.values(), b:vB.values(), pt:vA.vsub(vB).values()};};fn.tA = new Physics.transform();fn.tB = new Physics.transform();fn.tmpv1 = new Physics.vector();fn.tmpv2 = new Physics.vector();}fn.useCore = false;fn.margin = 0;fn.tA.setRotation(bodyA.state.angular.pos).setTranslation(bodyA.state.pos);fn.tB.setRotation(bodyB.state.angular.pos).setTranslation(bodyB.state.pos);fn.bodyA = bodyA;fn.bodyB = bodyB;return fn;};var checkGJK=function checkGJK(bodyA, bodyB){var scratch=Physics.scratchpad(), d=scratch.vector(), tmp=scratch.vector(), os=scratch.vector(), overlap, result, support, inc, collision=false, aabbA=bodyA.aabb(), dimA=Math.min(aabbA.hw, aabbA.hh), aabbB=bodyB.aabb(), dimB=Math.min(aabbB.hw, aabbB.hh);support = getSupportFn(bodyA, bodyB);d.clone(bodyA.state.pos).vadd(bodyA.getGlobalOffset(os)).vsub(bodyB.state.pos).vsub(bodyB.getGlobalOffset(os));result = Physics.gjk(support, d, true);if(result.overlap){collision = {bodyA:bodyA, bodyB:bodyB};inc = 0.01 * Math.min(dimA || 1, dimB || 1);support.useCore = true;support.marginA = 0;support.marginB = 0;while((result.overlap || result.distance === 0) && (support.marginA < dimA || support.marginB < dimB)) {if(support.marginA < dimA){support.marginA += inc;}if(support.marginB < dimB){support.marginB += inc;}result = Physics.gjk(support, d);}if(result.overlap || result.maxIterationsReached){return scratch.done(false);}overlap = support.marginA + support.marginB - result.distance;if(overlap <= 0){return scratch.done(false);}collision.overlap = overlap;collision.norm = d.clone(result.closest.b).vsub(tmp.clone(result.closest.a)).normalize().values();collision.mtv = d.mult(overlap).values();collision.pos = d.clone(collision.norm).mult(support.marginA).vadd(tmp.clone(result.closest.a)).vsub(bodyA.state.pos).values();}return scratch.done(collision);};var checkCircles=function checkCircles(bodyA, bodyB){var scratch=Physics.scratchpad(), d=scratch.vector(), tmp=scratch.vector(), overlap, collision=false;d.clone(bodyB.state.pos).vadd(bodyB.getGlobalOffset(tmp)).vsub(bodyA.state.pos).vsub(bodyA.getGlobalOffset(tmp));overlap = d.norm() - (bodyA.geometry.radius + bodyB.geometry.radius);if(d.equals(Physics.vector.zero)){d.set(1, 0);}if(overlap <= 0){collision = {bodyA:bodyA, bodyB:bodyB, norm:d.normalize().values(), mtv:d.mult(-overlap).values(), pos:d.mult(-bodyA.geometry.radius / overlap).vadd(tmp).values(), overlap:-overlap};}return scratch.done(collision);};var checkPair=function checkPair(bodyA, bodyB){if((bodyA.treatment === "static" || bodyA.treatment === "kinematic") && (bodyB.treatment === "static" || bodyB.treatment === "kinematic")){return false;}if(bodyA.geometry.name === "circle" && bodyB.geometry.name === "circle"){return checkCircles(bodyA, bodyB);}else if(bodyA.geometry.name === "compound" || bodyB.geometry.name === "compound"){var test=bodyA.geometry.name === "compound", compound=test?bodyA:bodyB, other=test?bodyB:bodyA, cols, ch, ret=[], scratch=Physics.scratchpad(), vec=scratch.vector(), oldPos=scratch.vector(), otherAABB=other.aabb(), i, l;for(i = 0, l = compound.children.length; i < l; i++) {ch = compound.children[i];oldPos.clone(ch.state.pos);ch.offset.vadd(oldPos.vadd(compound.offset).rotate(-ch.state.angular.pos));ch.state.pos.clone(compound.state.pos);ch.state.angular.pos += compound.state.angular.pos;if(Physics.aabb.overlap(otherAABB, ch.aabb())){cols = checkPair(other, ch);if(cols instanceof Array){for(var j=0, c, ll=cols.length; j < ll; j++) {c = cols[j];if(c.bodyA === ch){c.bodyA = compound;}else {c.bodyB = compound;}ret.push(c);}}else if(cols){if(cols.bodyA === ch){cols.bodyA = compound;}else {cols.bodyB = compound;}ret.push(cols);}}ch.state.angular.pos -= compound.state.angular.pos;ch.offset.vsub(oldPos);ch.state.pos.clone(oldPos.rotate(ch.state.angular.pos).vsub(compound.offset));}return scratch.done(ret);}else {return checkGJK(bodyA, bodyB);}};var defaults={check:"collisions:candidates", channel:"collisions:detected"};return {init:function init(options){parent.init.call(this);this.options.defaults(defaults);this.options(options);}, connect:function connect(world){if(this.options.check === true){world.on("integrate:velocities", this.checkAll, this);}else {world.on(this.options.check, this.check, this);}}, disconnect:function disconnect(world){if(this.options.check === true){world.off("integrate:velocities", this.checkAll, this);}else {world.off(this.options.check, this.check, this);}}, check:function check(data){var candidates=data.candidates, pair, targets=this.getTargets(), collisions=[], ret, prevContacts=this.prevContacts || {}, contactList={}, pairHash=Physics.util.pairHash, hash;for(var i=0, l=candidates.length; i < l; ++i) {pair = candidates[i];if(targets === this._world._bodies || Physics.util.indexOf(targets, pair.bodyA) > -1 && Physics.util.indexOf(targets, pair.bodyB) > -1){ret = checkPair(pair.bodyA, pair.bodyB);if(ret instanceof Array){for(var j=0, r, ll=ret.length; j < ll; j++) {r = ret[j];if(r){hash = pairHash(pair.bodyA.uid, pair.bodyB.uid);contactList[hash] = true;r.collidedPreviously = prevContacts[hash];collisions.push(r);}}}else if(ret){hash = pairHash(pair.bodyA.uid, pair.bodyB.uid);contactList[hash] = true;ret.collidedPreviously = prevContacts[hash];collisions.push(ret);}}}this.prevContacts = contactList;if(collisions.length){this._world.emit(this.options.channel, {collisions:collisions});}}, checkAll:function checkAll(data){var bodies=this.getTargets(), dt=data.dt, bodyA, bodyB, collisions=[], ret, prevContacts=this.prevContacts || {}, contactList={}, pairHash=Physics.util.pairHash, hash;for(var j=0, l=bodies.length; j < l; j++) {bodyA = bodies[j];for(var i=j + 1; i < l; i++) {bodyB = bodies[i];ret = checkPair(bodyA, bodyB);if(ret instanceof Array){for(var k=0, r, ll=ret.length; k < ll; k++) {r = ret[k];if(r){hash = pairHash(bodyA.uid, bodyB.uid);contactList[hash] = true;r.collidedPreviously = prevContacts[hash];collisions.push(r);}}}else if(ret){hash = pairHash(bodyA.uid, bodyB.uid);contactList[hash] = true;ret.collidedPreviously = prevContacts[hash];collisions.push(ret);}}}this.prevContacts = contactList;if(collisions.length){this._world.emit(this.options.channel, {collisions:collisions});}}};});Physics.behavior("body-impulse-response", function(parent){var defaults={check:"collisions:detected", mtvThreshold:1, bodyExtractDropoff:0.5, forceWakeupAboveOverlapThreshold:true};function getUid(b){return b.uid;}function clampMTV(totalV, mtv, into){var m, n;n = mtv.norm();m = n - totalV.proj(mtv);m = Math.max(0, Math.min(n, m));if(n === 0){into.zero();}else {into.clone(mtv).mult(m / n);}return into;}return {init:function init(options){parent.init.call(this);this.options.defaults(defaults);this.options(options);this._bodyList = [];}, applyTo:false, connect:function connect(world){world.on(this.options.check, this.respond, this);}, disconnect:function disconnect(world){world.off(this.options.check, this.respond, this);}, collideBodies:function collideBodies(bodyA, bodyB, normal, point, mtrans, contact){var fixedA=bodyA.treatment === "static" || bodyA.treatment === "kinematic", fixedB=bodyB.treatment === "static" || bodyB.treatment === "kinematic", scratch=Physics.scratchpad(), mtv=scratch.vector().clone(mtrans);if(fixedA && fixedB){scratch.done();return;}var invMoiA=fixedA?0:1 / bodyA.moi, invMoiB=fixedB?0:1 / bodyB.moi, invMassA=fixedA?0:1 / bodyA.mass, invMassB=fixedB?0:1 / bodyB.mass, cor=bodyA.restitution * bodyB.restitution, cof=bodyA.cof * bodyB.cof, n=scratch.vector().clone(normal), perp=scratch.vector().clone(n).perp(), tmp=scratch.vector(), rA=scratch.vector().clone(point), rB=scratch.vector().clone(point).vadd(bodyA.state.pos).vsub(bodyB.state.pos), angVelA=bodyA.state.angular.vel, angVelB=bodyB.state.angular.vel, vAB=scratch.vector().clone(bodyB.state.vel).vadd(tmp.clone(rB).perp().mult(angVelB)).vsub(bodyA.state.vel).vsub(tmp.clone(rA).perp().mult(angVelA)), rAproj=rA.proj(n), rAreg=rA.proj(perp), rBproj=rB.proj(n), rBreg=rB.proj(perp), vproj=vAB.proj(n), vreg=vAB.proj(perp), impulse, sign, max, ratio, inContact=contact;if(contact){if(fixedA){clampMTV(bodyB._mtvTotal, mtv, tmp);bodyB._mtvTotal.vadd(tmp);}else if(fixedB){clampMTV(bodyA._mtvTotal, mtv.negate(), tmp);bodyA._mtvTotal.vadd(tmp);mtv.negate();}else {ratio = 0.5;mtv.mult(ratio);clampMTV(bodyB._mtvTotal, mtv, tmp);bodyB._mtvTotal.vadd(tmp);mtv.clone(mtrans).mult(ratio - 1);clampMTV(bodyA._mtvTotal, mtv, tmp);bodyA._mtvTotal.vadd(tmp);}}if(vproj >= 0){scratch.done();return;}invMoiA = invMoiA === Infinity?0:invMoiA;invMoiB = invMoiB === Infinity?0:invMoiB;impulse = -((1 + cor) * vproj) / (invMassA + invMassB + invMoiA * rAreg * rAreg + invMoiB * rBreg * rBreg);if(fixedA){bodyB.state.vel.vadd(n.mult(impulse * invMassB));bodyB.state.angular.vel -= impulse * invMoiB * rBreg;}else if(fixedB){bodyA.state.vel.vsub(n.mult(impulse * invMassA));bodyA.state.angular.vel += impulse * invMoiA * rAreg;}else {bodyB.state.vel.vadd(n.mult(impulse * invMassB));bodyB.state.angular.vel -= impulse * invMoiB * rBreg;bodyA.state.vel.vsub(n.mult(invMassA * bodyB.mass));bodyA.state.angular.vel += impulse * invMoiA * rAreg;}if(cof && vreg){max = Math.abs(vreg) / (invMassA + invMassB + invMoiA * rAproj * rAproj + invMoiB * rBproj * rBproj);sign = vreg < 0?-1:1;impulse = cof * Math.abs(impulse);impulse = Math.min(impulse, max);impulse *= sign;if(fixedA){bodyB.state.vel.vsub(perp.mult(impulse * invMassB));bodyB.state.angular.vel -= impulse * invMoiB * rBproj;}else if(fixedB){bodyA.state.vel.vadd(perp.mult(impulse * invMassA));bodyA.state.angular.vel += impulse * invMoiA * rAproj;}else {bodyB.state.vel.vsub(perp.mult(impulse * invMassB));bodyB.state.angular.vel -= impulse * invMoiB * rBproj;bodyA.state.vel.vadd(perp.mult(invMassA * bodyB.mass));bodyA.state.angular.vel += impulse * invMoiA * rAproj;}}if(bodyA.sleep()){bodyA.sleepCheck();}if(bodyB.sleep()){bodyB.sleepCheck();}scratch.done();}, _pushUniq:function _pushUniq(body){var idx=Physics.util.sortedIndex(this._bodyList, body, getUid);if(this._bodyList[idx] !== body){this._bodyList.splice(idx, 0, body);}}, respond:function respond(data){var self=this, col, collisions=data.collisions, i, l, b;for(i = 0, l = collisions.length; i < l; ++i) {col = collisions[i];this._pushUniq(col.bodyA);this._pushUniq(col.bodyB);col.bodyA._mtvTotal = col.bodyA._mtvTotal || new Physics.vector();col.bodyB._mtvTotal = col.bodyB._mtvTotal || new Physics.vector();col.bodyA._oldmtvTotal = col.bodyA._oldmtvTotal || new Physics.vector();col.bodyB._oldmtvTotal = col.bodyB._oldmtvTotal || new Physics.vector();self.collideBodies(col.bodyA, col.bodyB, col.norm, col.pos, col.mtv, col.collidedPreviously);}for(i = 0, l = this._bodyList.length; i < l; ++i) {b = this._bodyList.pop();if(b._mtvTotal.normSq() < this.options.mtvThreshold){b._mtvTotal.mult(this.options.bodyExtractDropoff);}else if(this.options.forceWakeupAboveOverlapThreshold){b.sleep(false);}b.state.pos.vadd(b._mtvTotal);b.state.old.pos.vadd(b._mtvTotal);b._oldmtvTotal.swap(b._mtvTotal);b._mtvTotal.zero();}}};});Physics.behavior("constant-acceleration", function(parent){var defaults={acc:{x:0, y:0.0004}};return {init:function init(options){parent.init.call(this);this.options.defaults(defaults);this.options(options);this._acc = new Physics.vector();this.setAcceleration(this.options.acc);delete this.options.acc;}, setAcceleration:function setAcceleration(acc){this._acc.clone(acc);return this;}, behave:function behave(data){var bodies=this.getTargets();for(var i=0, l=bodies.length; i < l; ++i) {bodies[i].accelerate(this._acc);}}};});Physics.behavior("edge-collision-detection", function(parent){var checkGeneral=function checkGeneral(body, bounds, dummy){var overlap, aabb=body.aabb(), scratch=Physics.scratchpad(), offset=body.getGlobalOffset(scratch.vector()), trans=scratch.transform(), dir=scratch.vector(), result=scratch.vector(), collision=false, collisions=[];overlap = aabb.x + aabb.hw - bounds.max.x;if(overlap >= 0){dir.set(1, 0).rotateInv(trans.setRotation(body.state.angular.pos));collision = {bodyA:body, bodyB:dummy, overlap:overlap, norm:{x:1, y:0}, mtv:{x:overlap, y:0}, pos:body.geometry.getFarthestHullPoint(dir, result).rotate(trans).vadd(offset).values()};collisions.push(collision);}overlap = aabb.y + aabb.hh - bounds.max.y;if(overlap >= 0){dir.set(0, 1).rotateInv(trans.setRotation(body.state.angular.pos));collision = {bodyA:body, bodyB:dummy, overlap:overlap, norm:{x:0, y:1}, mtv:{x:0, y:overlap}, pos:body.geometry.getFarthestHullPoint(dir, result).rotate(trans).vadd(offset).values()};collisions.push(collision);}overlap = bounds.min.x - (aabb.x - aabb.hw);if(overlap >= 0){dir.set(-1, 0).rotateInv(trans.setRotation(body.state.angular.pos));collision = {bodyA:body, bodyB:dummy, overlap:overlap, norm:{x:-1, y:0}, mtv:{x:-overlap, y:0}, pos:body.geometry.getFarthestHullPoint(dir, result).rotate(trans).vadd(offset).values()};collisions.push(collision);}overlap = bounds.min.y - (aabb.y - aabb.hh);if(overlap >= 0){dir.set(0, -1).rotateInv(trans.setRotation(body.state.angular.pos));collision = {bodyA:body, bodyB:dummy, overlap:overlap, norm:{x:0, y:-1}, mtv:{x:0, y:-overlap}, pos:body.geometry.getFarthestHullPoint(dir, result).rotate(trans).vadd(offset).values()};collisions.push(collision);}scratch.done();return collisions;};var checkEdgeCollide=function checkEdgeCollide(body, bounds, dummy){return checkGeneral(body, bounds, dummy);};var defaults={aabb:null, restitution:0.99, cof:1, channel:"collisions:detected"};return {init:function init(options){parent.init.call(this);this.options.defaults(defaults);this.options(options);this.setAABB(this.options.aabb);this.restitution = this.options.restitution;this.body = Physics.body("point", {treatment:"static", restitution:this.options.restitution, cof:this.options.cof});}, setAABB:function setAABB(aabb){if(!aabb){throw "Error: aabb not set";}this._edges = {min:{x:aabb.x - aabb.hw, y:aabb.y - aabb.hh}, max:{x:aabb.x + aabb.hw, y:aabb.y + aabb.hh}};return this;}, connect:function connect(world){world.on("integrate:positions", this.checkAll, this, 2);}, disconnect:function disconnect(world){world.off("integrate:positions", this.checkAll, this, 2);}, checkAll:function checkAll(data){var bodies=this.getTargets(), dt=data.dt, body, collisions=[], ret, bounds=this._edges, dummy=this.body, prevContacts=this.prevContacts || {}, contactList={}, pairHash=Physics.util.pairHash, hash;for(var i=0, l=bodies.length; i < l; i++) {body = bodies[i];if(body.treatment === "dynamic"){ret = checkEdgeCollide(body, bounds, dummy);if(ret){hash = pairHash(body.uid, dummy.uid);for(var j=0, ll=ret.length; j < ll; j++) {contactList[hash] = true;ret[j].collidedPreviously = prevContacts[hash];}collisions.push.apply(collisions, ret);}}}this.prevContacts = contactList;if(collisions.length){this._world.emit(this.options.channel, {collisions:collisions});}}};});Physics.behavior("interactive", function(parent){if(!document){return {};}var defaults={el:null, moveThrottle:1000 / 100 | 0, minVel:{x:-5, y:-5}, maxVel:{x:5, y:5}}, getElementOffset=function getElementOffset(el){var curleft=0, curtop=0;if(el.offsetParent){do{curleft += el.offsetLeft;curtop += el.offsetTop;}while(el = el.offsetParent);}return {left:curleft, top:curtop};};return {init:function init(options){var self=this;parent.init.call(this);this.options.defaults(defaults);this.options(options);this.bodyData = {};this.bodyDataByUID = {};this.el = typeof this.options.el === "string"?document.getElementById(this.options.el):this.options.el;if(!this.el){throw "No DOM element specified";}self.grab = function grab(e){var pos, body, touchId, touch, offset, data, touchIndex, l;if(self._world){if(!e.changedTouches){e.changedTouches = [e];}offset = getElementOffset(e.target);for(touchIndex = 0, l = e.changedTouches.length; touchIndex < l; touchIndex++) {touch = e.changedTouches[touchIndex];touchId = touch.identifier || touch.pointerId || "mouse";pos = {idx:touchId, x:touch.pageX - offset.left, y:touch.pageY - offset.top};body = self._world.findOne({$at:new Physics.vector(pos), $in:self.getTargets()});if(body){body.state.vel.zero();body.state.angular.vel = 0;body.isGrabbed = true;data = self.bodyData[touchId] || {};data.body = body;body.sleep(false);data.time = Physics.util.ticker.now();data.treatment = self.bodyDataByUID[body.uid]?self.bodyDataByUID[body.uid].treatment:body.treatment;body.treatment = "kinematic";data.pos = data.pos || new Physics.vector();data.pos.clone(pos);data.offset = data.offset || new Physics.vector();data.offset.clone(pos).vsub(body.state.pos);data.oldPos = data.oldPos || new Physics.vector();data.oldPos.clone(pos);pos.body = body;self.bodyData[touchId] = data;self.bodyDataByUID[body.uid] = data;self._world.emit("interact:grab", pos);}else {self._world.emit("interact:poke", pos);}}}};self.move = Physics.util.throttle(function move(e){var pos, state, body, touchId, touch, offset, data, touchIndex, l;if(self._world){if(!e.changedTouches){e.changedTouches = [e];}offset = getElementOffset(self.el);for(touchIndex = 0, l = e.changedTouches.length; touchIndex < l; touchIndex++) {touch = e.changedTouches[touchIndex];touchId = touch.identifier || touch.pointerId || "mouse";pos = {idx:touchId, x:touch.pageX - offset.left, y:touch.pageY - offset.top};data = self.bodyData[touchId];if(data){body = data.body;body.sleep(false);data.time = Physics.util.ticker.now();data.oldPos.clone(data.pos);data.pos.clone(pos);pos.body = body;}self._world.emit("interact:move", pos);}}}, self.options.moveThrottle);self.release = function release(e){var pos, body, touchId, touch, offset, data, dt, touchIndex, l;if(self._world){if(!e.changedTouches){e.changedTouches = [e];}for(touchIndex = 0, l = e.changedTouches.length; touchIndex < l; touchIndex++) {offset = getElementOffset(self.el);touch = e.changedTouches[touchIndex];touchId = touch.identifier || touch.pointerId || "mouse";pos = {idx:touchId, x:touch.pageX - offset.left, y:touch.pageY - offset.top};data = self.bodyData[touchId];if(data){body = data.body;body.sleep(false);data.pos.clone(pos);dt = Math.max(Physics.util.ticker.now() - data.time, self.options.moveThrottle);body.treatment = data.treatment;body.state.vel.clone(data.pos).vsub(data.oldPos).mult(1 / dt);body.state.vel.clamp(self.options.minVel, self.options.maxVel);body.isGrabbed = false;pos.body = body;delete body.isGrabbed;}self._world.emit("interact:release", pos);delete self.bodyData[touchId];}}};}, connect:function connect(world){world.on("integrate:positions", this.behave, this);if(window.PointerEvent){this.el.addEventListener("pointerdown", this.grab);window.addEventListener("pointermove", this.move);window.addEventListener("pointerup", this.release);}else {this.el.addEventListener("mousedown", this.grab);this.el.addEventListener("touchstart", this.grab);window.addEventListener("mousemove", this.move);window.addEventListener("touchmove", this.move);window.addEventListener("mouseup", this.release);window.addEventListener("touchend", this.release);}}, disconnect:function disconnect(world){world.off("integrate:positions", this.behave, this);if(window.PointerEvent){this.el.removeEventListener("pointerdown", this.grab);window.removeEventListener("pointermove", this.move);window.removeEventListener("pointerup", this.release);}else {this.el.removeEventListener("mousedown", this.grab);this.el.removeEventListener("touchstart", this.grab);window.removeEventListener("mousemove", this.move);window.removeEventListener("touchmove", this.move);window.removeEventListener("mouseup", this.release);window.removeEventListener("touchend", this.release);}}, behave:function behave(data){var self=this, state, dt=Math.max(data.dt, self.options.moveThrottle), body, d;for(var touchId in self.bodyData) {d = self.bodyData[touchId];body = d.body;state = body.state;state.vel.clone(d.pos).vsub(d.offset).vsub(state.pos).mult(1 / dt);}}};});Physics.behavior("newtonian", function(parent){var defaults={strength:1, max:false, min:false};return {init:function init(options){var self=this;parent.init.call(this);this.options.defaults(defaults);this.options.onChange(function(opts){self._maxDistSq = opts.max === false?Infinity:opts.max * opts.max;self._minDistSq = opts.min?opts.min * opts.min:100 * opts.strength;});this.options(options);}, calcPotential:function calcPotential(posA, posB, out){var strength=this.options.strength, minDistSq=this._minDistSq, maxDistSq=this._maxDistSq, normsq, g, pos;pos = out || new Physics.vector();pos.clone(posB).vsub(posA);normsq = pos.normSq();if(normsq > minDistSq && normsq < maxDistSq){g = strength / normsq;return pos.normalize().mult(g);}return pos.zero();}, behave:function behave(data){var bodies=this.getTargets(), body, other, scratch=Physics.scratchpad(), potential=scratch.vector(), comp, bodyA, bodyB, posA=scratch.vector(), posB=scratch.vector(), i, j, k, m, l, ll, lll;for(j = 0, l = bodies.length; j < l; j++) {body = bodies[j];for(i = j + 1; i < l; i++) {other = bodies[i];if(body.name === "compound"){comp = body;}else if(other.name === "compound"){comp = other;other = body;}if(comp){if(other.name === "compound"){for(k = 0, ll = comp.children.length; k < ll; k++) {bodyA = comp.children[k];comp.toWorldCoords(posA.clone(bodyA.state.pos).vadd(comp.offset));for(m = 0, lll = other.children.length; m < lll; m++) {bodyB = other.children[m];other.toWorldCoords(posB.clone(bodyB.state.pos).vadd(other.offset));this.calcPotential(posA, posB, potential);comp.accelerate(potential.mult(bodyB.mass));other.accelerate(potential.mult(bodyA.mass / bodyB.mass).negate());}}}else {for(k = 0, ll = comp.children.length; k < ll; k++) {bodyA = comp.children[k];comp.toWorldCoords(posA.clone(bodyA.state.pos).vadd(comp.offset));this.calcPotential(posA, other.state.pos, potential);comp.accelerate(potential.mult(other.mass));other.accelerate(potential.mult(bodyA.mass / other.mass).negate());}}}else {this.calcPotential(body.state.pos, other.state.pos, potential);body.accelerate(potential.mult(other.mass));other.accelerate(potential.mult(body.mass / other.mass).negate());}comp = null;}}scratch.done();}};});Physics.behavior("sweep-prune", function(parent){var uid=1;var getUniqueId=function getUniqueId(){return uid++;};var dof={x:0, y:1};var maxDof=2;var pairHash=Physics.util.pairHash;return {init:function init(options){parent.init.call(this);this.options.defaults({channel:"collisions:candidates"});this.options(options);this.encounters = [];this.candidates = [];this.clear();}, clear:function clear(){this.tracked = [];this.pairs = [];this.intervalLists = [];for(var xyz=0; xyz < maxDof; ++xyz) {this.intervalLists[xyz] = [];}}, connect:function connect(world){world.on("add:body", this.trackBody, this);world.on("remove:body", this.untrackBody, this);world.on("integrate:positions", this.sweep, this, 1);var bodies=world.getBodies();for(var i=0, l=bodies.length; i < l; ++i) {this.trackBody({body:bodies[i]});}}, disconnect:function disconnect(world){world.off("add:body", this.trackBody, this);world.off("remove:body", this.untrackBody, this);world.off("integrate:positions", this.sweep, this, 1);this.clear();}, broadPhase:function broadPhase(){this.updateIntervals();this.sortIntervalLists();if(this._world){this._world.emit("sweep-prune:intervals", this.intervalLists);}return this.checkOverlaps();}, sortIntervalLists:function sortIntervalLists(){var list, len, i, hole, bound, boundVal, left, leftVal, axis;for(var xyz=0; xyz < maxDof; ++xyz) {list = this.intervalLists[xyz];i = 0;len = list.length;axis = xyz;while(++i < len) {bound = list[i];boundVal = bound.val.get(axis);hole = i;left = list[hole - 1];leftVal = left && left.val.get(axis);while(hole > 0 && (leftVal > boundVal || leftVal === boundVal && (left.type && !bound.type))) {list[hole] = left;hole--;left = list[hole - 1];leftVal = left && left.val.get(axis);}list[hole] = bound;}}}, getPair:function getPair(tr1, tr2, doCreate){var hash=pairHash(tr1.id, tr2.id);if(hash === false){return null;}var c=this.pairs[hash];if(!c){if(!doCreate){return null;}c = this.pairs[hash] = {bodyA:tr1.body, bodyB:tr2.body, flag:1};}if(doCreate){c.flag = 1;}return c;}, checkOverlaps:function checkOverlaps(){var isX, hash, tr1, tr2, bound, list, len, i, j, c, collisionFlag=1 << dof.z + 1 << dof.y + 1 << dof.x + 1, encounters=this.encounters, enclen=0, candidates=this.candidates;Physics.util.clearArray(encounters);Physics.util.clearArray(candidates);for(var xyz=0; xyz < maxDof; ++xyz) {isX = xyz === 0;list = this.intervalLists[xyz];for(i = 0, len = list.length; i < len; i++) {bound = list[i];tr1 = bound.tracker;if(bound.type){j = enclen;for(j = enclen - 1; j >= 0; j--) {tr2 = encounters[j];if(tr2 === tr1){if(j < enclen - 1){encounters[j] = encounters.pop();}else {encounters.pop();}enclen--;}else {c = this.getPair(tr1, tr2, isX);if(c && c.flag < collisionFlag){c.flag = c.flag << xyz + 1;if(c.flag === collisionFlag){candidates.push(c);}}}}}else {enclen = encounters.push(tr1);}}}return candidates;}, updateIntervals:function updateIntervals(){var tr, intr, aabb, list=this.tracked, i=list.length;while(--i >= 0) {tr = list[i];intr = tr.interval;aabb = tr.body.aabb();intr.min.val.clone(aabb).sub(aabb.hw, aabb.hh);intr.max.val.clone(aabb).add(aabb.hw, aabb.hh);}}, trackBody:function trackBody(data){var body=data.body, tracker={id:getUniqueId(), body:body}, intr={min:{type:false, val:new Physics.vector(), tracker:tracker}, max:{type:true, val:new Physics.vector(), tracker:tracker}};tracker.interval = intr;this.tracked.push(tracker);for(var xyz=0; xyz < maxDof; ++xyz) {this.intervalLists[xyz].push(intr.min, intr.max);}}, untrackBody:function untrackBody(data){var body=data.body, list, minmax, trackedList=this.tracked, tracker, count;for(var i=0, l=trackedList.length; i < l; ++i) {tracker = trackedList[i];if(tracker.body === body){trackedList.splice(i, 1);for(var xyz=0; xyz < maxDof; ++xyz) {count = 0;list = this.intervalLists[xyz];for(var j=0, m=list.length; j < m; ++j) {minmax = list[j];if(minmax === tracker.interval.min || minmax === tracker.interval.max){list.splice(j, 1);j--;l--;if(count > 0){break;}count++;}}}break;}}}, sweep:function sweep(data){var self=this, candidates;candidates = self.broadPhase();if(candidates.length){this._world.emit(this.options.channel, {candidates:candidates});}}};});Physics.behavior("verlet-constraints", function(parent){var TWOPI=2 * Math.PI;var defaults={iterations:2};return {init:function init(options){parent.init.call(this);this.options.defaults(defaults);this.options(options);this._distanceConstraints = [];this._angleConstraints = [];}, connect:function connect(world){var intg=world.integrator();if(intg && intg.name.indexOf("verlet") < 0){throw "The rigid constraint manager needs a world with a \"verlet\" compatible integrator.";}world.on("integrate:positions", this.resolve, this);}, disconnect:function disconnect(world){world.off("integrate:positions", this.resolve, this);}, drop:function drop(){this._distanceConstraints = [];this._angleConstraints = [];return this;}, distanceConstraint:function distanceConstraint(bodyA, bodyB, stiffness, targetLength){var cst;if(!bodyA || !bodyB){return false;}cst = {id:Physics.util.uniqueId("dis-constraint"), type:"dis", bodyA:bodyA, bodyB:bodyB, stiffness:stiffness || 0.5, targetLength:targetLength || bodyB.state.pos.dist(bodyA.state.pos)};cst.targetLengthSq = cst.targetLength * cst.targetLength;this._distanceConstraints.push(cst);return cst;}, angleConstraint:function angleConstraint(bodyA, bodyB, bodyC, stiffness, targetAngle){var cst;if(!bodyA || !bodyB){return false;}cst = {id:Physics.util.uniqueId("ang-constraint"), type:"ang", bodyA:bodyA, bodyB:bodyB, bodyC:bodyC, stiffness:stiffness || 0.5, targetAngle:targetAngle || bodyB.state.pos.angle2(bodyA.state.pos, bodyC.state.pos)};this._angleConstraints.push(cst);return cst;}, remove:function remove(cstrOrId){var constraints, type, isObj, i, l;isObj = Physics.util.isObject(cstrOrId);type = isObj?cstrOrId.type:cstrOrId.substr(0, 3);constraints = type === "ang"?this._angleConstraints:this._distanceConstraints;if(isObj){for(i = 0, l = constraints.length; i < l; ++i) {if(constraints[i] === cstrOrId){constraints.splice(i, 1);return this;}}}else {for(i = 0, l = constraints.length; i < l; ++i) {if(constraints[i].id === cstrOrId){constraints.splice(i, 1);return this;}}}return this;}, resolveAngleConstraints:function resolveAngleConstraints(coef){var constraints=this._angleConstraints, scratch=Physics.scratchpad(), trans=scratch.transform(), con, ang, corr, proportion, invMassSum;for(var i=0, l=constraints.length; i < l; ++i) {con = constraints[i];ang = con.bodyB.state.pos.angle2(con.bodyA.state.pos, con.bodyC.state.pos);corr = ang - con.targetAngle;if(!corr){continue;}else if(corr <= -Math.PI){corr += TWOPI;}else if(corr >= Math.PI){corr -= TWOPI;}trans.setTranslation(con.bodyB.state.pos);corr *= -coef * con.stiffness;if(con.bodyA.treatment === "dynamic" && con.bodyB.treatment === "dynamic" && con.bodyC.treatment === "dynamic"){invMassSum = 1 / (con.bodyA.mass + con.bodyB.mass + con.bodyC.mass);}if(con.bodyA.treatment === "dynamic"){if(con.bodyB.treatment === "dynamic" && con.bodyC.treatment === "dynamic"){ang = corr * (con.bodyB.mass + con.bodyC.mass) * invMassSum;}else if(con.bodyB.treatment !== "dynamic"){ang = corr * con.bodyC.mass / (con.bodyC.mass + con.bodyA.mass);}else {ang = corr * con.bodyB.mass / (con.bodyB.mass + con.bodyA.mass);}trans.setRotation(ang);con.bodyA.state.pos.translateInv(trans);con.bodyA.state.pos.rotate(trans);con.bodyA.state.pos.translate(trans);}if(con.bodyC.treatment === "dynamic"){if(con.bodyA.treatment === "dynamic" && con.bodyB.treatment === "dynamic"){ang = -corr * (con.bodyB.mass + con.bodyA.mass) * invMassSum;}else if(con.bodyB.treatment !== "dynamic"){ang = -corr * con.bodyA.mass / (con.bodyC.mass + con.bodyA.mass);}else {ang = -corr * con.bodyB.mass / (con.bodyB.mass + con.bodyC.mass);}trans.setRotation(ang);con.bodyC.state.pos.translateInv(trans);con.bodyC.state.pos.rotate(trans);con.bodyC.state.pos.translate(trans);}if(con.bodyB.treatment === "dynamic"){if(con.bodyA.treatment === "dynamic" && con.bodyC.treatment === "dynamic"){ang = corr * (con.bodyA.mass + con.bodyC.mass) * invMassSum;}else if(con.bodyA.treatment !== "dynamic"){ang = corr * con.bodyC.mass / (con.bodyC.mass + con.bodyB.mass);}else {ang = corr * con.bodyA.mass / (con.bodyA.mass + con.bodyC.mass);}trans.setRotation(ang).setTranslation(con.bodyA.state.pos);con.bodyB.state.pos.translateInv(trans);con.bodyB.state.pos.rotate(trans);con.bodyB.state.pos.translate(trans);trans.setTranslation(con.bodyC.state.pos);con.bodyB.state.pos.translateInv(trans);con.bodyB.state.pos.rotateInv(trans);con.bodyB.state.pos.translate(trans);}con.bodyA.sleepCheck();con.bodyB.sleepCheck();con.bodyC.sleepCheck();}scratch.done();}, resolveDistanceConstraints:function resolveDistanceConstraints(coef){var constraints=this._distanceConstraints, scratch=Physics.scratchpad(), BA=scratch.vector(), con, len, corr, proportion;for(var i=0, l=constraints.length; i < l; ++i) {con = constraints[i];BA.clone(con.bodyB.state.pos).vsub(con.bodyA.state.pos);len = BA.normSq() || Math.random() * 0.0001;corr = coef * con.stiffness * (len - con.targetLengthSq) / len;BA.mult(corr);proportion = con.bodyA.treatment !== "dynamic" || con.bodyB.treatment !== "dynamic"?1:con.bodyB.mass / (con.bodyA.mass + con.bodyB.mass);if(con.bodyA.treatment === "dynamic"){if(con.bodyB.treatment === "dynamic"){BA.mult(proportion);}con.bodyA.state.pos.vadd(BA);if(con.bodyB.treatment === "dynamic"){BA.mult(1 / proportion);}}if(con.bodyB.treatment === "dynamic"){if(con.bodyA.treatment === "dynamic"){BA.mult(1 - proportion);}con.bodyB.state.pos.vsub(BA);}con.bodyA.sleepCheck();con.bodyB.sleepCheck();}scratch.done();}, shuffleConstraints:function shuffleConstraints(){this._distanceConstraints = Physics.util.shuffle(this._distanceConstraints);this._angleConstraints = Physics.util.shuffle(this._angleConstraints);}, resolve:function resolve(){var its=this.options.iterations, coef=1 / its;for(var i=0; i < its; i++) {this.resolveDistanceConstraints(coef);this.resolveAngleConstraints(coef);}}, getConstraints:function getConstraints(){return {distanceConstraints:[].concat(this._distanceConstraints), angleConstraints:[].concat(this._angleConstraints)};}};});Physics.integrator("improved-euler", function(parent){return {init:function init(options){parent.init.call(this, options);}, integrateVelocities:function integrateVelocities(bodies, dt){var drag=1 - this.options.drag, body=null, state;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep(dt)){state.old.vel.clone(state.vel);state.old.acc.clone(state.acc);state.vel.vadd(state.acc.mult(dt));if(drag){state.vel.mult(drag);}state.acc.zero();state.old.angular.vel = state.angular.vel;state.angular.vel += state.angular.acc * dt;state.angular.acc = 0;}else {state.vel.zero();state.acc.zero();state.angular.vel = 0;state.angular.acc = 0;}}}, integratePositions:function integratePositions(bodies, dt){var halfdtdt=0.5 * dt * dt, body=null, state, scratch=Physics.scratchpad(), vel=scratch.vector(), angVel;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep()){state.old.pos.clone(state.pos);vel.clone(state.old.vel);state.pos.vadd(vel.mult(dt)).vadd(state.old.acc.mult(halfdtdt));state.old.acc.zero();state.old.angular.pos = state.angular.pos;state.angular.pos += state.old.angular.vel * dt + state.old.angular.acc * halfdtdt;state.old.angular.acc = 0;}}scratch.done();}};});Physics.integrator("velocity-verlet-alt", function(parent){Physics.body.mixin({started:function started(val){if(val !== undefined){this._started = true;}return !!this._started;}});return {init:function init(options){parent.init.call(this, options);}, integrateVelocities:function integrateVelocities(bodies, dt){var dtdt=dt * dt, drag=1 - this.options.drag, body=null, state;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static"){if(!body.started()){state.old.acc.clone(state.acc);state.old.acc.mult(dt);state.old.vel.clone(state.vel).vsub(state.old.acc);state.old.acc.mult(1 / dt);}if(drag){state.vel.mult(drag);}state.vel.vadd(state.old.acc.vadd(state.acc).mult(0.5 * dt));if(!body.started()){state.old.angular.acc = state.angular.acc;state.old.angular.vel = state.angular.vel - state.old.angular.acc * dt;}state.angular.vel += 0.5 * (state.angular.acc + state.old.angular.acc) * dt;state.angular.acc = 0;body.started(true);}else {state.vel.zero();state.acc.zero();state.angular.vel = 0;state.angular.acc = 0;}}}, integratePositions:function integratePositions(bodies, dt){var dtdt=dt * dt, body=null, state;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static"){state.old.pos.clone(state.pos);state.old.vel.mult(dt);state.old.acc.mult(0.5 * dtdt);state.pos.vadd(state.old.vel).vadd(state.old.acc);state.old.vel.clone(state.vel);state.old.acc.clone(state.acc);state.acc.zero();state.old.angular.pos = state.angular.pos;state.angular.pos += state.angular.vel * dt + 0.5 * state.old.angular.acc * dtdt;state.old.angular.vel = state.angular.vel;state.old.angular.acc = state.angular.acc;state.angular.acc = 0;}}}};});Physics.integrator("velocity-verlet", function(parent){Physics.body.mixin({started:function started(val){if(val !== undefined){this._started = true;}return !!this._started;}});return {init:function init(options){parent.init.call(this, options);}, integrate:function integrate(bodies, dt){var world=this._world;this.integratePositions(bodies, dt);if(world){world.emit("integrate:positions", {bodies:bodies, dt:dt});}this.integrateVelocities(bodies, dt);if(world){world.emit("integrate:velocities", {bodies:bodies, dt:dt});}return this;}, integrateVelocities:function integrateVelocities(bodies, dt){var dtdt=dt * dt, drag=1 - this.options.drag, body=null, state;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep()){if(drag){state.vel.mult(drag);}state.old.vel.clone(state.vel);state.vel.vadd(state.old.acc.vadd(state.acc).mult(0.5 * dt));state.old.acc.clone(state.acc);state.acc.zero();state.old.angular.vel = state.angular.vel;state.old.angular.acc = state.angular.acc;state.angular.vel += 0.5 * (state.angular.acc + state.old.angular.acc) * dt;state.angular.acc = 0;body.started(true);}else {state.vel.zero();state.acc.zero();state.angular.vel = 0;state.angular.acc = 0;}}}, integratePositions:function integratePositions(bodies, dt){var dtdt=dt * dt, body=null, state;for(var i=0, l=bodies.length; i < l; ++i) {body = bodies[i];state = body.state;if(body.treatment !== "static" && !body.sleep(dt)){if(!body.started()){state.old.acc.clone(state.acc);state.old.acc.mult(dt);state.old.vel.clone(state.vel).vsub(state.old.acc);state.old.acc.mult(1 / dt);}state.old.pos.clone(state.pos);state.old.vel.mult(dt);state.old.acc.mult(0.5 * dtdt);state.pos.vadd(state.old.vel).vadd(state.old.acc);state.old.vel.mult(1 / dt);state.old.acc.mult(2 / dtdt);if(!body.started()){state.old.angular.acc = state.angular.acc;state.old.angular.vel = state.angular.vel - state.old.angular.acc * dt;}state.old.angular.pos = state.angular.pos;state.angular.pos += state.angular.vel * dt + 0.5 * state.old.angular.acc * dtdt;}}}};});Physics.renderer("canvas", function(proto){if(!document){return {};}var Pi2=Math.PI * 2, newEl=function newEl(node, content){var el=document.createElement(node || "div");if(content){el.innerHTML = content;}return el;}, colors={white:"#fff", violet:"#542437", blue:"#53777A"};var defaults={metaEl:null, styles:{point:colors.blue, circle:{strokeStyle:colors.blue, lineWidth:1, fillStyle:colors.blue, angleIndicator:colors.white}, rectangle:{strokeStyle:colors.violet, lineWidth:1, fillStyle:colors.violet, angleIndicator:colors.white}, "convex-polygon":{strokeStyle:colors.violet, lineWidth:1, fillStyle:colors.violet, angleIndicator:colors.white}}, offset:{x:0, y:0}};return {init:function init(options){var self=this;proto.init.call(this, options);this.options.defaults(defaults, true);this.options.onChange(function(){self.options.offset = new Physics.vector(self.options.offset);});this.options(options, true);this.hiddenCanvas = document.createElement("canvas");this.hiddenCanvas.width = this.hiddenCanvas.height = 100;if(!this.hiddenCanvas.getContext){throw "Canvas not supported";}this.hiddenCtx = this.hiddenCanvas.getContext("2d");var viewport=this.el;if(viewport.nodeName.toUpperCase() !== "CANVAS"){viewport = document.createElement("canvas");this.el.appendChild(viewport);if(typeof this.options.el === "string" && this.el === document.body){viewport.id = this.options.el;}this.el = viewport;}this.container = this.el.parentNode;this.ctx = viewport.getContext("2d");this.els = {};if(this.options.meta){var stats=this.options.metaEl || newEl();stats.className = "pjs-meta";this.els.fps = newEl("span");this.els.ipf = newEl("span");stats.appendChild(newEl("span", "fps: "));stats.appendChild(this.els.fps);stats.appendChild(newEl("br"));stats.appendChild(newEl("span", "ipf: "));stats.appendChild(this.els.ipf);viewport.parentNode.insertBefore(stats, viewport);}this._layers = {};this.addLayer("main", this.el);if(this.options.autoResize){this.resize();}else {this.resize(this.options.width, this.options.height);}}, layer:function layer(id){if(id in this._layers){return this._layers[id];}return null;}, addLayer:function addLayer(id, el, opts){var self=this, bodies=[], styles=Physics.util.extend({}, this.options.styles), layer={id:id, el:el || document.createElement("canvas"), options:Physics.util.options({width:this.el.width, height:this.el.height, manual:false, autoResize:true, follow:null, offset:null, scale:1, zIndex:1})(opts)};if(id in this._layers){throw "Layer \"" + id + "\" already added.";}this.el.parentNode.insertBefore(layer.el, this.el);layer.el.style.position = "absolute";layer.el.style.zIndex = layer.options.zIndex;layer.el.className += " pjs-layer-" + layer.id;layer.ctx = layer.el.getContext("2d");layer.ctx.scale(1, 1);layer.el.width = layer.options.width;layer.el.height = layer.options.height;layer.bodies = bodies;layer.reset = function(arr){bodies = arr || [];return layer;};layer.addToStack = function(thing){if(Physics.util.isArray(thing)){bodies.push.apply(bodies, thing);}else {bodies.push(thing);}return layer;};layer.removeFromStack = function(thing){var i, l;if(Physics.util.isArray(thing)){for(i = 0, l = thing.length; i < l; ++i) {layer.removeFromStack(thing[i]);}}else {i = Physics.util.indexOf(bodies, thing);if(i > -1){bodies.splice(i, 1);}}return layer;};layer.render = function(clear){var body, scratch=Physics.scratchpad(), offset=scratch.vector().set(0, 0), scale=layer.options.scale, view, i, l=bodies.length, t=self._interpolateTime, stack=l || layer.id !== "main"?bodies:self._world._bodies;if(layer.options.manual){scratch.done();return layer;}if(layer.options.offset){if(layer.options.offset === "center"){offset.add(layer.el.width * 0.5, layer.el.height * 0.5).mult(1 / scale);}else {offset.vadd(layer.options.offset).mult(1 / scale);}}if(layer.options.follow){offset.vsub(layer.options.follow.state.pos);offset.sub(layer.options.follow.state.vel.get(0) * t, layer.options.follow.state.vel.get(1) * t);}if(clear !== false){layer.ctx.clearRect(0, 0, layer.el.width, layer.el.height);}if(scale !== 1){layer.ctx.save();layer.ctx.scale(scale, scale);}for(i = 0, l = stack.length; i < l; ++i) {body = stack[i];if(!body.hidden){view = body.view || (body.view = self.createView(body.geometry, body.styles || styles[body.geometry.name]));self.drawBody(body, body.view, layer.ctx, offset);}}if(scale !== 1){layer.ctx.restore();}scratch.done();return layer;};this._layers[id] = layer;return layer;}, removeLayer:function removeLayer(idOrLayer){var id=idOrLayer.id?idOrLayer.id:idOrLayer, el=this._layers[id].el;if(el !== this.el){el.parentNode.removeChild(el);}delete this._layers[id];return this;}, resize:function resize(width, height){var layer;proto.resize.call(this, width, height);for(var id in this._layers) {layer = this._layers[id];if(layer.options.autoResize){layer.el.width = this.width;layer.el.height = this.height;}}return this;}, setStyle:function setStyle(styles, ctx){ctx = ctx || this.ctx;if(Physics.util.isObject(styles)){styles.strokeStyle = styles.lineWidth?styles.strokeStyle:"rgba(0,0,0,0)";Physics.util.extend(ctx, styles);}else {ctx.fillStyle = ctx.strokeStyle = styles;ctx.lineWidth = 1;}}, drawCircle:function drawCircle(x, y, r, styles, ctx){ctx = ctx || this.ctx;ctx.beginPath();this.setStyle(styles, ctx);ctx.arc(x, y, r, 0, Pi2, false);ctx.closePath();ctx.stroke();ctx.fill();}, drawPolygon:function drawPolygon(verts, styles, ctx){var vert=verts[0], x=vert.x, y=vert.y, l=verts.length;ctx = ctx || this.ctx;ctx.beginPath();this.setStyle(styles, ctx);ctx.moveTo(x, y);for(var i=1; i < l; ++i) {vert = verts[i];x = vert.x;y = vert.y;ctx.lineTo(x, y);}if(l > 2){ctx.closePath();}ctx.stroke();ctx.fill();}, drawRect:function drawRect(x, y, width, height, styles, ctx){var hw=width * 0.5, hh=height * 0.5;ctx = ctx || this.ctx;this.setStyle(styles, ctx);ctx.beginPath();ctx.rect(x - hw, y - hh, width, height);ctx.closePath();ctx.stroke();ctx.fill();}, drawLine:function drawLine(from, to, styles, ctx){var x=from.x, y=from.y;ctx = ctx || this.ctx;ctx.beginPath();this.setStyle(styles, ctx);ctx.moveTo(x, y);x = to.x;y = to.y;ctx.lineTo(x, y);ctx.stroke();ctx.fill();}, draw:function draw(geometry, styles, ctx, offset){var name=geometry.name, x=+(offset && offset.x), y=+(offset && offset.y), w=geometry.aabb().hw;ctx = ctx || this.ctx;styles = styles || this.options.styles[name] || this.options.styles.circle || {};ctx.save();ctx.translate(x, y);if(name === "circle"){this.drawCircle(0, 0, geometry.radius, styles, ctx);}else if(name === "convex-polygon"){this.drawPolygon(geometry.vertices, styles, ctx);}else if(name === "rectangle"){this.drawRect(0, 0, geometry.width, geometry.height, styles, ctx);}else if(name === "compound"){for(var i=0, l=geometry.children.length, ch; i < l; i++) {ch = geometry.children[i];ctx.translate(ch.pos.x, ch.pos.y);ctx.rotate(ch.angle);this.draw(ch.g, styles, ctx);ctx.rotate(-ch.angle);ctx.translate(-ch.pos.x, -ch.pos.y);}}else {this.drawCircle(0, 0, 1, styles, ctx);}if(name !== "compound" && styles.angleIndicator){ctx.beginPath();this.setStyle(styles.angleIndicator, ctx);ctx.moveTo(0, 0);ctx.lineTo(w, 0);ctx.closePath();ctx.stroke();}ctx.restore();return this;}, createView:function createView(geometry, styles){var view, aabb=geometry.aabb(), hw=aabb.hw + Math.abs(aabb.x), hh=aabb.hh + Math.abs(aabb.y), offset={x:hw + 1, y:hh + 1}, hiddenCtx=this.hiddenCtx, hiddenCanvas=this.hiddenCanvas;styles = styles || this.options.styles[name] || this.options.styles.circle || {};if(styles.src){view = new Image();view.src = styles.src;if(styles.width){view.width = styles.width;}if(styles.height){view.height = styles.height;}return view;}offset.x += styles.lineWidth | 0;offset.y += styles.lineWidth | 0;hiddenCanvas.width = 2 * hw + 2 + (2 * styles.lineWidth | 0);hiddenCanvas.height = 2 * hh + 2 + (2 * styles.lineWidth | 0);this.draw(geometry, styles, hiddenCtx, offset);view = new Image(hiddenCanvas.width, hiddenCanvas.height);view.src = hiddenCanvas.toDataURL("image/png");return view;}, drawMeta:function drawMeta(meta){this.els.fps.innerHTML = meta.fps.toFixed(2);this.els.ipf.innerHTML = meta.ipf;}, drawBody:function drawBody(body, view, ctx, offset){var pos=body.state.pos, os=body.offset, v=body.state.vel, t=this._interpolateTime || 0, x, y, ang, aabb;offset = offset || this.options.offset;ctx = ctx || this.ctx;x = pos._[0] + offset.x + v._[0] * t;y = pos._[1] + offset.y + v._[1] * t;ang = body.state.angular.pos + body.state.angular.vel * t;ctx.save();ctx.translate(x, y);ctx.rotate(ang);ctx.translate(os._[0], os._[1]);ctx.drawImage(view, -view.width / 2, -view.height / 2, view.width, view.height);ctx.restore();}, render:function render(bodies, meta){var body, view, pos;this._world.emit("beforeRender", {renderer:this, meta:meta});if(this.options.meta){this.drawMeta(meta);}this._interpolateTime = meta.interpolateTime;for(var id in this._layers) {this._layers[id].render();}return this;}};});Physics.renderer("dom", function(proto){if(!document){return {};}var thePrefix={}, tmpdiv=document.createElement("div"), toTitleCase=function toTitleCase(str){return str.replace(/(?:^|\s)\w/g, function(match){return match.toUpperCase();});}, pfx=function pfx(prop){if(thePrefix[prop]){return thePrefix[prop];}var arrayOfPrefixes=["Webkit", "Moz", "Ms", "O"], name;for(var i=0, l=arrayOfPrefixes.length; i < l; ++i) {name = arrayOfPrefixes[i] + toTitleCase(prop);if(name in tmpdiv.style){return thePrefix[prop] = name;}}if(name in tmpdiv.style){return thePrefix[prop] = prop;}return false;};var classpfx="pjs-", px="px", cssTransform=pfx("transform"), borderRadius=pfx("borderRadius");var newEl=function newEl(node, content){var el=document.createElement(node || "div");if(content){el.innerHTML = content;}return el;}, drawBody;return {init:function init(options){proto.init.call(this, options);var viewport=this.el;viewport.style.position = "relative";viewport.style.overflow = "hidden";viewport.style[cssTransform] = "translateZ(0)";viewport.style.width = this.options.width + px;viewport.style.height = this.options.height + px;this.els = {};if(options.meta){var stats=newEl();stats.className = "pjs-meta";this.els.fps = newEl("span");this.els.ipf = newEl("span");stats.appendChild(newEl("span", "fps: "));stats.appendChild(this.els.fps);stats.appendChild(newEl("br"));stats.appendChild(newEl("span", "ipf: "));stats.appendChild(this.els.ipf);viewport.appendChild(stats);}if(this.options.autoResize){this.resize();}else {this.resize(this.options.width, this.options.height);}}, resize:function resize(width, height){proto.resize.call(this, width, height);this.el.style.width = this.width + px;this.el.style.height = this.height + px;}, pointProperties:function pointProperties(el, geometry){el.style.width = "2px";el.style.height = "2px";el.style.marginLeft = "-1px";el.style.marginTop = "-1px";el.style[borderRadius] = "50%";}, circleProperties:function circleProperties(el, geometry){var aabb=geometry.aabb();el.style.width = aabb.hw * 2 + px;el.style.height = aabb.hh * 2 + px;el.style.marginLeft = -aabb.hw + px;el.style.marginTop = -aabb.hh + px;el.style[borderRadius] = "50%";}, rectangleProperties:function rectangleProperties(el, geometry){var aabb=geometry.aabb();el.style.width = aabb.hw * 2 + px;el.style.height = aabb.hh * 2 + px;el.style.marginLeft = -aabb.hw + px;el.style.marginTop = -aabb.hh + px;}, createView:function createView(geometry){var el=newEl(), chel, fn=geometry.name + "Properties";el.className = classpfx + geometry.name;el.style.position = "absolute";el.style.top = "0px";el.style.left = "0px";if(geometry.name === "compound"){for(var i=0, l=geometry.children.length, ch; i < l; i++) {ch = geometry.children[i];chel = newEl();chel.className = classpfx + geometry.name + " " + classpfx + "child";chel.style.position = "absolute";chel.style.top = "0px";chel.style.left = "0px";if(this[ch.g.name + "Properties"]){this[ch.g.name + "Properties"](chel, ch.g);}chel.style[cssTransform] = "translate(" + ch.pos._[0] + "px," + ch.pos._[1] + "px) rotate(" + ch.angle + "rad)";el.appendChild(chel);}}else if(this[fn]){this[fn](el, geometry);}this.el.appendChild(el);return el;}, connect:function connect(world){world.on("add:body", this.attach, this);world.on("remove:body", this.detach, this);}, disconnect:function disconnect(world){world.off("add:body", this.attach, this);world.off("remove:body", this.detach, this);}, detach:function detach(data){var el=data.nodeType && data || data.body && data.body.view, par=el && el.parentNode;if(el && par){par.removeChild(el);}return this;}, attach:function attach(data){var el=data.nodeType && data || data.body && data.body.view;if(el){this.el.appendChild(el);}return this;}, drawMeta:function drawMeta(meta){this.els.fps.innerHTML = meta.fps.toFixed(2);this.els.ipf.innerHTML = meta.ipf;}, drawBody:function drawBody(body, view){var pos=body.state.pos, v=body.state.vel, os=body.offset, x, y, ang, t=this._interpolateTime;x = pos._[0] + v._[0] * t;y = pos._[1] + v._[1] * t;ang = body.state.angular.pos + body.state.angular.vel * t;view.style[cssTransform] = "translate(" + x + "px," + y + "px) rotate(" + ang + "rad) translate(" + os._[0] + "px," + os._[1] + "px)";}};});Physics.renderer("pixi", function(parent){if(!document){return {};}var Pi2=Math.PI * 2, colors={white:"0xFFFFFF", violet:"0x542437", blue:"0x53777A"}, fontStyles={font:"18px monospace", fill:"black", align:"left"}, defaults={metaEl:null, offset:{x:0, y:0}, styles:{color:false, point:colors.blue, circle:{strokeStyle:colors.blue, lineWidth:1, fillStyle:colors.blue, angleIndicator:colors.white, fillAlpha:1, strokeAlpha:1, alpha:1}, rectangle:{strokeStyle:colors.violet, lineWidth:1, fillStyle:colors.violet, angleIndicator:colors.white, fillAlpha:1, strokeAlpha:1, alpha:1}, "convex-polygon":{strokeStyle:colors.violet, lineWidth:1, fillStyle:colors.violet, angleIndicator:colors.white, fillAlpha:1, strokeAlpha:1, alpha:1}}};return {init:function init(options){var self=this, el, isTransparent;if(typeof PIXI === "undefined"){throw "PIXI not present - cannot continue";}parent.init.call(this, options);this.options.defaults(defaults, true);this.options.onChange(function(){self.options.offset = new Physics.vector(self.options.offset);});this.options(options, true);isTransparent = !this.options.styles.color || this.options.styles.color === "transparent";this.stage = new PIXI.Stage(this.options.styles.color);this.meta = {};el = this.el && this.el.nodeName === "CANVAS"?el:null;this.renderer = new PIXI.autoDetectRenderer(this.options.width, this.options.height, {view:el, transparent:isTransparent, resolution:window.devicePixelRatio || 1});if(!el){this.el = this.el || document.body;this.el.appendChild(this.renderer.view);}if(this.options.autoResize){this.resize();}else {this.resize(this.options.width, this.options.height);}}, resize:function resize(width, height){parent.resize.call(this, width, height);this.renderer.resize(this.width, this.height);}, connect:function connect(world){world.on("add:body", this.attach, this);world.on("remove:body", this.detach, this);}, disconnect:function disconnect(world){world.off("add:body", this.attach, this);world.off("remove:body", this.detach, this);}, detach:function detach(data){var el=data instanceof PIXI.Graphics && data || data.body && data.body.view;if(el){this.stage.removeChild(el);}return this;}, attach:function attach(data){var el=data instanceof PIXI.Graphics && data || data.body && data.body.view;if(el){this.stage.addChild(el);}return this;}, loadSpriteSheets:function loadSpriteSheets(assetsToLoad, callback){if(!Physics.util.isArray(assetsToLoad)){throw "Spritesheets must be defined in arrays";}var self=this, loader=new PIXI.AssetLoader(assetsToLoad);loader.load();loader.on("onComplete", function(evt){self.assetsLoaded = true;callback();});return self;}, drawBody:function drawBody(body, view){var pos=body.state.pos, v=body.state.vel, os=body.offset, t=this._interpolateTime || 0, x, y, ang;x = pos._[0] + v._[0] * t;y = pos._[1] + v._[1] * t;ang = body.state.angular.pos + body.state.angular.vel * t;view.position.set(x, y);view.pivot.set(-os._[0], -os._[1]);view.rotation = ang;}, render:function render(bodies, meta){parent.render.call(this, bodies, meta);this.renderer.render(this.stage);}, setStyles:function setStyles(graphics, styles){if(Physics.util.isObject(styles)){if(styles.fillStyle && styles.fillStyle !== "transparent"){graphics.beginFill(styles.fillStyle);graphics.fillAlpha = styles.fillAlpha !== undefined?styles.fillAlpha:1;}else {graphics.beginFill();graphics.fillAlpha = 0;}graphics.lineStyle(styles.lineWidth || 0, styles.strokeStyle, styles.strokeAlpha !== undefined?styles.strokeAlpha:1);graphics.alpha = styles.alpha !== undefined?styles.alpha:1;}else {if(styles && styles !== "transparent"){graphics.beginFill(styles);}else {graphics.beginFill();graphics.fillAlpha = 0;}graphics.lineStyle(0);}return graphics;}, createCircle:function createCircle(x, y, r, styles){var graphics=new PIXI.Graphics();this.setStyles(graphics, styles);graphics.drawCircle(x, y, r);graphics.endFill();return graphics;}, createRect:function createRect(x, y, width, height, styles){var graphics=new PIXI.Graphics();this.setStyles(graphics, styles);graphics.drawRect(x, y, width, height);graphics.endFill();return graphics;}, createPolygon:function createPolygon(verts, styles){var vert=verts[0], x=vert.x, y=vert.y, l=verts.length, start={x:x, y:y}, graphics=new PIXI.Graphics();this.setStyles(graphics, styles);graphics.moveTo(x, y);for(var i=1; i < l; ++i) {vert = verts[i];x = vert.x;y = vert.y;graphics.lineTo(x, y);}if(l > 2){graphics.lineTo(start.x, start.y);}graphics.endFill();return graphics;}, createLine:function createLine(from, to, styles){var x=from.x, y=from.y;var graphics=new PIXI.Graphics();this.setStyles(graphics, styles);graphics.moveTo(x, y);x = to.x;y = to.y;graphics.lineTo(x, y);graphics.endFill();return graphics;}, createView:function createView(geometry, styles, parent){var view=null, aabb=geometry.aabb(), hw=aabb.hw + Math.abs(aabb.x), hh=aabb.hh + Math.abs(aabb.y), name=geometry.name;parent = parent || this.stage;styles = styles || this.options.styles[name] || this.options.styles.circle || {};if(styles.src){view = PIXI.Sprite.fromImage(styles.src);view.anchor.set(0.5, 0.5);if(styles.anchor){view.anchor.x = styles.anchor.x;view.anchor.y = styles.anchor.y;}if(styles.width){view.width = styles.width;}if(styles.height){view.height = styles.height;}parent.addChild(view);return view;}if(name === "circle"){view = this.createCircle(0, 0, geometry.radius, styles);}else if(name === "convex-polygon"){view = this.createPolygon(geometry.vertices, styles);}else if(name === "rectangle"){view = this.createRect(-geometry.width / 2, -geometry.height / 2, geometry.width, geometry.height, styles);}else if(name === "compound"){view = new PIXI.Graphics();for(var i=0, l=geometry.children.length, ch, chview; i < l; i++) {ch = geometry.children[i];chview = this.createView(ch.g, styles, view);chview.position.set(ch.pos.x, ch.pos.y);chview.rotation = ch.angle;}}else {view = this.createCircle(0, 0, 1, styles);}if(name !== "compound" && styles.angleIndicator && styles.angleIndicator !== "transparent"){view.lineStyle(styles.lineWidth, styles.angleIndicator);view.moveTo(0, 0);view.lineTo(hw, 0);}if(name !== "compound"){view.cacheAsBitmap = true;}parent.addChild(view);return view;}, drawMeta:function drawMeta(meta){if(!this.meta.loaded){this.meta.fps = new PIXI.Text("FPS: " + meta.fps.toFixed(2), fontStyles);this.meta.fps.position.x = 15;this.meta.fps.position.y = 5;this.meta.ipf = new PIXI.Text("IPF: " + meta.ipf, fontStyles);this.meta.ipf.position.x = 15;this.meta.ipf.position.y = 30;this.stage.addChild(this.meta.fps);this.stage.addChild(this.meta.ipf);this.meta.loaded = true;}else {this.meta.fps.setText("FPS: " + meta.fps.toFixed(2));this.meta.ipf.setText("IPF: " + meta.ipf);}}, createDisplay:function createDisplay(type, options){var view=null, texture=null;switch(type){case "sprite":texture = PIXI.Texture.fromImage(options.texture);view = new PIXI.Sprite(texture);if(options.anchor){view.anchor.x = options.anchor.x;view.anchor.y = options.anchor.y;}if(options.container){options.container.addChild(view);}else {this.stage.addChild(view);}return view;case "movieclip":if(!this.assetsLoaded){throw "No assets have been loaded. Use loadSpritesheet() first";}var tex=[], i=0;for(i; i < options.frames.length; i++) {texture = PIXI.Texture.fromFrame(options.frames[i]);tex.push(texture);}view = new PIXI.MovieClip(tex);if(options.anchor){view.anchor.x = options.anchor.x;view.anchor.y = options.anchor.y;}if(options.container){options.container.addChild(view);}else {this.stage.addChild(view);}return view;default:throw "Invalid PIXI.DisplayObject passed";}}, centerAnchor:function centerAnchor(view){if(view !== null){view.anchor.x = 0.5;view.anchor.y = 0.5;}}};});return Physics;});

},{}],4:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Neuron = _interopRequire(require("./neuron"));

var Synapse = _interopRequire(require("./synapse"));

var Brain = (function () {
  function Brain(settings) {
    _classCallCheck(this, Brain);

    console.log("Brain init");
    this._settings = settings;

    //Build a brain
    this.neurons = [];
    this.synapses = [];

    var i = 0;
    //Construct inputs
    //Construct outputs
    //Construct neurons
    i = settings.neuron_count;
    while (i--) {
      this.neurons.push(new Neuron());
    }
    //Construct synapses
    i = settings.synapse_count;
    while (i--) {
      this.synapses.push(new Synapse());
    }
  }

  _createClass(Brain, {
    update: {
      value: function update() {}
    }
  });

  return Brain;
})();

module.exports = Brain;

},{"./neuron":10,"./synapse":12}],5:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Brain = _interopRequire(require("./brain"));

var Creature = (function () {
  function Creature(main) {
    _classCallCheck(this, Creature);

    console.log("Creature init");
    this.brain = new Brain({
      inputs: [],
      outputs: [],
      neuron_count: main._settings.brain.neurons,
      synapse_count: main._settings.brain.synapses
    });
  }

  _createClass(Creature, {
    update: {
      value: function update() {}
    }
  });

  return Creature;
})();

module.exports = Creature;

//Creature X
//Creature Y
//Creature Rotation
//Creature Velocity

//Creature Rotation modifier
//Creature speed modifier

//Update brain
//Update velocity
//Update rotation
//Update location

},{"./brain":4}],6:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var PhysicsJS = _interopRequire(require("./../lib/physicsjs/dist/physicsjs-full.js"));

var Main = _interopRequire(require("./main"));

var Engine = (function () {
  function Engine(opts) {
    var _this = this;

    _classCallCheck(this, Engine);

    this.main = new Main(opts._settings);

    PhysicsJS(function (world) {
      _this.main.world = world;
      _this.main.start();
      PhysicsJS.util.ticker.on(function (time, dt) {
        _this.tick(time, dt);
      });
    });
  }

  _createClass(Engine, {
    tick: {
      value: function tick(time, dt) {
        this.main.tick(time, dt);
      }
    }
  });

  return Engine;
})();

module.exports = Engine;

},{"./../lib/physicsjs/dist/physicsjs-full.js":3,"./main":9}],7:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var PhysicsJS = _interopRequire(require("./../lib/physicsjs/dist/physicsjs-full.js"));

var Environment = (function () {
    function Environment(main) {
        _classCallCheck(this, Environment);

        this.main = main;
        this.$environmnet = $("#environment");

        this.width = window.innerWidth / 2;
        this.height = window.innerHeight;

        //Putting render stuff for env in here because
        //its coupled with the physics engine

        var world = main.world;
        var viewWidth = this.width;
        var viewHeight = this.height;

        var renderer = PhysicsJS.renderer("canvas", {
            el: "environment",
            width: viewWidth,
            height: viewHeight,
            autoResize: false,
            meta: false, // don't display meta data
            styles: {
                // set colors for the circle bodies
                circle: {
                    strokeStyle: "#351024",
                    lineWidth: 1,
                    fillStyle: "#d33682",
                    angleIndicator: "#351024"
                }
            }
        });

        // add the renderer
        world.add(renderer);

        // render on each step
        world.on("step", function () {
            world.render();
        });

        // bounds of the window
        var viewportBounds = PhysicsJS.aabb(0, 0, viewWidth, viewHeight);

        // constrain objects to these bounds
        world.add(PhysicsJS.behavior("edge-collision-detection", {
            aabb: viewportBounds,
            restitution: 0.99,
            cof: 0.99
        }));

        // add a circle
        world.add(PhysicsJS.body("circle", {
            x: viewWidth / 2, // x-coordinate
            y: viewHeight / 2, // y-coordinate
            vx: 0, // velocity in x-direction
            vy: 0, // velocity in y-direction
            radius: 20
        }));

        // ensure objects bounce when edge collision is detected
        world.add(PhysicsJS.behavior("body-impulse-response"));

        // start the ticker
        PhysicsJS.util.ticker.start();
    }

    _createClass(Environment, {
        tick: {
            value: function tick(time, dt) {
                //Refresh background
                //this.clear(this.env_context, '#111');
                //Draw creature
                //Draw avoid
                //Draw find
                this.main.world.step(time);
            }
        }
    });

    return Environment;
})();

module.exports = Environment;

},{"./../lib/physicsjs/dist/physicsjs-full.js":3}],8:[function(require,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Helpers = (function () {
  function Helpers() {
    _classCallCheck(this, Helpers);
  }

  _createClass(Helpers, {
    randomInRange: {
      value: function randomInRange(min, max) {
        return Math.random() * (max - min) + min;
      }
    }
  });

  return Helpers;
})();

module.exports = Helpers;

},{}],9:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Render = _interopRequire(require("./render"));

var Environment = _interopRequire(require("./environment"));

var Creature = _interopRequire(require("./creature"));

var Main = (function () {
  function Main(settings) {
    _classCallCheck(this, Main);

    console.log("Main init");

    //Engine
    this._settings = settings;
  }

  _createClass(Main, {
    start: {
      value: function start() {
        //Classes
        this.environment = new Environment(this);
        this.creature = new Creature(this);
        this.render = new Render(this);
      }
    },
    tick: {
      value: function tick(time, dt) {
        this.environment.tick(time, dt);
        this.render.tick();
      }
    }
  });

  return Main;
})();

module.exports = Main;

},{"./creature":5,"./environment":7,"./render":11}],10:[function(require,module,exports){
"use strict";

var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Helpers = _interopRequire(require("./helpers"));

var Neuron = (function () {
  function Neuron() {
    _classCallCheck(this, Neuron);

    console.log("Neuron init");
    var h = new Helpers();
    //Position
    this.radius = 3;

    this.position = {
      x: h.randomInRange(0.2, 0.8),
      y: h.randomInRange(0.2, 0.8)
    }
    //Last spike
    //Current potential
    ;
  }

  _createClass(Neuron, {
    update: {
      value: function update() {}
    }
  });

  return Neuron;
})();

module.exports = Neuron;

},{"./helpers":8}],11:[function(require,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Render = (function () {
  function Render(main) {
    _classCallCheck(this, Render);

    this.main = main;

    this.$brain = $("#brain");
    this.$info = $("#info");

    this.width = window.innerWidth / 2;
    this.height = window.innerHeight;

    this.$brain.attr("width", this.width).attr("height", this.height);

    this.brain_context = this.$brain[0].getContext("2d");
  }

  _createClass(Render, {
    tick: {
      value: function tick() {
        this.brain();
        this.info();
      }
    },
    info: {
      value: function info() {}
    },
    brain: {
      value: (function (_brain) {
        var _brainWrapper = function brain() {
          return _brain.apply(this, arguments);
        };

        _brainWrapper.toString = function () {
          return _brain.toString();
        };

        return _brainWrapper;
      })(function () {
        var brain = this.main.creature.brain;
        //Refresh background
        this.clear(this.brain_context, "#aaa");

        //Draw inputs
        //Draw outputs
        //Draw neurons
        this.neurons(brain.neurons);
        //Draw synapses
      })
    },
    neurons: {
      value: (function (_neurons) {
        var _neuronsWrapper = function neurons(_x) {
          return _neurons.apply(this, arguments);
        };

        _neuronsWrapper.toString = function () {
          return _neurons.toString();
        };

        return _neuronsWrapper;
      })(function (neurons) {
        var i = neurons.length;
        while (i--) {
          var neuron = neurons[i];
          this.drawCircle(this.brain_context, {
            c: "#000",
            x: neuron.position.x * this.width,
            y: neuron.position.y * this.height,
            r: neuron.radius
          });
        }
      })
    },
    clear: {
      value: function clear(c, color) {
        c.fillStyle = color;
        c.fillRect(0, 0, this.width, this.height);
      }
    },
    drawCircle: {
      value: function drawCircle(c, opts) {
        c.fillStyle = opts.c;
        c.beginPath();
        c.arc(opts.x, opts.y, opts.r, 0, Math.PI * 2, false);
        c.closePath();
        c.fill();
      }
    },
    drawLines: {
      value: function drawLines(c, lines) {
        c.strokeStyle = "#f44";
        var _iteratorNormalCompletion = true;
        var _didIteratorError = false;
        var _iteratorError = undefined;

        try {
          for (var _iterator = lines[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            var line = _step.value;

            c.beginPath();
            c.moveTo(line.a.x, line.a.y);
            c.lineTo(line.b.x, line.b.y);
            c.closePath();
            c.stroke();
          }
        } catch (err) {
          _didIteratorError = true;
          _iteratorError = err;
        } finally {
          try {
            if (!_iteratorNormalCompletion && _iterator["return"]) {
              _iterator["return"]();
            }
          } finally {
            if (_didIteratorError) {
              throw _iteratorError;
            }
          }
        }
      }
    }
  });

  return Render;
})();

module.exports = Render;

// var string = "Fps: " + this.main._fps;
// this.$info.text(string);

},{}],12:[function(require,module,exports){
"use strict";

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var Synapse = function Synapse() {
  _classCallCheck(this, Synapse);
};

module.exports = Synapse;

},{}]},{},[1]);
